<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 11 Cleaning and preparing data | Telling Stories With Data</title>
  <meta name="description" content="This book is about learning how to tell stories with data." />
  <meta name="generator" content="bookdown 0.22.17 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 11 Cleaning and preparing data | Telling Stories With Data" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="/tellingstorieswithdatapainting.png" />
  <meta property="og:description" content="This book is about learning how to tell stories with data." />
  <meta name="github-repo" content="RohanAlexander/telling_stories_with_data" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 11 Cleaning and preparing data | Telling Stories With Data" />
  
  <meta name="twitter:description" content="This book is about learning how to tell stories with data." />
  <meta name="twitter:image" content="/tellingstorieswithdatapainting.png" />

<meta name="author" content="Rohan Alexander" />


<meta name="date" content="2021-05-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="farm-data.html"/>
<link rel="next" href="storing-and-retrieving-data.html"/>
<script src="libs/header-attrs/header-attrs.js"></script>
<script src="libs/jquery/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections/anchor-sections.js"></script>
<script src="libs/kePrint/kePrint.js"></script>
<link href="libs/lightable/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets/htmlwidgets.js"></script>
<link href="libs/leaflet/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet/leaflet.js"></script>
<link href="libs/leafletfix/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4/proj4.min.js"></script>
<script src="libs/Proj4Leaflet/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding/leaflet.js"></script>
<script src="libs/mapdeck-binding/mapdeck.js"></script>
<script src="libs/mpadeck_functions/mapdeck_functions.js"></script>
<script src="libs/deckgl/deckgl.min.js"></script>
<script src="libs/legend/legend.js"></script>
<script src="libs/title/title.js"></script>
<script src="libs/mapdeck_location/mapdeck_location.js"></script>
<script src="libs/mapdeck_colours/mapdeck_colours.js"></script>
<script src="libs/mapdeck_coordinates/mapdeck_coordinates.js"></script>
<link href="libs/mapboxgl/mapbox-gl.css" rel="stylesheet" />
<script src="libs/mapboxgl/mapbox-gl.js"></script>
<link href="libs/mapdeck/mapdeck.css" rel="stylesheet" />
<script src="libs/mpadeck-binding/mapdeck.js"></script>
<script src="libs/scatterplot/scatterplot.js"></script>
<script src="libs/viz/viz.js"></script>
<link href="libs/DiagrammeR-styles/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding/grViz.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Telling Stories With Data</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#audience-and-assumed-background"><i class="fa fa-check"></i>Audience and assumed background</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#structure-and-content"><i class="fa fa-check"></i>Structure and content</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#pedagogy-and-key-features"><i class="fa fa-check"></i>Pedagogy and key features</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#software-information-and-conventions"><i class="fa fa-check"></i>Software information and conventions</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i>Acknowledgments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="about-the-author.html"><a href="about-the-author.html"><i class="fa fa-check"></i>About the author</a></li>
<li class="part"><span><b>I Foundations</b></span></li>
<li class="chapter" data-level="1" data-path="telling-stories-with-data.html"><a href="telling-stories-with-data.html"><i class="fa fa-check"></i><b>1</b> Telling Stories with Data</a>
<ul>
<li class="chapter" data-level="1.1" data-path="telling-stories-with-data.html"><a href="telling-stories-with-data.html#on-telling-stories"><i class="fa fa-check"></i><b>1.1</b> On telling stories</a></li>
<li class="chapter" data-level="1.2" data-path="telling-stories-with-data.html"><a href="telling-stories-with-data.html#telling-stories-with-data-1"><i class="fa fa-check"></i><b>1.2</b> Telling stories with data</a></li>
<li class="chapter" data-level="1.3" data-path="telling-stories-with-data.html"><a href="telling-stories-with-data.html#workflow-components"><i class="fa fa-check"></i><b>1.3</b> Workflow components</a></li>
<li class="chapter" data-level="1.4" data-path="telling-stories-with-data.html"><a href="telling-stories-with-data.html#how-do-our-worlds-become-data"><i class="fa fa-check"></i><b>1.4</b> How do our worlds become data?</a></li>
<li class="chapter" data-level="1.5" data-path="telling-stories-with-data.html"><a href="telling-stories-with-data.html#what-is-data-science-and-how-should-we-use-it-to-learn-about-the-world"><i class="fa fa-check"></i><b>1.5</b> What is data science and how should we use it to learn about the world</a></li>
<li class="chapter" data-level="1.6" data-path="telling-stories-with-data.html"><a href="telling-stories-with-data.html#exercises-and-tutorial"><i class="fa fa-check"></i><b>1.6</b> Exercises and tutorial</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="telling-stories-with-data.html"><a href="telling-stories-with-data.html#exercises"><i class="fa fa-check"></i><b>1.6.1</b> Exercises</a></li>
<li class="chapter" data-level="1.6.2" data-path="telling-stories-with-data.html"><a href="telling-stories-with-data.html#tutorial"><i class="fa fa-check"></i><b>1.6.2</b> Tutorial</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="drinking-from-a-fire-hose.html"><a href="drinking-from-a-fire-hose.html"><i class="fa fa-check"></i><b>2</b> Drinking from a fire hose</a>
<ul>
<li class="chapter" data-level="2.1" data-path="drinking-from-a-fire-hose.html"><a href="drinking-from-a-fire-hose.html#hello-world"><i class="fa fa-check"></i><b>2.1</b> Hello world</a></li>
<li class="chapter" data-level="2.2" data-path="drinking-from-a-fire-hose.html"><a href="drinking-from-a-fire-hose.html#case-study---canadian-elections"><i class="fa fa-check"></i><b>2.2</b> Case study - Canadian elections</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="drinking-from-a-fire-hose.html"><a href="drinking-from-a-fire-hose.html#getting-started"><i class="fa fa-check"></i><b>2.2.1</b> Getting started</a></li>
<li class="chapter" data-level="2.2.2" data-path="drinking-from-a-fire-hose.html"><a href="drinking-from-a-fire-hose.html#get-the-data"><i class="fa fa-check"></i><b>2.2.2</b> Get the data</a></li>
<li class="chapter" data-level="2.2.3" data-path="drinking-from-a-fire-hose.html"><a href="drinking-from-a-fire-hose.html#clean-the-data"><i class="fa fa-check"></i><b>2.2.3</b> Clean the data</a></li>
<li class="chapter" data-level="2.2.4" data-path="drinking-from-a-fire-hose.html"><a href="drinking-from-a-fire-hose.html#make-a-graph"><i class="fa fa-check"></i><b>2.2.4</b> Make a graph</a></li>
<li class="chapter" data-level="2.2.5" data-path="drinking-from-a-fire-hose.html"><a href="drinking-from-a-fire-hose.html#make-a-table"><i class="fa fa-check"></i><b>2.2.5</b> Make a table</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="drinking-from-a-fire-hose.html"><a href="drinking-from-a-fire-hose.html#case-study---toronto-homelessness"><i class="fa fa-check"></i><b>2.3</b> Case study - Toronto homelessness</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="drinking-from-a-fire-hose.html"><a href="drinking-from-a-fire-hose.html#getting-started-1"><i class="fa fa-check"></i><b>2.3.1</b> Getting started</a></li>
<li class="chapter" data-level="2.3.2" data-path="drinking-from-a-fire-hose.html"><a href="drinking-from-a-fire-hose.html#get-the-data-1"><i class="fa fa-check"></i><b>2.3.2</b> Get the data</a></li>
<li class="chapter" data-level="2.3.3" data-path="drinking-from-a-fire-hose.html"><a href="drinking-from-a-fire-hose.html#make-a-graph-1"><i class="fa fa-check"></i><b>2.3.3</b> Make a graph</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="drinking-from-a-fire-hose.html"><a href="drinking-from-a-fire-hose.html#exercises-and-tutorial-1"><i class="fa fa-check"></i><b>2.4</b> Exercises and tutorial</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="drinking-from-a-fire-hose.html"><a href="drinking-from-a-fire-hose.html#exercises-1"><i class="fa fa-check"></i><b>2.4.1</b> Exercises</a></li>
<li class="chapter" data-level="2.4.2" data-path="drinking-from-a-fire-hose.html"><a href="drinking-from-a-fire-hose.html#tutorial-1"><i class="fa fa-check"></i><b>2.4.2</b> Tutorial</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="r-essentials.html"><a href="r-essentials.html"><i class="fa fa-check"></i><b>3</b> R Essentials</a>
<ul>
<li class="chapter" data-level="3.1" data-path="r-essentials.html"><a href="r-essentials.html#r-essentials-1"><i class="fa fa-check"></i><b>3.1</b> R essentials</a></li>
<li class="chapter" data-level="3.2" data-path="r-essentials.html"><a href="r-essentials.html#social-impact"><i class="fa fa-check"></i><b>3.2</b> Social impact</a></li>
<li class="chapter" data-level="3.3" data-path="r-essentials.html"><a href="r-essentials.html#r-r-studio-and-r-studio-cloud"><i class="fa fa-check"></i><b>3.3</b> R, R Studio, and R Studio Cloud</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="r-essentials.html"><a href="r-essentials.html#r"><i class="fa fa-check"></i><b>3.3.1</b> R</a></li>
<li class="chapter" data-level="3.3.2" data-path="r-essentials.html"><a href="r-essentials.html#r-studio"><i class="fa fa-check"></i><b>3.3.2</b> R Studio</a></li>
<li class="chapter" data-level="3.3.3" data-path="r-essentials.html"><a href="r-essentials.html#r-studio-cloud"><i class="fa fa-check"></i><b>3.3.3</b> R Studio Cloud</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="r-essentials.html"><a href="r-essentials.html#tidyverse-i"><i class="fa fa-check"></i><b>3.4</b> Tidyverse I</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="r-essentials.html"><a href="r-essentials.html#the-pipe"><i class="fa fa-check"></i><b>3.4.1</b> The pipe</a></li>
<li class="chapter" data-level="3.4.2" data-path="r-essentials.html"><a href="r-essentials.html#selecting"><i class="fa fa-check"></i><b>3.4.2</b> Selecting</a></li>
<li class="chapter" data-level="3.4.3" data-path="r-essentials.html"><a href="r-essentials.html#filtering"><i class="fa fa-check"></i><b>3.4.3</b> Filtering</a></li>
<li class="chapter" data-level="3.4.4" data-path="r-essentials.html"><a href="r-essentials.html#arranging"><i class="fa fa-check"></i><b>3.4.4</b> Arranging</a></li>
<li class="chapter" data-level="3.4.5" data-path="r-essentials.html"><a href="r-essentials.html#grouping"><i class="fa fa-check"></i><b>3.4.5</b> Grouping</a></li>
<li class="chapter" data-level="3.4.6" data-path="r-essentials.html"><a href="r-essentials.html#mutating"><i class="fa fa-check"></i><b>3.4.6</b> Mutating</a></li>
<li class="chapter" data-level="3.4.7" data-path="r-essentials.html"><a href="r-essentials.html#summarise"><i class="fa fa-check"></i><b>3.4.7</b> Summarise</a></li>
<li class="chapter" data-level="3.4.8" data-path="r-essentials.html"><a href="r-essentials.html#counting"><i class="fa fa-check"></i><b>3.4.8</b> Counting</a></li>
<li class="chapter" data-level="3.4.9" data-path="r-essentials.html"><a href="r-essentials.html#proportions"><i class="fa fa-check"></i><b>3.4.9</b> Proportions</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="r-essentials.html"><a href="r-essentials.html#base"><i class="fa fa-check"></i><b>3.5</b> Base</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="r-essentials.html"><a href="r-essentials.html#class"><i class="fa fa-check"></i><b>3.5.1</b> Class</a></li>
<li class="chapter" data-level="3.5.2" data-path="r-essentials.html"><a href="r-essentials.html#simulating-data"><i class="fa fa-check"></i><b>3.5.2</b> Simulating data</a></li>
<li class="chapter" data-level="3.5.3" data-path="r-essentials.html"><a href="r-essentials.html#functions"><i class="fa fa-check"></i><b>3.5.3</b> Functions</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="r-essentials.html"><a href="r-essentials.html#ggplot"><i class="fa fa-check"></i><b>3.6</b> ggplot</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="r-essentials.html"><a href="r-essentials.html#main-features"><i class="fa fa-check"></i><b>3.6.1</b> Main features</a></li>
<li class="chapter" data-level="3.6.2" data-path="r-essentials.html"><a href="r-essentials.html#facets"><i class="fa fa-check"></i><b>3.6.2</b> Facets</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="r-essentials.html"><a href="r-essentials.html#tidyverse-ii"><i class="fa fa-check"></i><b>3.7</b> Tidyverse II</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="r-essentials.html"><a href="r-essentials.html#tibbles"><i class="fa fa-check"></i><b>3.7.1</b> Tibbles</a></li>
<li class="chapter" data-level="3.7.2" data-path="r-essentials.html"><a href="r-essentials.html#importing-data"><i class="fa fa-check"></i><b>3.7.2</b> Importing data</a></li>
<li class="chapter" data-level="3.7.3" data-path="r-essentials.html"><a href="r-essentials.html#joining-data"><i class="fa fa-check"></i><b>3.7.3</b> Joining data</a></li>
<li class="chapter" data-level="3.7.4" data-path="r-essentials.html"><a href="r-essentials.html#strings"><i class="fa fa-check"></i><b>3.7.4</b> Strings</a></li>
<li class="chapter" data-level="3.7.5" data-path="r-essentials.html"><a href="r-essentials.html#pivot"><i class="fa fa-check"></i><b>3.7.5</b> Pivot</a></li>
<li class="chapter" data-level="3.7.6" data-path="r-essentials.html"><a href="r-essentials.html#factors"><i class="fa fa-check"></i><b>3.7.6</b> Factors</a></li>
<li class="chapter" data-level="3.7.7" data-path="r-essentials.html"><a href="r-essentials.html#cases"><i class="fa fa-check"></i><b>3.7.7</b> Cases</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="r-essentials.html"><a href="r-essentials.html#exercises-and-tutorial-2"><i class="fa fa-check"></i><b>3.8</b> Exercises and tutorial</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="r-essentials.html"><a href="r-essentials.html#exercises-2"><i class="fa fa-check"></i><b>3.8.1</b> Exercises</a></li>
<li class="chapter" data-level="3.8.2" data-path="r-essentials.html"><a href="r-essentials.html#tutorial-2"><i class="fa fa-check"></i><b>3.8.2</b> Tutorial</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="workflow.html"><a href="workflow.html"><i class="fa fa-check"></i><b>4</b> Workflow</a>
<ul>
<li class="chapter" data-level="4.1" data-path="workflow.html"><a href="workflow.html#introduction"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="workflow.html"><a href="workflow.html#r-markdown"><i class="fa fa-check"></i><b>4.2</b> R Markdown</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="workflow.html"><a href="workflow.html#getting-started-2"><i class="fa fa-check"></i><b>4.2.1</b> Getting started</a></li>
<li class="chapter" data-level="4.2.2" data-path="workflow.html"><a href="workflow.html#basic-commands"><i class="fa fa-check"></i><b>4.2.2</b> Basic commands</a></li>
<li class="chapter" data-level="4.2.3" data-path="workflow.html"><a href="workflow.html#r-chunks"><i class="fa fa-check"></i><b>4.2.3</b> R chunks</a></li>
<li class="chapter" data-level="4.2.4" data-path="workflow.html"><a href="workflow.html#abstracts-and-pdf-outputs"><i class="fa fa-check"></i><b>4.2.4</b> Abstracts and PDF outputs</a></li>
<li class="chapter" data-level="4.2.5" data-path="workflow.html"><a href="workflow.html#references"><i class="fa fa-check"></i><b>4.2.5</b> References</a></li>
<li class="chapter" data-level="4.2.6" data-path="workflow.html"><a href="workflow.html#cross-references"><i class="fa fa-check"></i><b>4.2.6</b> Cross-references</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="workflow.html"><a href="workflow.html#r-projects"><i class="fa fa-check"></i><b>4.3</b> R projects</a></li>
<li class="chapter" data-level="4.4" data-path="workflow.html"><a href="workflow.html#git-and-github"><i class="fa fa-check"></i><b>4.4</b> Git and GitHub</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="workflow.html"><a href="workflow.html#introduction-1"><i class="fa fa-check"></i><b>4.4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.4.2" data-path="workflow.html"><a href="workflow.html#git"><i class="fa fa-check"></i><b>4.4.2</b> Git</a></li>
<li class="chapter" data-level="4.4.3" data-path="workflow.html"><a href="workflow.html#github"><i class="fa fa-check"></i><b>4.4.3</b> GitHub</a></li>
<li class="chapter" data-level="4.4.4" data-path="workflow.html"><a href="workflow.html#using-git-within-rstudio"><i class="fa fa-check"></i><b>4.4.4</b> Using Git within RStudio</a></li>
<li class="chapter" data-level="4.4.5" data-path="workflow.html"><a href="workflow.html#next-steps"><i class="fa fa-check"></i><b>4.4.5</b> Next steps</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="workflow.html"><a href="workflow.html#using-r-in-practice"><i class="fa fa-check"></i><b>4.5</b> Using R in practice</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="workflow.html"><a href="workflow.html#introduction-2"><i class="fa fa-check"></i><b>4.5.1</b> Introduction</a></li>
<li class="chapter" data-level="4.5.2" data-path="workflow.html"><a href="workflow.html#getting-help"><i class="fa fa-check"></i><b>4.5.2</b> Getting help</a></li>
<li class="chapter" data-level="4.5.3" data-path="workflow.html"><a href="workflow.html#mentality"><i class="fa fa-check"></i><b>4.5.3</b> Mentality</a></li>
<li class="chapter" data-level="4.5.4" data-path="workflow.html"><a href="workflow.html#code-comments"><i class="fa fa-check"></i><b>4.5.4</b> Code comments</a></li>
<li class="chapter" data-level="4.5.5" data-path="workflow.html"><a href="workflow.html#learning-more"><i class="fa fa-check"></i><b>4.5.5</b> Learning more</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="workflow.html"><a href="workflow.html#developing-research-questions"><i class="fa fa-check"></i><b>4.6</b> Developing research questions</a></li>
<li class="chapter" data-level="4.7" data-path="workflow.html"><a href="workflow.html#exercises-and-tutorial-3"><i class="fa fa-check"></i><b>4.7</b> Exercises and tutorial</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="workflow.html"><a href="workflow.html#exercises-3"><i class="fa fa-check"></i><b>4.7.1</b> Exercises</a></li>
<li class="chapter" data-level="4.7.2" data-path="workflow.html"><a href="workflow.html#tutorial-3"><i class="fa fa-check"></i><b>4.7.2</b> Tutorial</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Communication</b></span></li>
<li class="chapter" data-level="5" data-path="on-writing.html"><a href="on-writing.html"><i class="fa fa-check"></i><b>5</b> On writing</a>
<ul>
<li class="chapter" data-level="5.1" data-path="on-writing.html"><a href="on-writing.html#introduction-3"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="on-writing.html"><a href="on-writing.html#writing"><i class="fa fa-check"></i><b>5.2</b> Writing</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="on-writing.html"><a href="on-writing.html#title-abstract-and-introduction"><i class="fa fa-check"></i><b>5.2.1</b> Title, abstract, and introduction</a></li>
<li class="chapter" data-level="5.2.2" data-path="on-writing.html"><a href="on-writing.html#figures-tables-equations-and-technical-terms"><i class="fa fa-check"></i><b>5.2.2</b> Figures, tables, equations, and technical terms</a></li>
<li class="chapter" data-level="5.2.3" data-path="on-writing.html"><a href="on-writing.html#on-brevity"><i class="fa fa-check"></i><b>5.2.3</b> On brevity</a></li>
<li class="chapter" data-level="5.2.4" data-path="on-writing.html"><a href="on-writing.html#other"><i class="fa fa-check"></i><b>5.2.4</b> Other</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="on-writing.html"><a href="on-writing.html#exercises-and-tutorial-4"><i class="fa fa-check"></i><b>5.3</b> Exercises and tutorial</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="on-writing.html"><a href="on-writing.html#exercises-4"><i class="fa fa-check"></i><b>5.3.1</b> Exercises</a></li>
<li class="chapter" data-level="5.3.2" data-path="on-writing.html"><a href="on-writing.html#tutorial-4"><i class="fa fa-check"></i><b>5.3.2</b> Tutorial</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="static-communication.html"><a href="static-communication.html"><i class="fa fa-check"></i><b>6</b> Static communication</a>
<ul>
<li class="chapter" data-level="6.1" data-path="static-communication.html"><a href="static-communication.html#introduction-4"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="static-communication.html"><a href="static-communication.html#graphs"><i class="fa fa-check"></i><b>6.2</b> Graphs</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="static-communication.html"><a href="static-communication.html#bar-chart"><i class="fa fa-check"></i><b>6.2.1</b> Bar chart</a></li>
<li class="chapter" data-level="6.2.2" data-path="static-communication.html"><a href="static-communication.html#scatter-plot"><i class="fa fa-check"></i><b>6.2.2</b> Scatter plot</a></li>
<li class="chapter" data-level="6.2.3" data-path="static-communication.html"><a href="static-communication.html#never-use-box-plots"><i class="fa fa-check"></i><b>6.2.3</b> Never use box plots</a></li>
<li class="chapter" data-level="6.2.4" data-path="static-communication.html"><a href="static-communication.html#other-1"><i class="fa fa-check"></i><b>6.2.4</b> Other</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="static-communication.html"><a href="static-communication.html#tables"><i class="fa fa-check"></i><b>6.3</b> Tables</a></li>
<li class="chapter" data-level="6.4" data-path="static-communication.html"><a href="static-communication.html#maps"><i class="fa fa-check"></i><b>6.4</b> Maps</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="static-communication.html"><a href="static-communication.html#australian-polling-places"><i class="fa fa-check"></i><b>6.4.1</b> Australian polling places</a></li>
<li class="chapter" data-level="6.4.2" data-path="static-communication.html"><a href="static-communication.html#toronto-bike-parking"><i class="fa fa-check"></i><b>6.4.2</b> Toronto bike parking</a></li>
<li class="chapter" data-level="6.4.3" data-path="static-communication.html"><a href="static-communication.html#geocoding"><i class="fa fa-check"></i><b>6.4.3</b> Geocoding</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="static-communication.html"><a href="static-communication.html#exercises-and-tutorial-5"><i class="fa fa-check"></i><b>6.5</b> Exercises and tutorial</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="static-communication.html"><a href="static-communication.html#exercises-5"><i class="fa fa-check"></i><b>6.5.1</b> Exercises</a></li>
<li class="chapter" data-level="6.5.2" data-path="static-communication.html"><a href="static-communication.html#tutorial-5"><i class="fa fa-check"></i><b>6.5.2</b> Tutorial</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="interactive-communication.html"><a href="interactive-communication.html"><i class="fa fa-check"></i><b>7</b> Interactive communication</a>
<ul>
<li class="chapter" data-level="7.1" data-path="interactive-communication.html"><a href="interactive-communication.html#making-a-website"><i class="fa fa-check"></i><b>7.1</b> Making a website</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="interactive-communication.html"><a href="interactive-communication.html#introduction-5"><i class="fa fa-check"></i><b>7.1.1</b> Introduction</a></li>
<li class="chapter" data-level="7.1.2" data-path="interactive-communication.html"><a href="interactive-communication.html#postcards"><i class="fa fa-check"></i><b>7.1.2</b> Postcards</a></li>
<li class="chapter" data-level="7.1.3" data-path="interactive-communication.html"><a href="interactive-communication.html#distill"><i class="fa fa-check"></i><b>7.1.3</b> Distill</a></li>
<li class="chapter" data-level="7.1.4" data-path="interactive-communication.html"><a href="interactive-communication.html#blogdown"><i class="fa fa-check"></i><b>7.1.4</b> Blogdown</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="interactive-communication.html"><a href="interactive-communication.html#interactive-maps"><i class="fa fa-check"></i><b>7.2</b> Interactive maps</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="interactive-communication.html"><a href="interactive-communication.html#leaflet"><i class="fa fa-check"></i><b>7.2.1</b> Leaflet</a></li>
<li class="chapter" data-level="7.2.2" data-path="interactive-communication.html"><a href="interactive-communication.html#mapdeck"><i class="fa fa-check"></i><b>7.2.2</b> Mapdeck</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="interactive-communication.html"><a href="interactive-communication.html#shiny"><i class="fa fa-check"></i><b>7.3</b> Shiny</a></li>
<li class="chapter" data-level="7.4" data-path="interactive-communication.html"><a href="interactive-communication.html#exercises-and-tutorial-6"><i class="fa fa-check"></i><b>7.4</b> Exercises and tutorial</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="interactive-communication.html"><a href="interactive-communication.html#exercises-6"><i class="fa fa-check"></i><b>7.4.1</b> Exercises</a></li>
<li class="chapter" data-level="7.4.2" data-path="interactive-communication.html"><a href="interactive-communication.html#tutorial-6"><i class="fa fa-check"></i><b>7.4.2</b> Tutorial</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Measure and acquire</b></span></li>
<li class="chapter" data-level="8" data-path="gather-data.html"><a href="gather-data.html"><i class="fa fa-check"></i><b>8</b> Gather data</a>
<ul>
<li class="chapter" data-level="8.1" data-path="gather-data.html"><a href="gather-data.html#apis"><i class="fa fa-check"></i><b>8.1</b> APIs</a></li>
<li class="chapter" data-level="8.2" data-path="gather-data.html"><a href="gather-data.html#case-study---arxiv"><i class="fa fa-check"></i><b>8.2</b> Case study - arXiv</a></li>
<li class="chapter" data-level="8.3" data-path="gather-data.html"><a href="gather-data.html#case-study---rtweet"><i class="fa fa-check"></i><b>8.3</b> Case study - rtweet</a></li>
<li class="chapter" data-level="8.4" data-path="gather-data.html"><a href="gather-data.html#case-study---spotifyr"><i class="fa fa-check"></i><b>8.4</b> Case study - spotifyr</a></li>
<li class="chapter" data-level="8.5" data-path="gather-data.html"><a href="gather-data.html#scraping"><i class="fa fa-check"></i><b>8.5</b> Scraping</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="gather-data.html"><a href="gather-data.html#introduction-6"><i class="fa fa-check"></i><b>8.5.1</b> Introduction</a></li>
<li class="chapter" data-level="8.5.2" data-path="gather-data.html"><a href="gather-data.html#getting-started-3"><i class="fa fa-check"></i><b>8.5.2</b> Getting started</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="gather-data.html"><a href="gather-data.html#case-study---rohans-books"><i class="fa fa-check"></i><b>8.6</b> Case study - Rohan’s books</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="gather-data.html"><a href="gather-data.html#introduction-7"><i class="fa fa-check"></i><b>8.6.1</b> Introduction</a></li>
<li class="chapter" data-level="8.6.2" data-path="gather-data.html"><a href="gather-data.html#gather"><i class="fa fa-check"></i><b>8.6.2</b> Gather</a></li>
<li class="chapter" data-level="8.6.3" data-path="gather-data.html"><a href="gather-data.html#clean"><i class="fa fa-check"></i><b>8.6.3</b> Clean</a></li>
<li class="chapter" data-level="8.6.4" data-path="gather-data.html"><a href="gather-data.html#explore"><i class="fa fa-check"></i><b>8.6.4</b> Explore</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="gather-data.html"><a href="gather-data.html#case-study---canadian-prime-ministers"><i class="fa fa-check"></i><b>8.7</b> Case study - Canadian Prime Ministers</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="gather-data.html"><a href="gather-data.html#introduction-8"><i class="fa fa-check"></i><b>8.7.1</b> Introduction</a></li>
<li class="chapter" data-level="8.7.2" data-path="gather-data.html"><a href="gather-data.html#gather-1"><i class="fa fa-check"></i><b>8.7.2</b> Gather</a></li>
<li class="chapter" data-level="8.7.3" data-path="gather-data.html"><a href="gather-data.html#clean-1"><i class="fa fa-check"></i><b>8.7.3</b> Clean</a></li>
<li class="chapter" data-level="8.7.4" data-path="gather-data.html"><a href="gather-data.html#explore-1"><i class="fa fa-check"></i><b>8.7.4</b> Explore</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="gather-data.html"><a href="gather-data.html#pdfs"><i class="fa fa-check"></i><b>8.8</b> PDFs</a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="gather-data.html"><a href="gather-data.html#introduction-9"><i class="fa fa-check"></i><b>8.8.1</b> Introduction</a></li>
<li class="chapter" data-level="8.8.2" data-path="gather-data.html"><a href="gather-data.html#getting-started-4"><i class="fa fa-check"></i><b>8.8.2</b> Getting started</a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="gather-data.html"><a href="gather-data.html#case-study-us-total-fertility-rate-by-state-and-year-2000-2018"><i class="fa fa-check"></i><b>8.9</b> Case-study: US Total Fertility Rate, by state and year (2000-2018)</a>
<ul>
<li class="chapter" data-level="8.9.1" data-path="gather-data.html"><a href="gather-data.html#introduction-10"><i class="fa fa-check"></i><b>8.9.1</b> Introduction</a></li>
<li class="chapter" data-level="8.9.2" data-path="gather-data.html"><a href="gather-data.html#begin-with-an-end-in-mind"><i class="fa fa-check"></i><b>8.9.2</b> Begin with an end in mind</a></li>
<li class="chapter" data-level="8.9.3" data-path="gather-data.html"><a href="gather-data.html#start-simple-then-iterate."><i class="fa fa-check"></i><b>8.9.3</b> Start simple, then iterate.</a></li>
<li class="chapter" data-level="8.9.4" data-path="gather-data.html"><a href="gather-data.html#iterating"><i class="fa fa-check"></i><b>8.9.4</b> Iterating</a></li>
</ul></li>
<li class="chapter" data-level="8.10" data-path="gather-data.html"><a href="gather-data.html#semi-structured"><i class="fa fa-check"></i><b>8.10</b> Semi-structured</a>
<ul>
<li class="chapter" data-level="8.10.1" data-path="gather-data.html"><a href="gather-data.html#json-and-xml"><i class="fa fa-check"></i><b>8.10.1</b> JSON and XML</a></li>
</ul></li>
<li class="chapter" data-level="8.11" data-path="gather-data.html"><a href="gather-data.html#optical-character-recognition"><i class="fa fa-check"></i><b>8.11</b> Optical Character Recognition</a></li>
<li class="chapter" data-level="8.12" data-path="gather-data.html"><a href="gather-data.html#text"><i class="fa fa-check"></i><b>8.12</b> Text</a>
<ul>
<li class="chapter" data-level="8.12.1" data-path="gather-data.html"><a href="gather-data.html#introduction-11"><i class="fa fa-check"></i><b>8.12.1</b> Introduction</a></li>
<li class="chapter" data-level="8.12.2" data-path="gather-data.html"><a href="gather-data.html#getting-text-data"><i class="fa fa-check"></i><b>8.12.2</b> Getting text data</a></li>
<li class="chapter" data-level="8.12.3" data-path="gather-data.html"><a href="gather-data.html#preparing-text-datasets"><i class="fa fa-check"></i><b>8.12.3</b> Preparing text datasets</a></li>
</ul></li>
<li class="chapter" data-level="8.13" data-path="gather-data.html"><a href="gather-data.html#exercises-and-tutorial-7"><i class="fa fa-check"></i><b>8.13</b> Exercises and tutorial</a>
<ul>
<li class="chapter" data-level="8.13.1" data-path="gather-data.html"><a href="gather-data.html#exercises-7"><i class="fa fa-check"></i><b>8.13.1</b> Exercises</a></li>
<li class="chapter" data-level="8.13.2" data-path="gather-data.html"><a href="gather-data.html#tutorial-7"><i class="fa fa-check"></i><b>8.13.2</b> Tutorial</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="hunt-data.html"><a href="hunt-data.html"><i class="fa fa-check"></i><b>9</b> Hunt data</a>
<ul>
<li class="chapter" data-level="9.1" data-path="hunt-data.html"><a href="hunt-data.html#experiments-and-randomised-controlled-trials"><i class="fa fa-check"></i><b>9.1</b> Experiments and randomised controlled trials</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="hunt-data.html"><a href="hunt-data.html#introduction-12"><i class="fa fa-check"></i><b>9.1.1</b> Introduction</a></li>
<li class="chapter" data-level="9.1.2" data-path="hunt-data.html"><a href="hunt-data.html#motivation-and-notation"><i class="fa fa-check"></i><b>9.1.2</b> Motivation and notation</a></li>
<li class="chapter" data-level="9.1.3" data-path="hunt-data.html"><a href="hunt-data.html#randomised-sampling"><i class="fa fa-check"></i><b>9.1.3</b> Randomised sampling</a></li>
<li class="chapter" data-level="9.1.4" data-path="hunt-data.html"><a href="hunt-data.html#anova"><i class="fa fa-check"></i><b>9.1.4</b> ANOVA</a></li>
<li class="chapter" data-level="9.1.5" data-path="hunt-data.html"><a href="hunt-data.html#treatment-and-control"><i class="fa fa-check"></i><b>9.1.5</b> Treatment and control</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="hunt-data.html"><a href="hunt-data.html#case-study---fishers-tea-party"><i class="fa fa-check"></i><b>9.2</b> Case study - Fisher’s tea party</a></li>
<li class="chapter" data-level="9.3" data-path="hunt-data.html"><a href="hunt-data.html#case-study---tuskegee-syphilis-study"><i class="fa fa-check"></i><b>9.3</b> Case study - Tuskegee Syphilis Study</a></li>
<li class="chapter" data-level="9.4" data-path="hunt-data.html"><a href="hunt-data.html#sampling-and-survey-essentials"><i class="fa fa-check"></i><b>9.4</b> Sampling and survey essentials</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="hunt-data.html"><a href="hunt-data.html#introduction-13"><i class="fa fa-check"></i><b>9.4.1</b> Introduction</a></li>
<li class="chapter" data-level="9.4.2" data-path="hunt-data.html"><a href="hunt-data.html#simple-random-sampling"><i class="fa fa-check"></i><b>9.4.2</b> Simple random sampling</a></li>
<li class="chapter" data-level="9.4.3" data-path="hunt-data.html"><a href="hunt-data.html#stratified-and-cluster-sampling"><i class="fa fa-check"></i><b>9.4.3</b> Stratified and cluster sampling</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="hunt-data.html"><a href="hunt-data.html#case-study---the-oregon-health-insurance-experiment"><i class="fa fa-check"></i><b>9.5</b> Case study - The Oregon Health Insurance Experiment</a></li>
<li class="chapter" data-level="9.6" data-path="hunt-data.html"><a href="hunt-data.html#case-study---student-coaching-how-far-can-technology-go"><i class="fa fa-check"></i><b>9.6</b> Case study - Student Coaching: How Far Can Technology Go?</a></li>
<li class="chapter" data-level="9.7" data-path="hunt-data.html"><a href="hunt-data.html#case-study---civic-honesty-around-the-globe"><i class="fa fa-check"></i><b>9.7</b> Case study - Civic Honesty Around The Globe</a></li>
<li class="chapter" data-level="9.8" data-path="hunt-data.html"><a href="hunt-data.html#ab-testing"><i class="fa fa-check"></i><b>9.8</b> A/B testing</a>
<ul>
<li class="chapter" data-level="9.8.1" data-path="hunt-data.html"><a href="hunt-data.html#introduction-14"><i class="fa fa-check"></i><b>9.8.1</b> Introduction</a></li>
<li class="chapter" data-level="9.8.2" data-path="hunt-data.html"><a href="hunt-data.html#delivery"><i class="fa fa-check"></i><b>9.8.2</b> Delivery</a></li>
<li class="chapter" data-level="9.8.3" data-path="hunt-data.html"><a href="hunt-data.html#instrumentation"><i class="fa fa-check"></i><b>9.8.3</b> Instrumentation</a></li>
<li class="chapter" data-level="9.8.4" data-path="hunt-data.html"><a href="hunt-data.html#randomisation-unit"><i class="fa fa-check"></i><b>9.8.4</b> Randomisation unit</a></li>
<li class="chapter" data-level="9.8.5" data-path="hunt-data.html"><a href="hunt-data.html#partnerships"><i class="fa fa-check"></i><b>9.8.5</b> Partnerships</a></li>
<li class="chapter" data-level="9.8.6" data-path="hunt-data.html"><a href="hunt-data.html#speed-vs-quality"><i class="fa fa-check"></i><b>9.8.6</b> Speed vs quality</a></li>
<li class="chapter" data-level="9.8.7" data-path="hunt-data.html"><a href="hunt-data.html#conflicting-priorities"><i class="fa fa-check"></i><b>9.8.7</b> Conflicting priorities</a></li>
</ul></li>
<li class="chapter" data-level="9.9" data-path="hunt-data.html"><a href="hunt-data.html#case-study---upworthy"><i class="fa fa-check"></i><b>9.9</b> Case study - Upworthy</a></li>
<li class="chapter" data-level="9.10" data-path="hunt-data.html"><a href="hunt-data.html#implementing-surveys"><i class="fa fa-check"></i><b>9.10</b> Implementing surveys</a>
<ul>
<li class="chapter" data-level="9.10.1" data-path="hunt-data.html"><a href="hunt-data.html#google"><i class="fa fa-check"></i><b>9.10.1</b> Google</a></li>
<li class="chapter" data-level="9.10.2" data-path="hunt-data.html"><a href="hunt-data.html#facebook"><i class="fa fa-check"></i><b>9.10.2</b> Facebook</a></li>
<li class="chapter" data-level="9.10.3" data-path="hunt-data.html"><a href="hunt-data.html#survey-monkey"><i class="fa fa-check"></i><b>9.10.3</b> Survey Monkey</a></li>
<li class="chapter" data-level="9.10.4" data-path="hunt-data.html"><a href="hunt-data.html#mechanical-turk"><i class="fa fa-check"></i><b>9.10.4</b> Mechanical Turk</a></li>
<li class="chapter" data-level="9.10.5" data-path="hunt-data.html"><a href="hunt-data.html#prolific"><i class="fa fa-check"></i><b>9.10.5</b> Prolific</a></li>
<li class="chapter" data-level="9.10.6" data-path="hunt-data.html"><a href="hunt-data.html#qualtrics"><i class="fa fa-check"></i><b>9.10.6</b> Qualtrics</a></li>
<li class="chapter" data-level="9.10.7" data-path="hunt-data.html"><a href="hunt-data.html#other-2"><i class="fa fa-check"></i><b>9.10.7</b> Other</a></li>
</ul></li>
<li class="chapter" data-level="9.11" data-path="hunt-data.html"><a href="hunt-data.html#next-steps-1"><i class="fa fa-check"></i><b>9.11</b> Next steps</a></li>
<li class="chapter" data-level="9.12" data-path="hunt-data.html"><a href="hunt-data.html#exercises-and-tutorial-8"><i class="fa fa-check"></i><b>9.12</b> Exercises and tutorial</a>
<ul>
<li class="chapter" data-level="9.12.1" data-path="hunt-data.html"><a href="hunt-data.html#exercises-8"><i class="fa fa-check"></i><b>9.12.1</b> Exercises</a></li>
<li class="chapter" data-level="9.12.2" data-path="hunt-data.html"><a href="hunt-data.html#tutorial-8"><i class="fa fa-check"></i><b>9.12.2</b> Tutorial</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="farm-data.html"><a href="farm-data.html"><i class="fa fa-check"></i><b>10</b> Farm data</a>
<ul>
<li class="chapter" data-level="10.1" data-path="farm-data.html"><a href="farm-data.html#overview"><i class="fa fa-check"></i><b>10.1</b> Overview</a></li>
<li class="chapter" data-level="10.2" data-path="farm-data.html"><a href="farm-data.html#censuses"><i class="fa fa-check"></i><b>10.2</b> Censuses</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="farm-data.html"><a href="farm-data.html#canada"><i class="fa fa-check"></i><b>10.2.1</b> Canada</a></li>
<li class="chapter" data-level="10.2.2" data-path="farm-data.html"><a href="farm-data.html#usa"><i class="fa fa-check"></i><b>10.2.2</b> USA</a></li>
<li class="chapter" data-level="10.2.3" data-path="farm-data.html"><a href="farm-data.html#australia"><i class="fa fa-check"></i><b>10.2.3</b> Australia</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="farm-data.html"><a href="farm-data.html#other-government-data"><i class="fa fa-check"></i><b>10.3</b> Other government data</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="farm-data.html"><a href="farm-data.html#unemployment"><i class="fa fa-check"></i><b>10.3.1</b> Unemployment</a></li>
<li class="chapter" data-level="10.3.2" data-path="farm-data.html"><a href="farm-data.html#weather"><i class="fa fa-check"></i><b>10.3.2</b> Weather</a></li>
<li class="chapter" data-level="10.3.3" data-path="farm-data.html"><a href="farm-data.html#that-canadian-survey-that-we-used-in-sta304-from-the-library"><i class="fa fa-check"></i><b>10.3.3</b> That Canadian survey that we used in STA304 from the library</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="farm-data.html"><a href="farm-data.html#open-government-data"><i class="fa fa-check"></i><b>10.4</b> Open Government Data</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="farm-data.html"><a href="farm-data.html#canada-1"><i class="fa fa-check"></i><b>10.4.1</b> Canada</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="farm-data.html"><a href="farm-data.html#electoral-studies"><i class="fa fa-check"></i><b>10.5</b> Electoral Studies</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="farm-data.html"><a href="farm-data.html#canadian-electoral-study"><i class="fa fa-check"></i><b>10.5.1</b> Canadian Electoral Study</a></li>
<li class="chapter" data-level="10.5.2" data-path="farm-data.html"><a href="farm-data.html#australian-electoral-study"><i class="fa fa-check"></i><b>10.5.2</b> Australian Electoral Study</a></li>
<li class="chapter" data-level="10.5.3" data-path="farm-data.html"><a href="farm-data.html#cces"><i class="fa fa-check"></i><b>10.5.3</b> CCES</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="farm-data.html"><a href="farm-data.html#other-3"><i class="fa fa-check"></i><b>10.6</b> Other</a></li>
<li class="chapter" data-level="10.7" data-path="farm-data.html"><a href="farm-data.html#exercises-and-tutorial-9"><i class="fa fa-check"></i><b>10.7</b> Exercises and tutorial</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="farm-data.html"><a href="farm-data.html#exercises-9"><i class="fa fa-check"></i><b>10.7.1</b> Exercises</a></li>
<li class="chapter" data-level="10.7.2" data-path="farm-data.html"><a href="farm-data.html#tutorial-9"><i class="fa fa-check"></i><b>10.7.2</b> Tutorial</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Preparation</b></span></li>
<li class="chapter" data-level="11" data-path="cleaning-and-preparing-data.html"><a href="cleaning-and-preparing-data.html"><i class="fa fa-check"></i><b>11</b> Cleaning and preparing data</a>
<ul>
<li class="chapter" data-level="11.1" data-path="cleaning-and-preparing-data.html"><a href="cleaning-and-preparing-data.html#introduction-15"><i class="fa fa-check"></i><b>11.1</b> Introduction</a></li>
<li class="chapter" data-level="11.2" data-path="cleaning-and-preparing-data.html"><a href="cleaning-and-preparing-data.html#workflow-1"><i class="fa fa-check"></i><b>11.2</b> Workflow</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="cleaning-and-preparing-data.html"><a href="cleaning-and-preparing-data.html#save-a-copy-of-the-raw-data"><i class="fa fa-check"></i><b>11.2.1</b> Save a copy of the raw data</a></li>
<li class="chapter" data-level="11.2.2" data-path="cleaning-and-preparing-data.html"><a href="cleaning-and-preparing-data.html#begin-with-an-end-in-mind-1"><i class="fa fa-check"></i><b>11.2.2</b> Begin with an end in mind</a></li>
<li class="chapter" data-level="11.2.3" data-path="cleaning-and-preparing-data.html"><a href="cleaning-and-preparing-data.html#start-small"><i class="fa fa-check"></i><b>11.2.3</b> Start small</a></li>
<li class="chapter" data-level="11.2.4" data-path="cleaning-and-preparing-data.html"><a href="cleaning-and-preparing-data.html#write-tests-and-documentation."><i class="fa fa-check"></i><b>11.2.4</b> Write tests and documentation.</a></li>
<li class="chapter" data-level="11.2.5" data-path="cleaning-and-preparing-data.html"><a href="cleaning-and-preparing-data.html#iterate-generalize-and-update"><i class="fa fa-check"></i><b>11.2.5</b> Iterate, generalize and update</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="cleaning-and-preparing-data.html"><a href="cleaning-and-preparing-data.html#case-study---kenya-census"><i class="fa fa-check"></i><b>11.3</b> Case study - Kenya census</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="cleaning-and-preparing-data.html"><a href="cleaning-and-preparing-data.html#set-up"><i class="fa fa-check"></i><b>11.3.1</b> Set-up</a></li>
<li class="chapter" data-level="11.3.2" data-path="cleaning-and-preparing-data.html"><a href="cleaning-and-preparing-data.html#extract"><i class="fa fa-check"></i><b>11.3.2</b> Extract</a></li>
<li class="chapter" data-level="11.3.3" data-path="cleaning-and-preparing-data.html"><a href="cleaning-and-preparing-data.html#clean-2"><i class="fa fa-check"></i><b>11.3.3</b> Clean</a></li>
<li class="chapter" data-level="11.3.4" data-path="cleaning-and-preparing-data.html"><a href="cleaning-and-preparing-data.html#check"><i class="fa fa-check"></i><b>11.3.4</b> Check</a></li>
<li class="chapter" data-level="11.3.5" data-path="cleaning-and-preparing-data.html"><a href="cleaning-and-preparing-data.html#tidy-up"><i class="fa fa-check"></i><b>11.3.5</b> Tidy-up</a></li>
<li class="chapter" data-level="11.3.6" data-path="cleaning-and-preparing-data.html"><a href="cleaning-and-preparing-data.html#make-monicas-dataset"><i class="fa fa-check"></i><b>11.3.6</b> Make Monica’s dataset</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="cleaning-and-preparing-data.html"><a href="cleaning-and-preparing-data.html#checks-and-tests"><i class="fa fa-check"></i><b>11.4</b> Checks and tests</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="cleaning-and-preparing-data.html"><a href="cleaning-and-preparing-data.html#plots"><i class="fa fa-check"></i><b>11.4.1</b> Plots</a></li>
<li class="chapter" data-level="11.4.2" data-path="cleaning-and-preparing-data.html"><a href="cleaning-and-preparing-data.html#counts"><i class="fa fa-check"></i><b>11.4.2</b> Counts</a></li>
<li class="chapter" data-level="11.4.3" data-path="cleaning-and-preparing-data.html"><a href="cleaning-and-preparing-data.html#gono-go"><i class="fa fa-check"></i><b>11.4.3</b> Go/no-go</a></li>
<li class="chapter" data-level="11.4.4" data-path="cleaning-and-preparing-data.html"><a href="cleaning-and-preparing-data.html#class-1"><i class="fa fa-check"></i><b>11.4.4</b> Class</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="cleaning-and-preparing-data.html"><a href="cleaning-and-preparing-data.html#naming-things"><i class="fa fa-check"></i><b>11.5</b> Naming things</a></li>
<li class="chapter" data-level="11.6" data-path="cleaning-and-preparing-data.html"><a href="cleaning-and-preparing-data.html#exercises-and-tutorial-10"><i class="fa fa-check"></i><b>11.6</b> Exercises and tutorial</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="cleaning-and-preparing-data.html"><a href="cleaning-and-preparing-data.html#exercises-10"><i class="fa fa-check"></i><b>11.6.1</b> Exercises</a></li>
<li class="chapter" data-level="11.6.2" data-path="cleaning-and-preparing-data.html"><a href="cleaning-and-preparing-data.html#tutorial-10"><i class="fa fa-check"></i><b>11.6.2</b> Tutorial</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="storing-and-retrieving-data.html"><a href="storing-and-retrieving-data.html"><i class="fa fa-check"></i><b>12</b> Storing and retrieving data</a>
<ul>
<li class="chapter" data-level="12.1" data-path="storing-and-retrieving-data.html"><a href="storing-and-retrieving-data.html#introduction-16"><i class="fa fa-check"></i><b>12.1</b> Introduction</a></li>
<li class="chapter" data-level="12.2" data-path="storing-and-retrieving-data.html"><a href="storing-and-retrieving-data.html#plan"><i class="fa fa-check"></i><b>12.2</b> Plan</a></li>
<li class="chapter" data-level="12.3" data-path="storing-and-retrieving-data.html"><a href="storing-and-retrieving-data.html#r-packages-for-data"><i class="fa fa-check"></i><b>12.3</b> R Packages for data</a></li>
<li class="chapter" data-level="12.4" data-path="storing-and-retrieving-data.html"><a href="storing-and-retrieving-data.html#documentation"><i class="fa fa-check"></i><b>12.4</b> Documentation</a></li>
<li class="chapter" data-level="12.5" data-path="storing-and-retrieving-data.html"><a href="storing-and-retrieving-data.html#exercises-and-tutorial-11"><i class="fa fa-check"></i><b>12.5</b> Exercises and tutorial</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="storing-and-retrieving-data.html"><a href="storing-and-retrieving-data.html#exercises-11"><i class="fa fa-check"></i><b>12.5.1</b> Exercises</a></li>
<li class="chapter" data-level="12.5.2" data-path="storing-and-retrieving-data.html"><a href="storing-and-retrieving-data.html#tutorial-11"><i class="fa fa-check"></i><b>12.5.2</b> Tutorial</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="disseminating-and-protecting-data.html"><a href="disseminating-and-protecting-data.html"><i class="fa fa-check"></i><b>13</b> Disseminating and protecting data</a>
<ul>
<li class="chapter" data-level="13.1" data-path="disseminating-and-protecting-data.html"><a href="disseminating-and-protecting-data.html#introduction-17"><i class="fa fa-check"></i><b>13.1</b> Introduction</a></li>
<li class="chapter" data-level="13.2" data-path="disseminating-and-protecting-data.html"><a href="disseminating-and-protecting-data.html#what-is-personally-identifying-information"><i class="fa fa-check"></i><b>13.2</b> What is personally identifying information</a></li>
<li class="chapter" data-level="13.3" data-path="disseminating-and-protecting-data.html"><a href="disseminating-and-protecting-data.html#hashing-and-salting"><i class="fa fa-check"></i><b>13.3</b> Hashing and salting</a></li>
<li class="chapter" data-level="13.4" data-path="disseminating-and-protecting-data.html"><a href="disseminating-and-protecting-data.html#gdpr-and-hipaa"><i class="fa fa-check"></i><b>13.4</b> GDPR and HIPAA</a></li>
<li class="chapter" data-level="13.5" data-path="disseminating-and-protecting-data.html"><a href="disseminating-and-protecting-data.html#making-fake-data-to-distribute-when-you-cant-share-the-real-stuff"><i class="fa fa-check"></i><b>13.5</b> Making fake data to distribute when you can’t share the real stuff</a></li>
<li class="chapter" data-level="13.6" data-path="disseminating-and-protecting-data.html"><a href="disseminating-and-protecting-data.html#differential-privacy"><i class="fa fa-check"></i><b>13.6</b> Differential privacy</a></li>
<li class="chapter" data-level="13.7" data-path="disseminating-and-protecting-data.html"><a href="disseminating-and-protecting-data.html#exercises-and-tutorial-12"><i class="fa fa-check"></i><b>13.7</b> Exercises and tutorial</a>
<ul>
<li class="chapter" data-level="13.7.1" data-path="disseminating-and-protecting-data.html"><a href="disseminating-and-protecting-data.html#exercises-12"><i class="fa fa-check"></i><b>13.7.1</b> Exercises</a></li>
<li class="chapter" data-level="13.7.2" data-path="disseminating-and-protecting-data.html"><a href="disseminating-and-protecting-data.html#tutorial-12"><i class="fa fa-check"></i><b>13.7.2</b> Tutorial</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>V Modelling</b></span></li>
<li class="chapter" data-level="14" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html"><i class="fa fa-check"></i><b>14</b> Exploratory data analysis</a>
<ul>
<li class="chapter" data-level="14.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#introduction-18"><i class="fa fa-check"></i><b>14.1</b> Introduction</a></li>
<li class="chapter" data-level="14.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#case-study---ttc-subway-delays"><i class="fa fa-check"></i><b>14.2</b> Case study - TTC subway delays</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#introduction-19"><i class="fa fa-check"></i><b>14.2.1</b> Introduction</a></li>
<li class="chapter" data-level="14.2.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#gather-the-data"><i class="fa fa-check"></i><b>14.2.2</b> Gather the data</a></li>
<li class="chapter" data-level="14.2.3" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#sanity-checks"><i class="fa fa-check"></i><b>14.2.3</b> Sanity Checks</a></li>
<li class="chapter" data-level="14.2.4" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#missing-values"><i class="fa fa-check"></i><b>14.2.4</b> Missing values</a></li>
<li class="chapter" data-level="14.2.5" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#duplicate-rows"><i class="fa fa-check"></i><b>14.2.5</b> Duplicate rows</a></li>
<li class="chapter" data-level="14.2.6" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#visualizing-distributions"><i class="fa fa-check"></i><b>14.2.6</b> Visualizing distributions</a></li>
<li class="chapter" data-level="14.2.7" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#groups-and-small-counts"><i class="fa fa-check"></i><b>14.2.7</b> Groups and small counts</a></li>
<li class="chapter" data-level="14.2.8" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#visualizing-time-series"><i class="fa fa-check"></i><b>14.2.8</b> Visualizing time series</a></li>
<li class="chapter" data-level="14.2.9" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#visualizing-relationships"><i class="fa fa-check"></i><b>14.2.9</b> Visualizing relationships</a></li>
<li class="chapter" data-level="14.2.10" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#principal-components-analysis"><i class="fa fa-check"></i><b>14.2.10</b> Principal components analysis</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#case-study---opinions-about-a-casino-in-toronto"><i class="fa fa-check"></i><b>14.3</b> Case study - Opinions about a casino in Toronto</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#data-preparation"><i class="fa fa-check"></i><b>14.3.1</b> Data preparation</a></li>
<li class="chapter" data-level="14.3.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#some-visual-exploration-and-more-cleanup-of-course"><i class="fa fa-check"></i><b>14.3.2</b> Some visual exploration (and more cleanup, of course)</a></li>
<li class="chapter" data-level="14.3.3" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#getting-the-data-into-a-more-model-suitable-format"><i class="fa fa-check"></i><b>14.3.3</b> Getting the data into a more model-suitable format</a></li>
<li class="chapter" data-level="14.3.4" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#logistic-regression"><i class="fa fa-check"></i><b>14.3.4</b> Logistic Regression</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#case-study---airbnb-listing-in-toronto"><i class="fa fa-check"></i><b>14.4</b> Case study - Airbnb listing in Toronto</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#essentials"><i class="fa fa-check"></i><b>14.4.1</b> Essentials</a></li>
<li class="chapter" data-level="14.4.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#set-up-1"><i class="fa fa-check"></i><b>14.4.2</b> Set up</a></li>
<li class="chapter" data-level="14.4.3" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#get-data"><i class="fa fa-check"></i><b>14.4.3</b> Get data</a></li>
<li class="chapter" data-level="14.4.4" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#clean-data-1"><i class="fa fa-check"></i><b>14.4.4</b> Clean data</a></li>
<li class="chapter" data-level="14.4.5" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#explore-data"><i class="fa fa-check"></i><b>14.4.5</b> Explore data</a></li>
<li class="chapter" data-level="14.4.6" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#model-data"><i class="fa fa-check"></i><b>14.4.6</b> Model data</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#exercises-and-tutorial-13"><i class="fa fa-check"></i><b>14.5</b> Exercises and tutorial</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#exercises-13"><i class="fa fa-check"></i><b>14.5.1</b> Exercises</a></li>
<li class="chapter" data-level="14.5.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#tutorial-13"><i class="fa fa-check"></i><b>14.5.2</b> Tutorial</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="ijalm.html"><a href="ijalm.html"><i class="fa fa-check"></i><b>15</b> It’s Just A Linear Model</a>
<ul>
<li class="chapter" data-level="15.1" data-path="ijalm.html"><a href="ijalm.html#overview-1"><i class="fa fa-check"></i><b>15.1</b> Overview</a></li>
<li class="chapter" data-level="15.2" data-path="ijalm.html"><a href="ijalm.html#simple-linear-regression"><i class="fa fa-check"></i><b>15.2</b> Simple linear regression</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="ijalm.html"><a href="ijalm.html#overview-2"><i class="fa fa-check"></i><b>15.2.1</b> Overview</a></li>
<li class="chapter" data-level="15.2.2" data-path="ijalm.html"><a href="ijalm.html#implementation-in-base-r"><i class="fa fa-check"></i><b>15.2.2</b> Implementation in base R</a></li>
<li class="chapter" data-level="15.2.3" data-path="ijalm.html"><a href="ijalm.html#tidy-up-with-broom"><i class="fa fa-check"></i><b>15.2.3</b> Tidy up with broom</a></li>
<li class="chapter" data-level="15.2.4" data-path="ijalm.html"><a href="ijalm.html#testing-hypothesis"><i class="fa fa-check"></i><b>15.2.4</b> Testing hypothesis</a></li>
<li class="chapter" data-level="15.2.5" data-path="ijalm.html"><a href="ijalm.html#on-p-values"><i class="fa fa-check"></i><b>15.2.5</b> On p-values</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="ijalm.html"><a href="ijalm.html#multiple-linear-regression"><i class="fa fa-check"></i><b>15.3</b> Multiple linear regression</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="ijalm.html"><a href="ijalm.html#threats-to-validity-and-aspects-to-think-about"><i class="fa fa-check"></i><b>15.3.1</b> Threats to validity and aspects to think about</a></li>
<li class="chapter" data-level="15.3.2" data-path="ijalm.html"><a href="ijalm.html#more-credible-outputs"><i class="fa fa-check"></i><b>15.3.2</b> More credible outputs</a></li>
<li class="chapter" data-level="15.3.3" data-path="ijalm.html"><a href="ijalm.html#implementation-in-tidymodels"><i class="fa fa-check"></i><b>15.3.3</b> Implementation in <code>tidymodels</code></a></li>
<li class="chapter" data-level="15.3.4" data-path="ijalm.html"><a href="ijalm.html#implementation-in-rstanarm"><i class="fa fa-check"></i><b>15.3.4</b> Implementation in <code>rstanarm</code></a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="ijalm.html"><a href="ijalm.html#logistic-regression-2"><i class="fa fa-check"></i><b>15.4</b> Logistic regression</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="ijalm.html"><a href="ijalm.html#overview-3"><i class="fa fa-check"></i><b>15.4.1</b> Overview</a></li>
<li class="chapter" data-level="15.4.2" data-path="ijalm.html"><a href="ijalm.html#implementation-in-base"><i class="fa fa-check"></i><b>15.4.2</b> Implementation in base</a></li>
<li class="chapter" data-level="15.4.3" data-path="ijalm.html"><a href="ijalm.html#implementation-in-tidymodels-1"><i class="fa fa-check"></i><b>15.4.3</b> Implementation in <code>tidymodels</code></a></li>
<li class="chapter" data-level="15.4.4" data-path="ijalm.html"><a href="ijalm.html#implementation-in-rstanarm-1"><i class="fa fa-check"></i><b>15.4.4</b> Implementation in <code>rstanarm</code></a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="ijalm.html"><a href="ijalm.html#poisson-regression"><i class="fa fa-check"></i><b>15.5</b> Poisson regression</a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="ijalm.html"><a href="ijalm.html#overview-4"><i class="fa fa-check"></i><b>15.5.1</b> Overview</a></li>
<li class="chapter" data-level="15.5.2" data-path="ijalm.html"><a href="ijalm.html#implementation-in-base-1"><i class="fa fa-check"></i><b>15.5.2</b> Implementation in base</a></li>
<li class="chapter" data-level="15.5.3" data-path="ijalm.html"><a href="ijalm.html#implementation-in-tidymodels-2"><i class="fa fa-check"></i><b>15.5.3</b> Implementation in <code>tidymodels</code></a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="ijalm.html"><a href="ijalm.html#exercises-and-tutorial-14"><i class="fa fa-check"></i><b>15.6</b> Exercises and tutorial</a>
<ul>
<li class="chapter" data-level="15.6.1" data-path="ijalm.html"><a href="ijalm.html#exercises-14"><i class="fa fa-check"></i><b>15.6.1</b> Exercises</a></li>
<li class="chapter" data-level="15.6.2" data-path="ijalm.html"><a href="ijalm.html#tutorial-14"><i class="fa fa-check"></i><b>15.6.2</b> Tutorial</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="causality.html"><a href="causality.html"><i class="fa fa-check"></i><b>16</b> Causality from observational data</a>
<ul>
<li class="chapter" data-level="16.1" data-path="causality.html"><a href="causality.html#introduction-20"><i class="fa fa-check"></i><b>16.1</b> Introduction</a></li>
<li class="chapter" data-level="16.2" data-path="causality.html"><a href="causality.html#dags-and-trying-not-to-be-tricked-by-the-data"><i class="fa fa-check"></i><b>16.2</b> DAGs and trying not to be tricked by the data</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="causality.html"><a href="causality.html#dags-and-confounding"><i class="fa fa-check"></i><b>16.2.1</b> DAGs and confounding</a></li>
<li class="chapter" data-level="16.2.2" data-path="causality.html"><a href="causality.html#selection-and-measurement-bias"><i class="fa fa-check"></i><b>16.2.2</b> Selection and measurement bias</a></li>
<li class="chapter" data-level="16.2.3" data-path="causality.html"><a href="causality.html#two-common-paradoxes"><i class="fa fa-check"></i><b>16.2.3</b> Two common paradoxes</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="causality.html"><a href="causality.html#difference-in-differences"><i class="fa fa-check"></i><b>16.3</b> Difference in differences</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="causality.html"><a href="causality.html#matching-and-difference-in-differences"><i class="fa fa-check"></i><b>16.3.1</b> Matching and difference-in-differences</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="causality.html"><a href="causality.html#case-study---lower-advertising-revenue-reduced-french-newspaper-prices-between-1960-and-1974"><i class="fa fa-check"></i><b>16.4</b> Case study - Lower advertising revenue reduced French newspaper prices between 1960 and 1974</a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="causality.html"><a href="causality.html#introduction-22"><i class="fa fa-check"></i><b>16.4.1</b> Introduction</a></li>
<li class="chapter" data-level="16.4.2" data-path="causality.html"><a href="causality.html#background"><i class="fa fa-check"></i><b>16.4.2</b> Background</a></li>
<li class="chapter" data-level="16.4.3" data-path="causality.html"><a href="causality.html#data"><i class="fa fa-check"></i><b>16.4.3</b> Data</a></li>
<li class="chapter" data-level="16.4.4" data-path="causality.html"><a href="causality.html#model"><i class="fa fa-check"></i><b>16.4.4</b> Model</a></li>
<li class="chapter" data-level="16.4.5" data-path="causality.html"><a href="causality.html#results"><i class="fa fa-check"></i><b>16.4.5</b> Results</a></li>
<li class="chapter" data-level="16.4.6" data-path="causality.html"><a href="causality.html#other-points"><i class="fa fa-check"></i><b>16.4.6</b> Other points</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="causality.html"><a href="causality.html#case-study---funding-of-clinical-trials-and-reported-drug-efficacy"><i class="fa fa-check"></i><b>16.5</b> Case study - Funding of Clinical Trials and Reported Drug Efficacy</a></li>
<li class="chapter" data-level="16.6" data-path="causality.html"><a href="causality.html#regression-discontinuity-design"><i class="fa fa-check"></i><b>16.6</b> Regression discontinuity design</a>
<ul>
<li class="chapter" data-level="16.6.1" data-path="causality.html"><a href="causality.html#introduction-23"><i class="fa fa-check"></i><b>16.6.1</b> Introduction</a></li>
<li class="chapter" data-level="16.6.2" data-path="causality.html"><a href="causality.html#simulated-example-1"><i class="fa fa-check"></i><b>16.6.2</b> Simulated example</a></li>
<li class="chapter" data-level="16.6.3" data-path="causality.html"><a href="causality.html#overlap"><i class="fa fa-check"></i><b>16.6.3</b> Overlap</a></li>
<li class="chapter" data-level="16.6.4" data-path="causality.html"><a href="causality.html#examples"><i class="fa fa-check"></i><b>16.6.4</b> Examples</a></li>
<li class="chapter" data-level="16.6.5" data-path="causality.html"><a href="causality.html#implementation"><i class="fa fa-check"></i><b>16.6.5</b> Implementation</a></li>
<li class="chapter" data-level="16.6.6" data-path="causality.html"><a href="causality.html#fuzzy-rdd"><i class="fa fa-check"></i><b>16.6.6</b> Fuzzy RDD</a></li>
<li class="chapter" data-level="16.6.7" data-path="causality.html"><a href="causality.html#threats-to-validity"><i class="fa fa-check"></i><b>16.6.7</b> Threats to validity</a></li>
<li class="chapter" data-level="16.6.8" data-path="causality.html"><a href="causality.html#weaknesses"><i class="fa fa-check"></i><b>16.6.8</b> Weaknesses</a></li>
</ul></li>
<li class="chapter" data-level="16.7" data-path="causality.html"><a href="causality.html#case-study---stiers-hooghe-and-dassonneville-2020"><i class="fa fa-check"></i><b>16.7</b> Case study - Stiers, Hooghe, and Dassonneville, 2020</a></li>
<li class="chapter" data-level="16.8" data-path="causality.html"><a href="causality.html#case-study---caughey-and-sekhon.-2011"><i class="fa fa-check"></i><b>16.8</b> Case study - Caughey, and Sekhon., 2011</a></li>
<li class="chapter" data-level="16.9" data-path="causality.html"><a href="causality.html#instrumental-variables"><i class="fa fa-check"></i><b>16.9</b> Instrumental variables</a>
<ul>
<li class="chapter" data-level="16.9.1" data-path="causality.html"><a href="causality.html#introduction-24"><i class="fa fa-check"></i><b>16.9.1</b> Introduction</a></li>
<li class="chapter" data-level="16.9.2" data-path="causality.html"><a href="causality.html#history"><i class="fa fa-check"></i><b>16.9.2</b> History</a></li>
<li class="chapter" data-level="16.9.3" data-path="causality.html"><a href="causality.html#simulated-example-2"><i class="fa fa-check"></i><b>16.9.3</b> Simulated example</a></li>
<li class="chapter" data-level="16.9.4" data-path="causality.html"><a href="causality.html#implementation-1"><i class="fa fa-check"></i><b>16.9.4</b> Implementation</a></li>
<li class="chapter" data-level="16.9.5" data-path="causality.html"><a href="causality.html#assumptions-1"><i class="fa fa-check"></i><b>16.9.5</b> Assumptions</a></li>
<li class="chapter" data-level="16.9.6" data-path="causality.html"><a href="causality.html#conclusion"><i class="fa fa-check"></i><b>16.9.6</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="16.10" data-path="causality.html"><a href="causality.html#case-study---effect-of-police-on-crime"><i class="fa fa-check"></i><b>16.10</b> Case study - Effect of Police on Crime</a>
<ul>
<li class="chapter" data-level="16.10.1" data-path="causality.html"><a href="causality.html#overview-5"><i class="fa fa-check"></i><b>16.10.1</b> Overview</a></li>
<li class="chapter" data-level="16.10.2" data-path="causality.html"><a href="causality.html#data-1"><i class="fa fa-check"></i><b>16.10.2</b> Data</a></li>
<li class="chapter" data-level="16.10.3" data-path="causality.html"><a href="causality.html#model-1"><i class="fa fa-check"></i><b>16.10.3</b> Model</a></li>
<li class="chapter" data-level="16.10.4" data-path="causality.html"><a href="causality.html#discussion"><i class="fa fa-check"></i><b>16.10.4</b> Discussion</a></li>
</ul></li>
<li class="chapter" data-level="16.11" data-path="causality.html"><a href="causality.html#exercises-and-tutorial-15"><i class="fa fa-check"></i><b>16.11</b> Exercises and tutorial</a>
<ul>
<li class="chapter" data-level="16.11.1" data-path="causality.html"><a href="causality.html#exercises-15"><i class="fa fa-check"></i><b>16.11.1</b> Exercises</a></li>
<li class="chapter" data-level="16.11.2" data-path="causality.html"><a href="causality.html#tutorial-15"><i class="fa fa-check"></i><b>16.11.2</b> Tutorial</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="mrp.html"><a href="mrp.html"><i class="fa fa-check"></i><b>17</b> Multilevel regression with post-stratification</a>
<ul>
<li class="chapter" data-level="17.1" data-path="mrp.html"><a href="mrp.html#introduction-25"><i class="fa fa-check"></i><b>17.1</b> Introduction</a></li>
<li class="chapter" data-level="17.2" data-path="mrp.html"><a href="mrp.html#simulation---toddler-bedtimes"><i class="fa fa-check"></i><b>17.2</b> Simulation - Toddler bedtimes</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="mrp.html"><a href="mrp.html#construct-a-population"><i class="fa fa-check"></i><b>17.2.1</b> Construct a population</a></li>
<li class="chapter" data-level="17.2.2" data-path="mrp.html"><a href="mrp.html#get-a-biased-sample-from-it"><i class="fa fa-check"></i><b>17.2.2</b> Get a biased sample from it</a></li>
<li class="chapter" data-level="17.2.3" data-path="mrp.html"><a href="mrp.html#model-the-sample"><i class="fa fa-check"></i><b>17.2.3</b> Model the sample</a></li>
<li class="chapter" data-level="17.2.4" data-path="mrp.html"><a href="mrp.html#get-a-post-stratification-dataset"><i class="fa fa-check"></i><b>17.2.4</b> Get a post-stratification dataset</a></li>
<li class="chapter" data-level="17.2.5" data-path="mrp.html"><a href="mrp.html#post-stratify-our-model-estimates"><i class="fa fa-check"></i><b>17.2.5</b> Post-stratify our model estimates</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="mrp.html"><a href="mrp.html#case-study---xbox-paper"><i class="fa fa-check"></i><b>17.3</b> Case study - Xbox paper</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="mrp.html"><a href="mrp.html#overview-6"><i class="fa fa-check"></i><b>17.3.1</b> Overview</a></li>
<li class="chapter" data-level="17.3.2" data-path="mrp.html"><a href="mrp.html#model-2"><i class="fa fa-check"></i><b>17.3.2</b> Model</a></li>
<li class="chapter" data-level="17.3.3" data-path="mrp.html"><a href="mrp.html#post-stratify"><i class="fa fa-check"></i><b>17.3.3</b> Post-stratify</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="mrp.html"><a href="mrp.html#simulation---australian-voting"><i class="fa fa-check"></i><b>17.4</b> Simulation - Australian voting</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="mrp.html"><a href="mrp.html#overview-7"><i class="fa fa-check"></i><b>17.4.1</b> Overview</a></li>
<li class="chapter" data-level="17.4.2" data-path="mrp.html"><a href="mrp.html#construct-a-survey"><i class="fa fa-check"></i><b>17.4.2</b> Construct a survey</a></li>
<li class="chapter" data-level="17.4.3" data-path="mrp.html"><a href="mrp.html#model-the-survey"><i class="fa fa-check"></i><b>17.4.3</b> Model the survey</a></li>
<li class="chapter" data-level="17.4.4" data-path="mrp.html"><a href="mrp.html#post-stratify-1"><i class="fa fa-check"></i><b>17.4.4</b> Post-stratify</a></li>
<li class="chapter" data-level="17.4.5" data-path="mrp.html"><a href="mrp.html#improving-the-model"><i class="fa fa-check"></i><b>17.4.5</b> Improving the model</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="mrp.html"><a href="mrp.html#forecasting-the-2020-us-election"><i class="fa fa-check"></i><b>17.5</b> Forecasting the 2020 US election</a>
<ul>
<li class="chapter" data-level="17.5.1" data-path="mrp.html"><a href="mrp.html#survey-data"><i class="fa fa-check"></i><b>17.5.1</b> Survey data</a></li>
<li class="chapter" data-level="17.5.2" data-path="mrp.html"><a href="mrp.html#post-stratification-data"><i class="fa fa-check"></i><b>17.5.2</b> Post-stratification data</a></li>
<li class="chapter" data-level="17.5.3" data-path="mrp.html"><a href="mrp.html#model-3"><i class="fa fa-check"></i><b>17.5.3</b> Model</a></li>
<li class="chapter" data-level="17.5.4" data-path="mrp.html"><a href="mrp.html#post-stratify-2"><i class="fa fa-check"></i><b>17.5.4</b> Post-stratify</a></li>
</ul></li>
<li class="chapter" data-level="17.6" data-path="mrp.html"><a href="mrp.html#concluding-remarks-and-next-steps"><i class="fa fa-check"></i><b>17.6</b> Concluding remarks and next steps</a></li>
<li class="chapter" data-level="17.7" data-path="mrp.html"><a href="mrp.html#exercises-and-tutorial-16"><i class="fa fa-check"></i><b>17.7</b> Exercises and tutorial</a>
<ul>
<li class="chapter" data-level="17.7.1" data-path="mrp.html"><a href="mrp.html#exercises-16"><i class="fa fa-check"></i><b>17.7.1</b> Exercises</a></li>
<li class="chapter" data-level="17.7.2" data-path="mrp.html"><a href="mrp.html#tutorial-16"><i class="fa fa-check"></i><b>17.7.2</b> Tutorial</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="text-as-data.html"><a href="text-as-data.html"><i class="fa fa-check"></i><b>18</b> Text as data</a>
<ul>
<li class="chapter" data-level="18.1" data-path="text-as-data.html"><a href="text-as-data.html#introduction-26"><i class="fa fa-check"></i><b>18.1</b> Introduction</a></li>
<li class="chapter" data-level="18.2" data-path="text-as-data.html"><a href="text-as-data.html#lasso-regression"><i class="fa fa-check"></i><b>18.2</b> Lasso regression</a></li>
<li class="chapter" data-level="18.3" data-path="text-as-data.html"><a href="text-as-data.html#topic-models"><i class="fa fa-check"></i><b>18.3</b> Topic models</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="text-as-data.html"><a href="text-as-data.html#overview-8"><i class="fa fa-check"></i><b>18.3.1</b> Overview</a></li>
<li class="chapter" data-level="18.3.2" data-path="text-as-data.html"><a href="text-as-data.html#document-generation-process"><i class="fa fa-check"></i><b>18.3.2</b> Document generation process</a></li>
<li class="chapter" data-level="18.3.3" data-path="text-as-data.html"><a href="text-as-data.html#analysis-process"><i class="fa fa-check"></i><b>18.3.3</b> Analysis process</a></li>
<li class="chapter" data-level="18.3.4" data-path="text-as-data.html"><a href="text-as-data.html#warnings-and-extensions"><i class="fa fa-check"></i><b>18.3.4</b> Warnings and extensions</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="text-as-data.html"><a href="text-as-data.html#word-embedding"><i class="fa fa-check"></i><b>18.4</b> Word embedding</a></li>
<li class="chapter" data-level="18.5" data-path="text-as-data.html"><a href="text-as-data.html#conclusion-1"><i class="fa fa-check"></i><b>18.5</b> Conclusion</a></li>
<li class="chapter" data-level="18.6" data-path="text-as-data.html"><a href="text-as-data.html#exercises-and-tutorial-17"><i class="fa fa-check"></i><b>18.6</b> Exercises and tutorial</a>
<ul>
<li class="chapter" data-level="18.6.1" data-path="text-as-data.html"><a href="text-as-data.html#exercises-17"><i class="fa fa-check"></i><b>18.6.1</b> Exercises</a></li>
<li class="chapter" data-level="18.6.2" data-path="text-as-data.html"><a href="text-as-data.html#tutorial-17"><i class="fa fa-check"></i><b>18.6.2</b> Tutorial</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>VI Enrichment</b></span></li>
<li class="chapter" data-level="19" data-path="using-the-cloud.html"><a href="using-the-cloud.html"><i class="fa fa-check"></i><b>19</b> Using the cloud</a>
<ul>
<li class="chapter" data-level="19.1" data-path="using-the-cloud.html"><a href="using-the-cloud.html#introduction-27"><i class="fa fa-check"></i><b>19.1</b> Introduction</a></li>
<li class="chapter" data-level="19.2" data-path="using-the-cloud.html"><a href="using-the-cloud.html#google-colab"><i class="fa fa-check"></i><b>19.2</b> Google Colab</a></li>
<li class="chapter" data-level="19.3" data-path="using-the-cloud.html"><a href="using-the-cloud.html#aws"><i class="fa fa-check"></i><b>19.3</b> AWS</a></li>
<li class="chapter" data-level="19.4" data-path="using-the-cloud.html"><a href="using-the-cloud.html#google-compute-engine"><i class="fa fa-check"></i><b>19.4</b> Google Compute Engine</a></li>
<li class="chapter" data-level="19.5" data-path="using-the-cloud.html"><a href="using-the-cloud.html#azure"><i class="fa fa-check"></i><b>19.5</b> Azure</a></li>
<li class="chapter" data-level="19.6" data-path="using-the-cloud.html"><a href="using-the-cloud.html#exercises-and-tutorial-18"><i class="fa fa-check"></i><b>19.6</b> Exercises and tutorial</a>
<ul>
<li class="chapter" data-level="19.6.1" data-path="using-the-cloud.html"><a href="using-the-cloud.html#exercises-18"><i class="fa fa-check"></i><b>19.6.1</b> Exercises</a></li>
<li class="chapter" data-level="19.6.2" data-path="using-the-cloud.html"><a href="using-the-cloud.html#tutorial-18"><i class="fa fa-check"></i><b>19.6.2</b> Tutorial</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="deploying-models.html"><a href="deploying-models.html"><i class="fa fa-check"></i><b>20</b> Deploying models</a>
<ul>
<li class="chapter" data-level="20.1" data-path="deploying-models.html"><a href="deploying-models.html#introduction-28"><i class="fa fa-check"></i><b>20.1</b> Introduction</a></li>
<li class="chapter" data-level="20.2" data-path="deploying-models.html"><a href="deploying-models.html#packages"><i class="fa fa-check"></i><b>20.2</b> Packages</a></li>
<li class="chapter" data-level="20.3" data-path="deploying-models.html"><a href="deploying-models.html#shiny-1"><i class="fa fa-check"></i><b>20.3</b> Shiny</a></li>
<li class="chapter" data-level="20.4" data-path="deploying-models.html"><a href="deploying-models.html#plumber-and-model-apis"><i class="fa fa-check"></i><b>20.4</b> Plumber and model APIs</a>
<ul>
<li class="chapter" data-level="20.4.1" data-path="deploying-models.html"><a href="deploying-models.html#hello-toronto"><i class="fa fa-check"></i><b>20.4.1</b> Hello Toronto</a></li>
<li class="chapter" data-level="20.4.2" data-path="deploying-models.html"><a href="deploying-models.html#local-model"><i class="fa fa-check"></i><b>20.4.2</b> Local model</a></li>
<li class="chapter" data-level="20.4.3" data-path="deploying-models.html"><a href="deploying-models.html#cloud-model"><i class="fa fa-check"></i><b>20.4.3</b> Cloud model</a></li>
</ul></li>
<li class="chapter" data-level="20.5" data-path="deploying-models.html"><a href="deploying-models.html#exercises-and-tutorial-19"><i class="fa fa-check"></i><b>20.5</b> Exercises and tutorial</a>
<ul>
<li class="chapter" data-level="20.5.1" data-path="deploying-models.html"><a href="deploying-models.html#exercises-19"><i class="fa fa-check"></i><b>20.5.1</b> Exercises</a></li>
<li class="chapter" data-level="20.5.2" data-path="deploying-models.html"><a href="deploying-models.html#tutorial-19"><i class="fa fa-check"></i><b>20.5.2</b> Tutorial</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="21" data-path="efficiency.html"><a href="efficiency.html"><i class="fa fa-check"></i><b>21</b> Efficiency</a>
<ul>
<li class="chapter" data-level="21.1" data-path="efficiency.html"><a href="efficiency.html#introduction-29"><i class="fa fa-check"></i><b>21.1</b> Introduction</a></li>
<li class="chapter" data-level="21.2" data-path="efficiency.html"><a href="efficiency.html#data-efficiency"><i class="fa fa-check"></i><b>21.2</b> Data efficiency</a>
<ul>
<li class="chapter" data-level="21.2.1" data-path="efficiency.html"><a href="efficiency.html#sql"><i class="fa fa-check"></i><b>21.2.1</b> SQL</a></li>
<li class="chapter" data-level="21.2.2" data-path="efficiency.html"><a href="efficiency.html#feather"><i class="fa fa-check"></i><b>21.2.2</b> Feather</a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="efficiency.html"><a href="efficiency.html#code-efficiency"><i class="fa fa-check"></i><b>21.3</b> Code efficiency</a></li>
<li class="chapter" data-level="21.4" data-path="efficiency.html"><a href="efficiency.html#code-refactoring"><i class="fa fa-check"></i><b>21.4</b> Code refactoring</a>
<ul>
<li class="chapter" data-level="21.4.1" data-path="efficiency.html"><a href="efficiency.html#measure"><i class="fa fa-check"></i><b>21.4.1</b> Measure</a></li>
</ul></li>
<li class="chapter" data-level="21.5" data-path="efficiency.html"><a href="efficiency.html#experimental-efficiency"><i class="fa fa-check"></i><b>21.5</b> Experimental efficiency</a></li>
<li class="chapter" data-level="21.6" data-path="efficiency.html"><a href="efficiency.html#other-languages"><i class="fa fa-check"></i><b>21.6</b> Other languages</a>
<ul>
<li class="chapter" data-level="21.6.1" data-path="efficiency.html"><a href="efficiency.html#python"><i class="fa fa-check"></i><b>21.6.1</b> Python</a></li>
<li class="chapter" data-level="21.6.2" data-path="efficiency.html"><a href="efficiency.html#julia"><i class="fa fa-check"></i><b>21.6.2</b> Julia</a></li>
</ul></li>
<li class="chapter" data-level="21.7" data-path="efficiency.html"><a href="efficiency.html#exercises-and-tutorial-20"><i class="fa fa-check"></i><b>21.7</b> Exercises and tutorial</a>
<ul>
<li class="chapter" data-level="21.7.1" data-path="efficiency.html"><a href="efficiency.html#exercises-20"><i class="fa fa-check"></i><b>21.7.1</b> Exercises</a></li>
<li class="chapter" data-level="21.7.2" data-path="efficiency.html"><a href="efficiency.html#tutorial-20"><i class="fa fa-check"></i><b>21.7.2</b> Tutorial</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="22" data-path="concludingremarks.html"><a href="concludingremarks.html"><i class="fa fa-check"></i><b>22</b> Concluding remarks, next steps, and open problems</a>
<ul>
<li class="chapter" data-level="22.1" data-path="concludingremarks.html"><a href="concludingremarks.html#concluding-remarks"><i class="fa fa-check"></i><b>22.1</b> Concluding remarks</a></li>
<li class="chapter" data-level="22.2" data-path="concludingremarks.html"><a href="concludingremarks.html#next-steps-2"><i class="fa fa-check"></i><b>22.2</b> Next steps</a></li>
<li class="chapter" data-level="22.3" data-path="concludingremarks.html"><a href="concludingremarks.html#open-problems"><i class="fa fa-check"></i><b>22.3</b> Open problems</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="oh-you-think-we-have-good-data-on-that.html"><a href="oh-you-think-we-have-good-data-on-that.html"><i class="fa fa-check"></i><b>A</b> Oh, you think we have good data on that!</a></li>
<li class="chapter" data-level="B" data-path="shoulders-of-giants.html"><a href="shoulders-of-giants.html"><i class="fa fa-check"></i><b>B</b> Shoulders of giants</a></li>
<li class="part"><span><b>VII Assessment</b></span></li>
<li class="chapter" data-level="C" data-path="papers.html"><a href="papers.html"><i class="fa fa-check"></i><b>C</b> Papers</a>
<ul>
<li class="chapter" data-level="C.1" data-path="papers.html"><a href="papers.html#mandatory-minimums"><i class="fa fa-check"></i><b>C.1</b> ‘Mandatory Minimums’</a>
<ul>
<li class="chapter" data-level="C.1.1" data-path="papers.html"><a href="papers.html#task"><i class="fa fa-check"></i><b>C.1.1</b> Task</a></li>
<li class="chapter" data-level="C.1.2" data-path="papers.html"><a href="papers.html#guidance"><i class="fa fa-check"></i><b>C.1.2</b> Guidance</a></li>
<li class="chapter" data-level="C.1.3" data-path="papers.html"><a href="papers.html#check-offs-points"><i class="fa fa-check"></i><b>C.1.3</b> Check offs points</a></li>
<li class="chapter" data-level="C.1.4" data-path="papers.html"><a href="papers.html#faq"><i class="fa fa-check"></i><b>C.1.4</b> FAQ</a></li>
<li class="chapter" data-level="C.1.5" data-path="papers.html"><a href="papers.html#rubric"><i class="fa fa-check"></i><b>C.1.5</b> Rubric</a></li>
<li class="chapter" data-level="C.1.6" data-path="papers.html"><a href="papers.html#previous-examples"><i class="fa fa-check"></i><b>C.1.6</b> Previous examples</a></li>
</ul></li>
<li class="chapter" data-level="C.2" data-path="papers.html"><a href="papers.html#these-numbers-mean-dial-it-up"><i class="fa fa-check"></i><b>C.2</b> ‘These numbers mean dial it up’</a>
<ul>
<li class="chapter" data-level="C.2.1" data-path="papers.html"><a href="papers.html#task-1"><i class="fa fa-check"></i><b>C.2.1</b> Task</a></li>
<li class="chapter" data-level="C.2.2" data-path="papers.html"><a href="papers.html#guidance-1"><i class="fa fa-check"></i><b>C.2.2</b> Guidance</a></li>
<li class="chapter" data-level="C.2.3" data-path="papers.html"><a href="papers.html#check-offs-points-1"><i class="fa fa-check"></i><b>C.2.3</b> Check offs points</a></li>
<li class="chapter" data-level="C.2.4" data-path="papers.html"><a href="papers.html#faq-1"><i class="fa fa-check"></i><b>C.2.4</b> FAQ</a></li>
<li class="chapter" data-level="C.2.5" data-path="papers.html"><a href="papers.html#rubric-1"><i class="fa fa-check"></i><b>C.2.5</b> Rubric</a></li>
</ul></li>
<li class="chapter" data-level="C.3" data-path="papers.html"><a href="papers.html#the-short-list"><i class="fa fa-check"></i><b>C.3</b> ‘The Short List’</a>
<ul>
<li class="chapter" data-level="C.3.1" data-path="papers.html"><a href="papers.html#task-2"><i class="fa fa-check"></i><b>C.3.1</b> Task</a></li>
<li class="chapter" data-level="C.3.2" data-path="papers.html"><a href="papers.html#guidance-2"><i class="fa fa-check"></i><b>C.3.2</b> Guidance</a></li>
<li class="chapter" data-level="C.3.3" data-path="papers.html"><a href="papers.html#check-offs-points-2"><i class="fa fa-check"></i><b>C.3.3</b> Check offs points</a></li>
<li class="chapter" data-level="C.3.4" data-path="papers.html"><a href="papers.html#faq-2"><i class="fa fa-check"></i><b>C.3.4</b> FAQ</a></li>
<li class="chapter" data-level="C.3.5" data-path="papers.html"><a href="papers.html#rubric-2"><i class="fa fa-check"></i><b>C.3.5</b> Rubric</a></li>
</ul></li>
<li class="chapter" data-level="C.4" data-path="papers.html"><a href="papers.html#two-cathedrals"><i class="fa fa-check"></i><b>C.4</b> ‘Two Cathedrals’</a>
<ul>
<li class="chapter" data-level="C.4.1" data-path="papers.html"><a href="papers.html#task-3"><i class="fa fa-check"></i><b>C.4.1</b> Task</a></li>
<li class="chapter" data-level="C.4.2" data-path="papers.html"><a href="papers.html#guidance-3"><i class="fa fa-check"></i><b>C.4.2</b> Guidance</a></li>
<li class="chapter" data-level="C.4.3" data-path="papers.html"><a href="papers.html#peer-review-submission"><i class="fa fa-check"></i><b>C.4.3</b> Peer review submission</a></li>
<li class="chapter" data-level="C.4.4" data-path="papers.html"><a href="papers.html#conduct-peer-review"><i class="fa fa-check"></i><b>C.4.4</b> Conduct peer-review</a></li>
<li class="chapter" data-level="C.4.5" data-path="papers.html"><a href="papers.html#check-offs-points-3"><i class="fa fa-check"></i><b>C.4.5</b> Check offs points</a></li>
<li class="chapter" data-level="C.4.6" data-path="papers.html"><a href="papers.html#faq-3"><i class="fa fa-check"></i><b>C.4.6</b> FAQ</a></li>
<li class="chapter" data-level="C.4.7" data-path="papers.html"><a href="papers.html#rubric-3"><i class="fa fa-check"></i><b>C.4.7</b> Rubric</a></li>
<li class="chapter" data-level="C.4.8" data-path="papers.html"><a href="papers.html#previous-examples-1"><i class="fa fa-check"></i><b>C.4.8</b> Previous examples</a></li>
</ul></li>
<li class="chapter" data-level="C.5" data-path="papers.html"><a href="papers.html#a-proportional-response"><i class="fa fa-check"></i><b>C.5</b> ‘A Proportional Response’</a>
<ul>
<li class="chapter" data-level="C.5.1" data-path="papers.html"><a href="papers.html#task-4"><i class="fa fa-check"></i><b>C.5.1</b> Task</a></li>
<li class="chapter" data-level="C.5.2" data-path="papers.html"><a href="papers.html#recommended-steps"><i class="fa fa-check"></i><b>C.5.2</b> Recommended steps</a></li>
<li class="chapter" data-level="C.5.3" data-path="papers.html"><a href="papers.html#check-offs-points-4"><i class="fa fa-check"></i><b>C.5.3</b> Check offs points</a></li>
<li class="chapter" data-level="C.5.4" data-path="papers.html"><a href="papers.html#faq-4"><i class="fa fa-check"></i><b>C.5.4</b> FAQ</a></li>
</ul></li>
<li class="chapter" data-level="C.6" data-path="papers.html"><a href="papers.html#mr-willis-of-ohio"><i class="fa fa-check"></i><b>C.6</b> ‘Mr Willis of Ohio’</a>
<ul>
<li class="chapter" data-level="C.6.1" data-path="papers.html"><a href="papers.html#task-5"><i class="fa fa-check"></i><b>C.6.1</b> Task</a></li>
<li class="chapter" data-level="C.6.2" data-path="papers.html"><a href="papers.html#recommended-steps-1"><i class="fa fa-check"></i><b>C.6.2</b> Recommended steps</a></li>
<li class="chapter" data-level="C.6.3" data-path="papers.html"><a href="papers.html#check-offs-points-5"><i class="fa fa-check"></i><b>C.6.3</b> Check offs points</a></li>
<li class="chapter" data-level="C.6.4" data-path="papers.html"><a href="papers.html#faq-5"><i class="fa fa-check"></i><b>C.6.4</b> FAQ</a></li>
</ul></li>
<li class="chapter" data-level="C.7" data-path="papers.html"><a href="papers.html#five-votes-down"><i class="fa fa-check"></i><b>C.7</b> ‘Five Votes Down’</a>
<ul>
<li class="chapter" data-level="C.7.1" data-path="papers.html"><a href="papers.html#task-6"><i class="fa fa-check"></i><b>C.7.1</b> Task</a></li>
<li class="chapter" data-level="C.7.2" data-path="papers.html"><a href="papers.html#recommended-steps-2"><i class="fa fa-check"></i><b>C.7.2</b> Recommended steps</a></li>
<li class="chapter" data-level="C.7.3" data-path="papers.html"><a href="papers.html#check-offs-points-6"><i class="fa fa-check"></i><b>C.7.3</b> Check offs points</a></li>
<li class="chapter" data-level="C.7.4" data-path="papers.html"><a href="papers.html#faq-6"><i class="fa fa-check"></i><b>C.7.4</b> FAQ</a></li>
</ul></li>
<li class="chapter" data-level="C.8" data-path="papers.html"><a href="papers.html#whats-next"><i class="fa fa-check"></i><b>C.8</b> ‘What’s next?’</a>
<ul>
<li class="chapter" data-level="C.8.1" data-path="papers.html"><a href="papers.html#task-7"><i class="fa fa-check"></i><b>C.8.1</b> Task</a></li>
<li class="chapter" data-level="C.8.2" data-path="papers.html"><a href="papers.html#recommended-steps-3"><i class="fa fa-check"></i><b>C.8.2</b> Recommended steps</a></li>
<li class="chapter" data-level="C.8.3" data-path="papers.html"><a href="papers.html#check-offs-points-7"><i class="fa fa-check"></i><b>C.8.3</b> Check offs points</a></li>
<li class="chapter" data-level="C.8.4" data-path="papers.html"><a href="papers.html#faq-7"><i class="fa fa-check"></i><b>C.8.4</b> FAQ</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references-1.html"><a href="references-1.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Telling Stories With Data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="cleaning-and-preparing-data" class="section level1" number="11">
<h1><span class="header-section-number">Chapter 11</span> Cleaning and preparing data</h1>
<p><strong>Required reading</strong></p>
<ul>
<li><em>Data Feminism</em>, Chapter 5 <span class="citation">(<a href="#ref-datafeminism2020" role="doc-biblioref">D’Ignazio and Klein 2020</a>)</span>.</li>
<li><em>R for Data Science</em>, Chapter 9 <span class="citation">(<a href="#ref-r4ds" role="doc-biblioref">Wickham and Grolemund 2017</a>)</span>.</li>
</ul>
<p><strong>Recommended reading</strong></p>
<ul>
<li><em>We Gave Four Good Pollsters the Same Raw Data. They Had Four Different Results</em>, <span class="citation">(<a href="#ref-cohn2016" role="doc-biblioref">N. Cohn 2016</a>)</span>.</li>
<li><em>Data Cleaning Procedures for the 1993 Robert Wood Johnson Foundation Employer Health Insurance Survey</em>, <span class="citation">(<a href="#ref-euller1997data" role="doc-biblioref">Euller, Long, and Marquis 1997</a>)</span>.</li>
<li><em>Data Cleaning</em>, <span class="citation">(<a href="#ref-ilyas2019data" role="doc-biblioref">Ilyas and Chu 2019</a>)</span>.</li>
</ul>
<p><strong>Key concepts/skills/etc</strong></p>
<ul>
<li>Planning an end-point, and simulating the data that you’d like, are key elements of cleaning and preparing data.</li>
<li>Begin on a small sample of the dataset, write code to fix that, and then iterate and generalize to additional tranches.</li>
<li>Develop a series of tests and checks that your final dataset should pass so that the features of the dataset are clear.</li>
<li>Be especially concerned about the class of variables, having clear names, and that the values of each variable are as expected given all this.</li>
</ul>
<p><strong>Key libraries</strong></p>
<ul>
<li><code>janitor</code> <span class="citation">(<a href="#ref-janitor" role="doc-biblioref">Firke 2020</a>)</span></li>
<li><code>stringr</code> <span class="citation">(<a href="#ref-citestringr" role="doc-biblioref">Wickham 2019e</a>)</span></li>
<li><code>tidyr</code> <span class="citation">(<a href="#ref-citetidyr" role="doc-biblioref">Wickham 2021</a>)</span></li>
</ul>
<p><strong>Key functions/etc</strong></p>
<ul>
<li><code>dplyr::count()</code></li>
<li><code>dplyr::mutate()</code></li>
<li><code>dplyr::select()</code></li>
<li><code>janitor::clean_names()</code></li>
<li><code>stringr::str_replace_all()</code></li>
<li><code>stringr::str_trim()</code></li>
<li><code>tidyr::pivot_longer()</code></li>
<li><code>tidyr::separate()</code></li>
<li><code>tidyr::separate_rows()</code></li>
</ul>
<!-- Beaumont, Jean-François, 2020, 'Are probability surveys bound to disappear for the production of official statistics?' -->
<!-- Gelman, Andrew, 2019, 'Model Building and expansion for golf putting' -->
<!-- Hanretty, Chris, 2019, 'An introduction to multilevel regression and post-stratification for estimating constituency opinion' -->
<!-- Hillygus, D. Sunshine, 2011, 'The evolution of election polling in the United States' -->
<!-- Kennedy, Lauren, and Andrew Gelman, 2019, 'Know your population and know your model: Using model-based regression and poststratification to generalize findings beyond the observed sample' -->
<!-- Kennedy, Lauren, Katharine Khanna, Dan Simpson, and Andrew Gelman, 2020 'Using sex and gender in survey adjustment'. -->
<!-- Nelder, John A., 1999, 'From Statistics to Statistical Science' -->
<div id="introduction-15" class="section level2" number="11.1">
<h2><span class="header-section-number">11.1</span> Introduction</h2>
<blockquote>
<p>“Well, Lyndon, you may be right and they may be every bit as intelligent as you say,” said Rayburn, “but I’d feel a whole lot better about them if just one of them had run for sheriff once.”</p>
<p>Sam Rayburn’s reaction to Lyndon Johnson’s enthusiasm about Kennedy’s incoming cabinet, as quoted by <span class="citation"><a href="#ref-halberstam" role="doc-biblioref">Halberstam</a> (<a href="#ref-halberstam" role="doc-biblioref">1972, 41</a>)</span>.</p>
</blockquote>
<p>In earlier chapters we have done data cleaning and preparation, but in this chapter, we get into the weeds. I do not trust anyone who works with data who has not spent time, at some point in their career, cleaning data. And by the end of this chapter I think that you’ll feel the same way. To clean and prepare data is to make a lot of different decisions, many of which are important.</p>
<p>For a long time, data cleaning and preparation was largely overlooked. We now realise that was a mistake. It is no longer possible to trust almost any result in disciplines that apply statistics. The reproducibility crisis, which started in psychology but has now extended to many other fields in the physical and social sciences, has brought to light issues such as p-value ‘hacking,’ researcher degrees of freedom, file-drawer issues, and even data and results fabrication <span class="citation">(<a href="#ref-gelman2013garden" role="doc-biblioref">Gelman and Loken 2013</a>)</span>. Steps are now being put in place to address these. However, there has been relatively little focus on the data gathering, cleaning, and preparation aspects of applied statistics, despite evidence that decisions made during these steps greatly affect statistical results <span class="citation">(<a href="#ref-huntington2020influence" role="doc-biblioref">Huntington-Klein et al. 2020</a>)</span>. In this chapter we focus on these issues.</p>
<p>While the statistical practices that underpin data science are themselves correct and robust when applied to ‘fake’ datasets created in a simulated environment, data science is typically not conducted with these types of datasets. For instance, data scientists are interested in:</p>
<blockquote>
<p>…the kind of messy, unfiltered, and possibly unclean data—tainted by heteroskedasticity, complex dependence and missingness patterns—that until recently were avoided in polite conversations between more traditional statisticians…</p>
<p><span class="citation">(<a href="#ref-craiu2019hiring" role="doc-biblioref">Craiu 2019</a>)</span>.</p>
</blockquote>
<p>Big data does not resolve this issue, and may even exacerbate it, for instance ‘without taking data quality into account, population inferences with Big Data are subject to a Big Data Paradox: the more the data, the surer we fool ourselves’ <span class="citation">(<a href="#ref-meng2018statistical" role="doc-biblioref">Meng 2018</a>)</span>. It is important to note that the issues that are found in much applied statistics research are not necessarily associated with researcher quality, or their biases <span class="citation">(<a href="#ref-silberzahn2018many" role="doc-biblioref">Silberzahn et al. 2018</a>)</span>. Instead, they are a result of the environment within which data science is conducted. This chapter aims to give you the tools to explicitly think about this work.</p>
<p><span class="citation"><a href="#ref-gelman2020most" role="doc-biblioref">Gelman and Vehtari</a> (<a href="#ref-gelman2020most" role="doc-biblioref">2020</a>)</span> writing about the most important statistical ideas of the past 50 years say that:</p>
<blockquote>
<p>…each of them was not so much a method for solving an existing problem, as an opening to new ways of thinking about statistics and new ways of data analysis. To put it another way, each of these ideas was a codification, bringing inside the tent an approach that had been considered more a matter of taste or philosophy than statistics.</p>
</blockquote>
<p>I see the focus on data cleaning and preparation in this chapter as analogous, insofar, as it represents a codification, or bringing inside the tent, of aspects that are typically (incorrectly) considered those of taste rather than statistics.</p>
<p>The approach that I recommend that you follow is:</p>
<ol style="list-style-type: decimal">
<li>Duplicate.</li>
<li>Plan the end state.</li>
<li>Execute that plan on a tiny sample.</li>
<li>Write tests and documentation.</li>
<li>Iterate the plan.</li>
<li>Generalize the execution.</li>
<li>Update tests and documentation.</li>
</ol>
<p>You will need to use all your skills to this point to be effective, but this is the very stuff of statistical sciences! Be dogged, but sensible. The best is the enemy of the good here. It’s better to have 90 per cent of the data cleaned and prepared, and to start exploring that, before deciding whether it’s worth the effort to clean and prepare the remaining 10 per cent because that remainder will likely take an awful lot of time and effort.</p>
<p>As <span class="citation"><a href="#ref-van2005data" role="doc-biblioref">Van den Broeck et al.</a> (<a href="#ref-van2005data" role="doc-biblioref">2005</a>)</span> say, all data regardless of whether they were obtained from hunting, gathering, or farming, will have issues and it is critical that you understand how to ‘deal with errors from various sources’ and understand ‘their effects on study results.’ To clean data is to analyze data. As <span class="citation"><a href="#ref-thatrandyauperson" role="doc-biblioref">Au</a> (<a href="#ref-thatrandyauperson" role="doc-biblioref">2020</a>)</span> says ‘The act of cleaning data is the act of preferentially transforming data so that your chosen analysis algorithm produces interpretable results. That is also the act of data analysis.’</p>
</div>
<div id="workflow-1" class="section level2" number="11.2">
<h2><span class="header-section-number">11.2</span> Workflow</h2>
<div id="save-a-copy-of-the-raw-data" class="section level3" number="11.2.1">
<h3><span class="header-section-number">11.2.1</span> Save a copy of the raw data</h3>
<p>The first step is to save the raw data into a separate folder location. It is critical that you save the raw data to the extent that is possible <span class="citation">(<a href="#ref-wilsongoodenough" role="doc-biblioref">J. A. C. Wilson Greg AND Bryan 2017</a>)</span>. In an ideal situation, duplicate the folder that contains the raw data, and then rename the duplicated folder ‘cleaned’ and then only ever modify the data in that cleaned folder.</p>
</div>
<div id="begin-with-an-end-in-mind-1" class="section level3" number="11.2.2">
<h3><span class="header-section-number">11.2.2</span> Begin with an end in mind</h3>
<p>Planning the end state, or forcing yourself to begin with an end in mind is important for a variety of reasons. As with scraping data, it helps us to be pre-active about scope-creep, but with data cleaning I see a bigger benefit being that it forces us to really think about what we want the final dataset to look like. As before, I recommend first sketching the dataset. The key features of your sketch will be aspects such as the names of the columns, their class, and the possible range of values. It might look something like Figure <a href="cleaning-and-preparing-data.html#fig:sketchdataplan">11.1</a> .</p>
<div class="figure"><span style="display:block;" id="fig:sketchdataplan"></span>
<img src="figures/sketchofdataset.png" alt="Example of a dataset end plan" width="90%" />
<p class="caption">
FIGURE 11.1: Example of a dataset end plan
</p>
</div>
<p>Notice that this process has made it clear that we want the full names of the states, rather than abbreviations. And that population should be in millions, rather than some other units. The process of sketching out an end-point forces us to make decisions and be clear about our desired end state.</p>
<p>We then implement that using code to simulate data. Again, this process forces us to think about what reasonable values look like in our dataset because we are literally forced to decide which functions to use. Thinking carefully about the membership of each column here, for instance if the column is meant to be ‘gender’ then values such as ‘male,’ ‘female,’ ‘other,’ and ‘unknown’ may be expected, but a number such as ‘1,000’ would likely be unexpected. It also forces us to be explicit about variable names because we have to assign the outputs of those functions to a variable.</p>
<p>Building on the example above, perhaps it might look something like this.</p>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="cleaning-and-preparing-data.html#cb413-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb413-2"><a href="cleaning-and-preparing-data.html#cb413-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb413-3"><a href="cleaning-and-preparing-data.html#cb413-3" aria-hidden="true" tabindex="-1"></a>simulated_states_population <span class="ot">&lt;-</span> </span>
<span id="cb413-4"><a href="cleaning-and-preparing-data.html#cb413-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb413-5"><a href="cleaning-and-preparing-data.html#cb413-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">state =</span> <span class="fu">c</span>(<span class="st">&#39;Alabama&#39;</span>, <span class="st">&#39;Alaska&#39;</span>, <span class="st">&#39;Arizona&#39;</span>, <span class="st">&#39;Arkansas&#39;</span>, <span class="st">&#39;California&#39;</span>),</span>
<span id="cb413-6"><a href="cleaning-and-preparing-data.html#cb413-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">population =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="fl">0.7</span>, <span class="dv">7</span>, <span class="dv">3</span>, <span class="dv">40</span>)</span>
<span id="cb413-7"><a href="cleaning-and-preparing-data.html#cb413-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb413-8"><a href="cleaning-and-preparing-data.html#cb413-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb413-9"><a href="cleaning-and-preparing-data.html#cb413-9" aria-hidden="true" tabindex="-1"></a>simulated_states_population</span></code></pre></div>
<pre><code>## # A tibble: 5 × 2
##   state      population
##   &lt;chr&gt;           &lt;dbl&gt;
## 1 Alabama           5  
## 2 Alaska            0.7
## 3 Arizona           7  
## 4 Arkansas          3  
## 5 California       40</code></pre>
<p>Our purpose, during data cleaning and preparation is to then bring our dataset close to that plan.</p>
<p>The desired end-state will typically be ‘tidy data’ where <span class="citation">(<a href="#ref-wickham2014tidy" role="doc-biblioref">Wickham 2014, 4</a>)</span>:</p>
<ol style="list-style-type: decimal">
<li>Each variable is a column</li>
<li>Each observation is a row</li>
<li>Each observational unit is a table.</li>
</ol>
<p>The following is an example of data in a tidy format:</p>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb415-1"><a href="cleaning-and-preparing-data.html#cb415-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb415-2"><a href="cleaning-and-preparing-data.html#cb415-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;Alfred&quot;</span>, <span class="st">&quot;Ben&quot;</span>, <span class="st">&quot;Chris&quot;</span>, <span class="st">&quot;Daniela&quot;</span>, <span class="st">&quot;Emma&quot;</span>),</span>
<span id="cb415-3"><a href="cleaning-and-preparing-data.html#cb415-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">age_group =</span> <span class="fu">c</span>(<span class="st">&quot;0-9&quot;</span>, <span class="st">&quot;10-19&quot;</span>, <span class="st">&quot;0-9&quot;</span>, <span class="st">&quot;0-9&quot;</span>, <span class="st">&quot;10-19&quot;</span>),</span>
<span id="cb415-4"><a href="cleaning-and-preparing-data.html#cb415-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">response_time =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">9</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">8</span>),</span>
<span id="cb415-5"><a href="cleaning-and-preparing-data.html#cb415-5" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 5 × 3
##   name    age_group response_time
##   &lt;chr&gt;   &lt;chr&gt;             &lt;dbl&gt;
## 1 Alfred  0-9                   0
## 2 Ben     10-19                 9
## 3 Chris   0-9                   3
## 4 Daniela 0-9                   3
## 5 Emma    10-19                 8</code></pre>
</div>
<div id="start-small" class="section level3" number="11.2.3">
<h3><span class="header-section-number">11.2.3</span> Start small</h3>
<p>At this point, we then have our first look at the data that we are dealing with. Regardless of what the raw data look like we want to try to get it into a rectangular dataset as quickly as possible because then we can use our familiar verbs. Let’s assume here that we’re starting with some <code>.txt</code> file.</p>
<p>The first step is to look for regularities in the dataset. We are wanting to end up with tabular data, which means that we need some type of deliminator to distinguish different columns. Ideally this might be features such as a comma, a semicolon, a tab, a double space, or a line break.</p>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb417-1"><a href="cleaning-and-preparing-data.html#cb417-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Alabama, 5 million.</span></span>
<span id="cb417-2"><a href="cleaning-and-preparing-data.html#cb417-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Alaska, 0.7 million.</span></span>
<span id="cb417-3"><a href="cleaning-and-preparing-data.html#cb417-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Arizona, 7 million.</span></span>
<span id="cb417-4"><a href="cleaning-and-preparing-data.html#cb417-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Arkansas, 3 million.</span></span>
<span id="cb417-5"><a href="cleaning-and-preparing-data.html#cb417-5" aria-hidden="true" tabindex="-1"></a><span class="co"># California, 40 million.</span></span></code></pre></div>
<p>In worse cases there may be a feature of the dataset that we can take advantage of. For instance, possibly the data look like the following:</p>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="cleaning-and-preparing-data.html#cb418-1" aria-hidden="true" tabindex="-1"></a><span class="co"># State is Alabama and population is 5 million.</span></span>
<span id="cb418-2"><a href="cleaning-and-preparing-data.html#cb418-2" aria-hidden="true" tabindex="-1"></a><span class="co"># State is Alaska and population is 0.7 million.</span></span>
<span id="cb418-3"><a href="cleaning-and-preparing-data.html#cb418-3" aria-hidden="true" tabindex="-1"></a><span class="co"># State is Arizona and population is 7 million.</span></span>
<span id="cb418-4"><a href="cleaning-and-preparing-data.html#cb418-4" aria-hidden="true" tabindex="-1"></a><span class="co"># State is Arkansas and population is 3 million.</span></span>
<span id="cb418-5"><a href="cleaning-and-preparing-data.html#cb418-5" aria-hidden="true" tabindex="-1"></a><span class="co"># State is California and population is 40 million.</span></span></code></pre></div>
<p>In this case, although we don’t have a traditional deliminator we can use the regularity of ‘State is’ and ’ and population is ’ to get what we need.</p>
<p>A more difficult case is this following:</p>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb419-1"><a href="cleaning-and-preparing-data.html#cb419-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Alabama 5 Alaska 0.7 Arizona 7 Arkansas 3 California 40</span></span></code></pre></div>
<p>One way to approach this is to take advantage of the different classes and values that we’re looking for. For instance, in this case, we know that we’re after US states, so there are only 50 possible options and we could use the existence of these as a deliminator. We could also use the fact that population is a number here, and so split based on a space followed by a number.</p>
<p>To move forward, I’ll assume that last example and move it into a rectangular dataset.</p>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb420-1"><a href="cleaning-and-preparing-data.html#cb420-1" aria-hidden="true" tabindex="-1"></a>raw_data <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;Alabama 5 Alaska 0.7 Arizona 7 Arkansas 3 California 40&#39;</span>)</span>
<span id="cb420-2"><a href="cleaning-and-preparing-data.html#cb420-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb420-3"><a href="cleaning-and-preparing-data.html#cb420-3" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> </span>
<span id="cb420-4"><a href="cleaning-and-preparing-data.html#cb420-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">raw =</span> raw_data)</span>
<span id="cb420-5"><a href="cleaning-and-preparing-data.html#cb420-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb420-6"><a href="cleaning-and-preparing-data.html#cb420-6" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> </span>
<span id="cb420-7"><a href="cleaning-and-preparing-data.html#cb420-7" aria-hidden="true" tabindex="-1"></a>  data <span class="sc">%&gt;%</span> </span>
<span id="cb420-8"><a href="cleaning-and-preparing-data.html#cb420-8" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">separate</span>(<span class="at">col =</span> raw, </span>
<span id="cb420-9"><a href="cleaning-and-preparing-data.html#cb420-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">into =</span> letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>],</span>
<span id="cb420-10"><a href="cleaning-and-preparing-data.html#cb420-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sep =</span> <span class="st">&quot;(?&lt;=[[:digit:]]) &quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb420-11"><a href="cleaning-and-preparing-data.html#cb420-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>],</span>
<span id="cb420-12"><a href="cleaning-and-preparing-data.html#cb420-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;drop_me&quot;</span>,</span>
<span id="cb420-13"><a href="cleaning-and-preparing-data.html#cb420-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;separate_me&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb420-14"><a href="cleaning-and-preparing-data.html#cb420-14" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">separate</span>(<span class="at">col =</span> separate_me, </span>
<span id="cb420-15"><a href="cleaning-and-preparing-data.html#cb420-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&#39;state&#39;</span>, <span class="st">&#39;population&#39;</span>),</span>
<span id="cb420-16"><a href="cleaning-and-preparing-data.html#cb420-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sep =</span> <span class="st">&quot; (?=[[:digit:]])&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb420-17"><a href="cleaning-and-preparing-data.html#cb420-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>drop_me)</span>
<span id="cb420-18"><a href="cleaning-and-preparing-data.html#cb420-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb420-19"><a href="cleaning-and-preparing-data.html#cb420-19" aria-hidden="true" tabindex="-1"></a>data</span></code></pre></div>
<pre><code>## # A tibble: 5 × 2
##   state      population
##   &lt;chr&gt;      &lt;chr&gt;     
## 1 Alabama    5         
## 2 Alaska     0.7       
## 3 Arizona    7         
## 4 Arkansas   3         
## 5 California 40</code></pre>
</div>
<div id="write-tests-and-documentation." class="section level3" number="11.2.4">
<h3><span class="header-section-number">11.2.4</span> Write tests and documentation.</h3>
<p>Having established a rectangular dataset, albeit a messy one, we should begin to look at the classes that we have. We don’t necessarily want to fix the classes at this point, because that can result in us losing data. But we look at the class to see what it is, and then compare it to our simulated dataset to see where it needs to get to. We note the columns where it is different.</p>
<p>Before changing the class and before going onto more bespoke issues, you should deal with some of the common issues in each class. Some common issues are:</p>
<ul>
<li>Commas and other punctuation, such as denomination signs in columns that should be numeric.</li>
<li>Inconsistent formatting of dates, such as ‘December’ and also ‘Dec’ and ‘12.’</li>
<li>Unexpected characters, especially in unicode, which may not display consistently.</li>
</ul>
<p>Typically, we want to fix anything immediately obvious. For instance, remove commas that have been used to group digits in currencies. However, the situation will typically quickly become dire. What we need to do is to look at the membership of each group, and then triage what we will fix. We should probably make the decision of how to triage based on what is likely to have the largest impact. That usually means starting with the counts, sorting in descending order, and then dealing with each as they come.</p>
<p>When the tests of membership are passed, then finally change the class, and run all the tests again. We’re adapting this idea from the software development approach of unit testing. Tests are crucial because the enable us to understand whether software (or in this case data) is fit for purpose <span class="citation">(<a href="#ref-buildingsoftwaretogether" role="doc-biblioref">G. Wilson 2021</a>)</span>, Chapter ‘Testing.’</p>
<p>Let’s run through an example with a collection of strings, some of which are slightly wrong. This type of output is typical of OCR, which often gets most of the way there, but not quite.</p>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb422-1"><a href="cleaning-and-preparing-data.html#cb422-1" aria-hidden="true" tabindex="-1"></a>messy_string <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;Rohan, Rhan, ROhan, Roham, ROhan, Rohan, Rohan, R0han, Rohan , 5Ohan&#39;</span>)</span>
<span id="cb422-2"><a href="cleaning-and-preparing-data.html#cb422-2" aria-hidden="true" tabindex="-1"></a>messy_string</span></code></pre></div>
<pre><code>## [1] &quot;Rohan, Rhan, ROhan, Roham, ROhan, Rohan, Rohan, R0han, Rohan , 5Ohan&quot;</code></pre>
<p>As before, we first want to get this into a rectangular dataset.</p>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb424-1"><a href="cleaning-and-preparing-data.html#cb424-1" aria-hidden="true" tabindex="-1"></a>my_data <span class="ot">&lt;-</span> </span>
<span id="cb424-2"><a href="cleaning-and-preparing-data.html#cb424-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">names =</span> messy_string) <span class="sc">%&gt;%</span> </span>
<span id="cb424-3"><a href="cleaning-and-preparing-data.html#cb424-3" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">separate_rows</span>(names, <span class="at">sep =</span> <span class="st">&quot;, &quot;</span>) </span>
<span id="cb424-4"><a href="cleaning-and-preparing-data.html#cb424-4" aria-hidden="true" tabindex="-1"></a>my_data</span></code></pre></div>
<pre><code>## # A tibble: 10 × 1
##    names   
##    &lt;chr&gt;   
##  1 &quot;Rohan&quot; 
##  2 &quot;Rhan&quot;  
##  3 &quot;ROhan&quot; 
##  4 &quot;Roham&quot; 
##  5 &quot;ROhan&quot; 
##  6 &quot;Rohan&quot; 
##  7 &quot;Rohan&quot; 
##  8 &quot;R0han&quot; 
##  9 &quot;Rohan &quot;
## 10 &quot;5Ohan&quot;</code></pre>
<p>We now need decide which of these errors we are going to fix. To help us decide which are most important, we’ll create a count.</p>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="cleaning-and-preparing-data.html#cb426-1" aria-hidden="true" tabindex="-1"></a>my_data <span class="sc">%&gt;%</span> </span>
<span id="cb426-2"><a href="cleaning-and-preparing-data.html#cb426-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(names, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## # A tibble: 7 × 2
##   names        n
##   &lt;chr&gt;    &lt;int&gt;
## 1 &quot;Rohan&quot;      3
## 2 &quot;ROhan&quot;      2
## 3 &quot;5Ohan&quot;      1
## 4 &quot;R0han&quot;      1
## 5 &quot;Rhan&quot;       1
## 6 &quot;Roham&quot;      1
## 7 &quot;Rohan &quot;     1</code></pre>
<p>The most common element is the correct one, which is great. The next one - ‘ROhan’ - looks like the ‘o’ has been incorrectly capitalized, and the one after that - ‘5Ohan’ - is distinguished by the ‘5’ instead of an ‘R.’ Let’s quickly fix these issues and then redo the count.</p>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="cleaning-and-preparing-data.html#cb428-1" aria-hidden="true" tabindex="-1"></a>my_data <span class="ot">&lt;-</span> </span>
<span id="cb428-2"><a href="cleaning-and-preparing-data.html#cb428-2" aria-hidden="true" tabindex="-1"></a>  my_data <span class="sc">%&gt;%</span> </span>
<span id="cb428-3"><a href="cleaning-and-preparing-data.html#cb428-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">names =</span> <span class="fu">str_replace_all</span>(names, <span class="st">&#39;ROhan&#39;</span>, <span class="st">&#39;Rohan&#39;</span>),</span>
<span id="cb428-4"><a href="cleaning-and-preparing-data.html#cb428-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">names =</span> <span class="fu">str_replace_all</span>(names, <span class="st">&#39;5Ohan&#39;</span>, <span class="st">&#39;Rohan&#39;</span>)</span>
<span id="cb428-5"><a href="cleaning-and-preparing-data.html#cb428-5" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb428-6"><a href="cleaning-and-preparing-data.html#cb428-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb428-7"><a href="cleaning-and-preparing-data.html#cb428-7" aria-hidden="true" tabindex="-1"></a>my_data <span class="sc">%&gt;%</span> </span>
<span id="cb428-8"><a href="cleaning-and-preparing-data.html#cb428-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(names, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## # A tibble: 5 × 2
##   names        n
##   &lt;chr&gt;    &lt;int&gt;
## 1 &quot;Rohan&quot;      6
## 2 &quot;R0han&quot;      1
## 3 &quot;Rhan&quot;       1
## 4 &quot;Roham&quot;      1
## 5 &quot;Rohan &quot;     1</code></pre>
<p>Already this is much better and 60 per cent of the values are correct, compared with earlier where it was 30 per cent. There are two more obvious errors - ‘Rhan’ and ‘Roham’ - with the first missing an ‘o’ and the second having an ‘m’ where the ‘n’ should be. Again, we can quickly update and fix those.</p>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb430-1"><a href="cleaning-and-preparing-data.html#cb430-1" aria-hidden="true" tabindex="-1"></a>my_data <span class="ot">&lt;-</span> </span>
<span id="cb430-2"><a href="cleaning-and-preparing-data.html#cb430-2" aria-hidden="true" tabindex="-1"></a>  my_data <span class="sc">%&gt;%</span> </span>
<span id="cb430-3"><a href="cleaning-and-preparing-data.html#cb430-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">names =</span> <span class="fu">str_replace_all</span>(names, <span class="st">&#39;Rhan&#39;</span>, <span class="st">&#39;Rohan&#39;</span>),</span>
<span id="cb430-4"><a href="cleaning-and-preparing-data.html#cb430-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">names =</span> <span class="fu">str_replace_all</span>(names, <span class="st">&#39;Roham&#39;</span>, <span class="st">&#39;Rohan&#39;</span>)</span>
<span id="cb430-5"><a href="cleaning-and-preparing-data.html#cb430-5" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb430-6"><a href="cleaning-and-preparing-data.html#cb430-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb430-7"><a href="cleaning-and-preparing-data.html#cb430-7" aria-hidden="true" tabindex="-1"></a>my_data <span class="sc">%&gt;%</span> </span>
<span id="cb430-8"><a href="cleaning-and-preparing-data.html#cb430-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(names, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## # A tibble: 3 × 2
##   names        n
##   &lt;chr&gt;    &lt;int&gt;
## 1 &quot;Rohan&quot;      8
## 2 &quot;R0han&quot;      1
## 3 &quot;Rohan &quot;     1</code></pre>
<p>We have achieved an 80 per cent fix with not too much effort. The two remaining issues are more subtle. The first - ‘R0han’ - has occurred because the ‘o’ has been incorrectly coded as an ‘0.’ In some fonts this will show up, but in others it will be more difficult to see. This is a common issue, especially with OCR, and something to be aware of. The second - ‘Rohan’ - is similarly subtle and is occurring because there is a trailing space. Again, trailing and leading spaces are a common issue. After we fix these two remaining issues then we will have all entries corrected.</p>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb432-1"><a href="cleaning-and-preparing-data.html#cb432-1" aria-hidden="true" tabindex="-1"></a>my_data <span class="ot">&lt;-</span> </span>
<span id="cb432-2"><a href="cleaning-and-preparing-data.html#cb432-2" aria-hidden="true" tabindex="-1"></a>  my_data <span class="sc">%&gt;%</span> </span>
<span id="cb432-3"><a href="cleaning-and-preparing-data.html#cb432-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">names =</span> <span class="fu">str_replace_all</span>(names, <span class="st">&#39;R0han&#39;</span>, <span class="st">&#39;Rohan&#39;</span>),</span>
<span id="cb432-4"><a href="cleaning-and-preparing-data.html#cb432-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">names =</span> stringr<span class="sc">::</span><span class="fu">str_trim</span>(names, <span class="at">side =</span> <span class="fu">c</span>(<span class="st">&quot;right&quot;</span>))</span>
<span id="cb432-5"><a href="cleaning-and-preparing-data.html#cb432-5" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb432-6"><a href="cleaning-and-preparing-data.html#cb432-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb432-7"><a href="cleaning-and-preparing-data.html#cb432-7" aria-hidden="true" tabindex="-1"></a>my_data <span class="sc">%&gt;%</span> </span>
<span id="cb432-8"><a href="cleaning-and-preparing-data.html#cb432-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(names, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 2
##   names     n
##   &lt;chr&gt; &lt;int&gt;
## 1 Rohan    10</code></pre>
<p>I’ve been doing the tests in my head in this example - I know that we’re hoping for ‘Rohan.’ But we can start to document this test as well. One way is to look to see if values other than ‘Rohan’ exist in the dataset.</p>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb434-1"><a href="cleaning-and-preparing-data.html#cb434-1" aria-hidden="true" tabindex="-1"></a>check_me <span class="ot">&lt;-</span> </span>
<span id="cb434-2"><a href="cleaning-and-preparing-data.html#cb434-2" aria-hidden="true" tabindex="-1"></a>  my_data <span class="sc">%&gt;%</span> </span>
<span id="cb434-3"><a href="cleaning-and-preparing-data.html#cb434-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(names <span class="sc">!=</span> <span class="st">&quot;Rohan&quot;</span>)</span>
<span id="cb434-4"><a href="cleaning-and-preparing-data.html#cb434-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb434-5"><a href="cleaning-and-preparing-data.html#cb434-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(check_me) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb434-6"><a href="cleaning-and-preparing-data.html#cb434-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&quot;Still have values that are not Rohan!&quot;</span>)</span>
<span id="cb434-7"><a href="cleaning-and-preparing-data.html#cb434-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="iterate-generalize-and-update" class="section level3" number="11.2.5">
<h3><span class="header-section-number">11.2.5</span> Iterate, generalize and update</h3>
<p>We could now iterate the plan. In this most recent case we started with 10 entries. There is no reason that we couldn’t increase this to 100 or even 1,000. We may need to generalize the cleaning proceedures and tests. But eventually we would start to being the dataset into some sort of order.</p>
</div>
</div>
<div id="case-study---kenya-census" class="section level2" number="11.3">
<h2><span class="header-section-number">11.3</span> Case study - Kenya census</h2>
<p>To make this all more clear, let’s return to the Kenyan census that we downloaded as PDFs in Chapter <a href="gather-data.html#gather-data">8</a>.</p>
<p>The distribution of population by age, sex, and administrative unit from the 2019 Kenyan census can be downloaded here: <a href="https://www.knbs.or.ke/?wpdmpro=2019-kenya-population-and-housing-census-volume-iii-distribution-of-population-by-age-sex-and-administrative-units" class="uri">https://www.knbs.or.ke/?wpdmpro=2019-kenya-population-and-housing-census-volume-iii-distribution-of-population-by-age-sex-and-administrative-units</a>.</p>
<p>And while it is great that they make it easily available, and it is easy to look-up a particular result, it is not overly useful to do larger-scale data analysis, such as building a Bayesian hierarchical model.</p>
<p>In this section we will convert a PDF of Kenyan census results of counts, by age and sex, by county and sub-county, into a tidy dataset that can be analysed. I will draw on and introduce a bunch of handy packages including: <code>janitor</code> by <span class="citation"><a href="#ref-janitor" role="doc-biblioref">Firke</a> (<a href="#ref-janitor" role="doc-biblioref">2020</a>)</span>, <code>pdftools</code> by <span class="citation"><a href="#ref-pdftools" role="doc-biblioref">Ooms</a> (<a href="#ref-pdftools" role="doc-biblioref">2019b</a>)</span>, <code>tidyverse</code> by <span class="citation"><a href="#ref-tidyverse" role="doc-biblioref">Wickham et al.</a> (<a href="#ref-tidyverse" role="doc-biblioref">2019a</a>)</span>, and <code>stringi</code> by <span class="citation"><a href="#ref-stringi" role="doc-biblioref">Gagolewski</a> (<a href="#ref-stringi" role="doc-biblioref">2020</a>)</span>.</p>
<div id="set-up" class="section level3" number="11.3.1">
<h3><span class="header-section-number">11.3.1</span> Set-up</h3>
<p>To get started I need to load the necessary packages.</p>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="cleaning-and-preparing-data.html#cb435-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb435-2"><a href="cleaning-and-preparing-data.html#cb435-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pdftools)</span>
<span id="cb435-3"><a href="cleaning-and-preparing-data.html#cb435-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb435-4"><a href="cleaning-and-preparing-data.html#cb435-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringi)</span></code></pre></div>
<p>And then I need to read in the PDF that I want to convert.</p>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb436-1"><a href="cleaning-and-preparing-data.html#cb436-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in the PDF</span></span>
<span id="cb436-2"><a href="cleaning-and-preparing-data.html#cb436-2" aria-hidden="true" tabindex="-1"></a>all_content <span class="ot">&lt;-</span> pdftools<span class="sc">::</span><span class="fu">pdf_text</span>(<span class="st">&quot;inputs/pdfs/2019_Kenya_census.pdf&quot;</span>)</span></code></pre></div>
<p>The <code>pdf_text</code> function from <code>pdftools</code> is useful when you have a PDF and you want to read the content into R. For many recently produced PDFs it’ll work pretty well, but there are alternatives. If the PDF is an image, then it won’t work, and you’ll need to turn to OCR.</p>
<p>You can see a page of the PDF here:</p>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb437-1"><a href="cleaning-and-preparing-data.html#cb437-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">&quot;figures/2020-04-10-screenshot-of-census.png&quot;</span>) </span></code></pre></div>
<p><img src="figures/2020-04-10-screenshot-of-census.png" width="85%" /></p>
</div>
<div id="extract" class="section level3" number="11.3.2">
<h3><span class="header-section-number">11.3.2</span> Extract</h3>
<p>The first challenge is to get the dataset into a format that we can more easily manipulate. The way that I am going to do this is to consider each page of the PDF and extract the relevant parts. To do this, I first write a function that I want to apply to each page.</p>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb438-1"><a href="cleaning-and-preparing-data.html#cb438-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The function is going to take an input of a page</span></span>
<span id="cb438-2"><a href="cleaning-and-preparing-data.html#cb438-2" aria-hidden="true" tabindex="-1"></a>get_data <span class="ot">&lt;-</span> <span class="cf">function</span>(i){</span>
<span id="cb438-3"><a href="cleaning-and-preparing-data.html#cb438-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Just look at the page of interest</span></span>
<span id="cb438-4"><a href="cleaning-and-preparing-data.html#cb438-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Based on https://stackoverflow.com/questions/47793326/tabulize-function-in-r</span></span>
<span id="cb438-5"><a href="cleaning-and-preparing-data.html#cb438-5" aria-hidden="true" tabindex="-1"></a>  just_page_i <span class="ot">&lt;-</span> stringi<span class="sc">::</span><span class="fu">stri_split_lines</span>(all_content[[i]])[[<span class="dv">1</span>]] </span>
<span id="cb438-6"><a href="cleaning-and-preparing-data.html#cb438-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb438-7"><a href="cleaning-and-preparing-data.html#cb438-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Grab the name of the location</span></span>
<span id="cb438-8"><a href="cleaning-and-preparing-data.html#cb438-8" aria-hidden="true" tabindex="-1"></a>  area <span class="ot">&lt;-</span> just_page_i[<span class="dv">3</span>] <span class="sc">%&gt;%</span> <span class="fu">str_squish</span>()</span>
<span id="cb438-9"><a href="cleaning-and-preparing-data.html#cb438-9" aria-hidden="true" tabindex="-1"></a>  area <span class="ot">&lt;-</span> <span class="fu">str_to_title</span>(area)</span>
<span id="cb438-10"><a href="cleaning-and-preparing-data.html#cb438-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb438-11"><a href="cleaning-and-preparing-data.html#cb438-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Grab the type of table</span></span>
<span id="cb438-12"><a href="cleaning-and-preparing-data.html#cb438-12" aria-hidden="true" tabindex="-1"></a>  type_of_table <span class="ot">&lt;-</span> just_page_i[<span class="dv">2</span>] <span class="sc">%&gt;%</span> <span class="fu">str_squish</span>()</span>
<span id="cb438-13"><a href="cleaning-and-preparing-data.html#cb438-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb438-14"><a href="cleaning-and-preparing-data.html#cb438-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get rid of the top matter</span></span>
<span id="cb438-15"><a href="cleaning-and-preparing-data.html#cb438-15" aria-hidden="true" tabindex="-1"></a>  just_page_i_no_header <span class="ot">&lt;-</span> just_page_i[<span class="dv">5</span><span class="sc">:</span><span class="fu">length</span>(just_page_i)] <span class="co"># Just manually for now, but could create some rules if needed</span></span>
<span id="cb438-16"><a href="cleaning-and-preparing-data.html#cb438-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb438-17"><a href="cleaning-and-preparing-data.html#cb438-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get rid of the bottom matter</span></span>
<span id="cb438-18"><a href="cleaning-and-preparing-data.html#cb438-18" aria-hidden="true" tabindex="-1"></a>  just_page_i_no_header_no_footer <span class="ot">&lt;-</span> just_page_i_no_header[<span class="dv">1</span><span class="sc">:</span><span class="dv">62</span>] <span class="co"># Just manually for now, but could create some rules if needed</span></span>
<span id="cb438-19"><a href="cleaning-and-preparing-data.html#cb438-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb438-20"><a href="cleaning-and-preparing-data.html#cb438-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert into a tibble</span></span>
<span id="cb438-21"><a href="cleaning-and-preparing-data.html#cb438-21" aria-hidden="true" tabindex="-1"></a>  demography_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">all =</span> just_page_i_no_header_no_footer)</span>
<span id="cb438-22"><a href="cleaning-and-preparing-data.html#cb438-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb438-23"><a href="cleaning-and-preparing-data.html#cb438-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># # Split columns</span></span>
<span id="cb438-24"><a href="cleaning-and-preparing-data.html#cb438-24" aria-hidden="true" tabindex="-1"></a>  demography_data <span class="ot">&lt;-</span></span>
<span id="cb438-25"><a href="cleaning-and-preparing-data.html#cb438-25" aria-hidden="true" tabindex="-1"></a>    demography_data <span class="sc">%&gt;%</span></span>
<span id="cb438-26"><a href="cleaning-and-preparing-data.html#cb438-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">all =</span> <span class="fu">str_squish</span>(all)) <span class="sc">%&gt;%</span> <span class="co"># Any space more than two spaces is squished down to one</span></span>
<span id="cb438-27"><a href="cleaning-and-preparing-data.html#cb438-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">all =</span> <span class="fu">str_replace</span>(all, <span class="st">&quot;10 -14&quot;</span>, <span class="st">&quot;10-14&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb438-28"><a href="cleaning-and-preparing-data.html#cb438-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">all =</span> <span class="fu">str_replace</span>(all, <span class="st">&quot;Not Stated&quot;</span>, <span class="st">&quot;NotStated&quot;</span>)) <span class="sc">%&gt;%</span> <span class="co"># Any space more than two spaces is squished down to one</span></span>
<span id="cb438-29"><a href="cleaning-and-preparing-data.html#cb438-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">separate</span>(<span class="at">col =</span> all,</span>
<span id="cb438-30"><a href="cleaning-and-preparing-data.html#cb438-30" aria-hidden="true" tabindex="-1"></a>             <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;age&quot;</span>, <span class="st">&quot;male&quot;</span>, <span class="st">&quot;female&quot;</span>, <span class="st">&quot;total&quot;</span>, <span class="st">&quot;age_2&quot;</span>, <span class="st">&quot;male_2&quot;</span>, <span class="st">&quot;female_2&quot;</span>, <span class="st">&quot;total_2&quot;</span>),</span>
<span id="cb438-31"><a href="cleaning-and-preparing-data.html#cb438-31" aria-hidden="true" tabindex="-1"></a>             <span class="at">sep =</span> <span class="st">&quot; &quot;</span>, <span class="co"># Just looking for a space. Seems to work fine because the tables are pretty nicely laid out</span></span>
<span id="cb438-32"><a href="cleaning-and-preparing-data.html#cb438-32" aria-hidden="true" tabindex="-1"></a>             <span class="at">remove =</span> <span class="cn">TRUE</span>,</span>
<span id="cb438-33"><a href="cleaning-and-preparing-data.html#cb438-33" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> <span class="st">&quot;right&quot;</span></span>
<span id="cb438-34"><a href="cleaning-and-preparing-data.html#cb438-34" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb438-35"><a href="cleaning-and-preparing-data.html#cb438-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb438-36"><a href="cleaning-and-preparing-data.html#cb438-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># They are side by side at the moment, need to append to bottom</span></span>
<span id="cb438-37"><a href="cleaning-and-preparing-data.html#cb438-37" aria-hidden="true" tabindex="-1"></a>  demography_data_long <span class="ot">&lt;-</span></span>
<span id="cb438-38"><a href="cleaning-and-preparing-data.html#cb438-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rbind</span>(demography_data <span class="sc">%&gt;%</span> <span class="fu">select</span>(age, male, female, total),</span>
<span id="cb438-39"><a href="cleaning-and-preparing-data.html#cb438-39" aria-hidden="true" tabindex="-1"></a>          demography_data <span class="sc">%&gt;%</span></span>
<span id="cb438-40"><a href="cleaning-and-preparing-data.html#cb438-40" aria-hidden="true" tabindex="-1"></a>            <span class="fu">select</span>(age_2, male_2, female_2, total_2) <span class="sc">%&gt;%</span></span>
<span id="cb438-41"><a href="cleaning-and-preparing-data.html#cb438-41" aria-hidden="true" tabindex="-1"></a>            <span class="fu">rename</span>(<span class="at">age =</span> age_2, <span class="at">male =</span> male_2, <span class="at">female =</span> female_2, <span class="at">total =</span> total_2)</span>
<span id="cb438-42"><a href="cleaning-and-preparing-data.html#cb438-42" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb438-43"><a href="cleaning-and-preparing-data.html#cb438-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb438-44"><a href="cleaning-and-preparing-data.html#cb438-44" aria-hidden="true" tabindex="-1"></a>  <span class="co"># There is one row of NAs, so remove it</span></span>
<span id="cb438-45"><a href="cleaning-and-preparing-data.html#cb438-45" aria-hidden="true" tabindex="-1"></a>  demography_data_long <span class="ot">&lt;-</span> </span>
<span id="cb438-46"><a href="cleaning-and-preparing-data.html#cb438-46" aria-hidden="true" tabindex="-1"></a>    demography_data_long <span class="sc">%&gt;%</span> </span>
<span id="cb438-47"><a href="cleaning-and-preparing-data.html#cb438-47" aria-hidden="true" tabindex="-1"></a>    janitor<span class="sc">::</span><span class="fu">remove_empty</span>(<span class="at">which =</span> <span class="fu">c</span>(<span class="st">&quot;rows&quot;</span>))</span>
<span id="cb438-48"><a href="cleaning-and-preparing-data.html#cb438-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb438-49"><a href="cleaning-and-preparing-data.html#cb438-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add the area and the page</span></span>
<span id="cb438-50"><a href="cleaning-and-preparing-data.html#cb438-50" aria-hidden="true" tabindex="-1"></a>  demography_data_long<span class="sc">$</span>area <span class="ot">&lt;-</span> area</span>
<span id="cb438-51"><a href="cleaning-and-preparing-data.html#cb438-51" aria-hidden="true" tabindex="-1"></a>  demography_data_long<span class="sc">$</span>table <span class="ot">&lt;-</span> type_of_table</span>
<span id="cb438-52"><a href="cleaning-and-preparing-data.html#cb438-52" aria-hidden="true" tabindex="-1"></a>  demography_data_long<span class="sc">$</span>page <span class="ot">&lt;-</span> i</span>
<span id="cb438-53"><a href="cleaning-and-preparing-data.html#cb438-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb438-54"><a href="cleaning-and-preparing-data.html#cb438-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(just_page_i,</span>
<span id="cb438-55"><a href="cleaning-and-preparing-data.html#cb438-55" aria-hidden="true" tabindex="-1"></a>     i,</span>
<span id="cb438-56"><a href="cleaning-and-preparing-data.html#cb438-56" aria-hidden="true" tabindex="-1"></a>     area,</span>
<span id="cb438-57"><a href="cleaning-and-preparing-data.html#cb438-57" aria-hidden="true" tabindex="-1"></a>     type_of_table,</span>
<span id="cb438-58"><a href="cleaning-and-preparing-data.html#cb438-58" aria-hidden="true" tabindex="-1"></a>     just_page_i_no_header,</span>
<span id="cb438-59"><a href="cleaning-and-preparing-data.html#cb438-59" aria-hidden="true" tabindex="-1"></a>     just_page_i_no_header_no_footer,</span>
<span id="cb438-60"><a href="cleaning-and-preparing-data.html#cb438-60" aria-hidden="true" tabindex="-1"></a>     demography_data)</span>
<span id="cb438-61"><a href="cleaning-and-preparing-data.html#cb438-61" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb438-62"><a href="cleaning-and-preparing-data.html#cb438-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(demography_data_long)</span>
<span id="cb438-63"><a href="cleaning-and-preparing-data.html#cb438-63" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>At this point, I have a function that does what I need to each page of the PDF. I’m going to use the function <code>map_dfr</code> from the <code>purrr</code> package to apply that function to each page, and then combine all the outputs into one tibble.</p>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb439-1"><a href="cleaning-and-preparing-data.html#cb439-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run through each relevant page and get the data</span></span>
<span id="cb439-2"><a href="cleaning-and-preparing-data.html#cb439-2" aria-hidden="true" tabindex="-1"></a>pages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">30</span><span class="sc">:</span><span class="dv">513</span>)</span>
<span id="cb439-3"><a href="cleaning-and-preparing-data.html#cb439-3" aria-hidden="true" tabindex="-1"></a>all_tables <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(pages, get_data)</span>
<span id="cb439-4"><a href="cleaning-and-preparing-data.html#cb439-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(pages, get_data, all_content)</span></code></pre></div>
</div>
<div id="clean-2" class="section level3" number="11.3.3">
<h3><span class="header-section-number">11.3.3</span> Clean</h3>
<p>I now need to clean the dataset to make it useful.</p>
<div id="values" class="section level4" number="11.3.3.1">
<h4><span class="header-section-number">11.3.3.1</span> Values</h4>
<p>The first step is to make the numbers into actual numbers, rather than characters. Before I can convert the type I need to remove anything that is not a number otherwise it’ll be converted into an NA. I first identify any values that are not numbers so that I can remove them.</p>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb440-1"><a href="cleaning-and-preparing-data.html#cb440-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Need to convert male, female, and total to integers</span></span>
<span id="cb440-2"><a href="cleaning-and-preparing-data.html#cb440-2" aria-hidden="true" tabindex="-1"></a><span class="co"># First find the characters that should not be in there</span></span>
<span id="cb440-3"><a href="cleaning-and-preparing-data.html#cb440-3" aria-hidden="true" tabindex="-1"></a>all_tables <span class="sc">%&gt;%</span> </span>
<span id="cb440-4"><a href="cleaning-and-preparing-data.html#cb440-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(male, female, total) <span class="sc">%&gt;%</span></span>
<span id="cb440-5"><a href="cleaning-and-preparing-data.html#cb440-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_all</span>(<span class="sc">~</span><span class="fu">str_remove_all</span>(., <span class="st">&quot;[:digit:]&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb440-6"><a href="cleaning-and-preparing-data.html#cb440-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_all</span>(<span class="sc">~</span><span class="fu">str_remove_all</span>(., <span class="st">&quot;,&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb440-7"><a href="cleaning-and-preparing-data.html#cb440-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_all</span>(<span class="sc">~</span><span class="fu">str_remove_all</span>(., <span class="st">&quot;_&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb440-8"><a href="cleaning-and-preparing-data.html#cb440-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_all</span>(<span class="sc">~</span><span class="fu">str_remove_all</span>(., <span class="st">&quot;-&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb440-9"><a href="cleaning-and-preparing-data.html#cb440-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span></code></pre></div>
<pre><code>## # A tibble: 39 × 3
##    male    female         total  
##    &lt;chr&gt;   &lt;chr&gt;          &lt;chr&gt;  
##  1  &lt;NA&gt;    &lt;NA&gt;           &lt;NA&gt;  
##  2 &quot;.:&quot;    &quot;Distribution&quot; &quot;of&quot;   
##  3 &quot;Male&quot;  &quot;Female&quot;       &quot;Total&quot;
##  4 &quot;&quot;      &quot;&quot;             &quot;&quot;     
##  5 &quot;by&quot;    &quot;Age&quot;          &quot;Sex*&quot; 
##  6 &quot;LUNGA&quot;  &lt;NA&gt;           &lt;NA&gt;  
##  7 &quot;NORTH&quot;  &lt;NA&gt;           &lt;NA&gt;  
##  8 &quot;SOUTH&quot;  &lt;NA&gt;           &lt;NA&gt;  
##  9 &quot;RIVER&quot;  &lt;NA&gt;           &lt;NA&gt;  
## 10 &quot;DELTA&quot;  &lt;NA&gt;           &lt;NA&gt;  
## # … with 29 more rows</code></pre>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb442-1"><a href="cleaning-and-preparing-data.html#cb442-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We clearly need to remove &quot;,&quot;, &quot;_&quot;, and &quot;-&quot;. </span></span>
<span id="cb442-2"><a href="cleaning-and-preparing-data.html#cb442-2" aria-hidden="true" tabindex="-1"></a><span class="co"># This also highlights a few issues on p. 185 that need to be manually adjusted</span></span>
<span id="cb442-3"><a href="cleaning-and-preparing-data.html#cb442-3" aria-hidden="true" tabindex="-1"></a><span class="co"># https://twitter.com/RohanAlexander/status/1244337583016022018</span></span>
<span id="cb442-4"><a href="cleaning-and-preparing-data.html#cb442-4" aria-hidden="true" tabindex="-1"></a>all_tables<span class="sc">$</span>male[all_tables<span class="sc">$</span>male <span class="sc">==</span> <span class="st">&quot;23-Jun&quot;</span>] <span class="ot">&lt;-</span> <span class="dv">4923</span></span>
<span id="cb442-5"><a href="cleaning-and-preparing-data.html#cb442-5" aria-hidden="true" tabindex="-1"></a>all_tables<span class="sc">$</span>male[all_tables<span class="sc">$</span>male <span class="sc">==</span> <span class="st">&quot;15-Aug&quot;</span>] <span class="ot">&lt;-</span> <span class="dv">4611</span></span></code></pre></div>
<p>While you could use the <code>janitor</code> package here, it is worthwhile at least first looking at what is going on because sometimes there is odd stuff that janitor (and other packages) will deal with, but not in a way that you want. In this case, they’ve used Excel or similar and this has converted a couple of their entries into dates. If we just took the numbers from the column then we’d have 23 and 15 here, but by inspecting the column we can use Excel to reverse the process and enter the correct values of 4,923 and 4,611, respectively.</p>
<p>Having identified everything that needs to be removed, we can do the actual removal and convert our character column of numbers to integers.</p>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb443-1"><a href="cleaning-and-preparing-data.html#cb443-1" aria-hidden="true" tabindex="-1"></a>all_tables <span class="ot">&lt;-</span></span>
<span id="cb443-2"><a href="cleaning-and-preparing-data.html#cb443-2" aria-hidden="true" tabindex="-1"></a>  all_tables <span class="sc">%&gt;%</span></span>
<span id="cb443-3"><a href="cleaning-and-preparing-data.html#cb443-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(male, female, total), <span class="sc">~</span><span class="fu">str_remove_all</span>(., <span class="st">&quot;,&quot;</span>)) <span class="sc">%&gt;%</span> <span class="co"># First get rid of commas</span></span>
<span id="cb443-4"><a href="cleaning-and-preparing-data.html#cb443-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(male, female, total), <span class="sc">~</span><span class="fu">str_replace</span>(., <span class="st">&quot;_&quot;</span>, <span class="st">&quot;0&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb443-5"><a href="cleaning-and-preparing-data.html#cb443-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(male, female, total), <span class="sc">~</span><span class="fu">str_replace</span>(., <span class="st">&quot;-&quot;</span>, <span class="st">&quot;0&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb443-6"><a href="cleaning-and-preparing-data.html#cb443-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(male, female, total), <span class="sc">~</span><span class="fu">as.integer</span>(.))</span></code></pre></div>
</div>
<div id="areas" class="section level4" number="11.3.3.2">
<h4><span class="header-section-number">11.3.3.2</span> Areas</h4>
<p>The next thing to clean is the areas. We know that there are 47 counties in Kenya, and a whole bunch of sub-counties. They give us a list on pages 19 to 22 of the PDF (document pages 7 to 10). However, this list is not complete, and there are a few minor issues that we’ll deal with later.</p>
<p>In any case, I first need to fix a few inconsistencies.</p>
<div class="sourceCode" id="cb444"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb444-1"><a href="cleaning-and-preparing-data.html#cb444-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fix some area names</span></span>
<span id="cb444-2"><a href="cleaning-and-preparing-data.html#cb444-2" aria-hidden="true" tabindex="-1"></a>all_tables<span class="sc">$</span>area[all_tables<span class="sc">$</span>area <span class="sc">==</span> <span class="st">&quot;Taita/ Taveta&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Taita/Taveta&quot;</span></span>
<span id="cb444-3"><a href="cleaning-and-preparing-data.html#cb444-3" aria-hidden="true" tabindex="-1"></a>all_tables<span class="sc">$</span>area[all_tables<span class="sc">$</span>area <span class="sc">==</span> <span class="st">&quot;Elgeyo/ Marakwet&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Elgeyo/Marakwet&quot;</span></span>
<span id="cb444-4"><a href="cleaning-and-preparing-data.html#cb444-4" aria-hidden="true" tabindex="-1"></a>all_tables<span class="sc">$</span>area[all_tables<span class="sc">$</span>area <span class="sc">==</span> <span class="st">&quot;Nairobi City&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Nairobi&quot;</span></span></code></pre></div>
<p>Kenya has 47 counties, each of which has sub-counties. The PDF has them arranged as the county data then the sub-counties, without designating which is which. We can use the names, to a certain extent, but in a handful of cases, there is a sub-county that has the same name as a county so we need to first fix that.</p>
<p>The PDF is made-up of three tables.</p>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="cleaning-and-preparing-data.html#cb445-1" aria-hidden="true" tabindex="-1"></a>all_tables<span class="sc">$</span>table <span class="sc">%&gt;%</span> <span class="fu">table</span>()</span></code></pre></div>
<pre><code>## .
##       
## 59185</code></pre>
<p>So I can first get the names of the counties based on those first two tables and then reconcile them to get a list of the counties.</p>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb447-1"><a href="cleaning-and-preparing-data.html#cb447-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get a list of the counties </span></span>
<span id="cb447-2"><a href="cleaning-and-preparing-data.html#cb447-2" aria-hidden="true" tabindex="-1"></a>list_counties <span class="ot">&lt;-</span> </span>
<span id="cb447-3"><a href="cleaning-and-preparing-data.html#cb447-3" aria-hidden="true" tabindex="-1"></a>  all_tables <span class="sc">%&gt;%</span> </span>
<span id="cb447-4"><a href="cleaning-and-preparing-data.html#cb447-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(table <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Table 2.4a: Distribution of Rural Population by Age, Sex* and County&quot;</span>,</span>
<span id="cb447-5"><a href="cleaning-and-preparing-data.html#cb447-5" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;Table 2.4b: Distribution of Urban Population by Age, Sex* and County&quot;</span>)</span>
<span id="cb447-6"><a href="cleaning-and-preparing-data.html#cb447-6" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">%&gt;%</span> </span>
<span id="cb447-7"><a href="cleaning-and-preparing-data.html#cb447-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(area) <span class="sc">%&gt;%</span> </span>
<span id="cb447-8"><a href="cleaning-and-preparing-data.html#cb447-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span></code></pre></div>
<p>As I hoped, there are 47 of them. But before I can add a flag based on those names, I need to deal with the sub-counties that share their name. We will do this based on the page, then looking it up and deciding which is the county page and which is the sub-county page.</p>
<div class="sourceCode" id="cb448"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb448-1"><a href="cleaning-and-preparing-data.html#cb448-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The following have the issue of the name being used for both a county and a sub-county:</span></span>
<span id="cb448-2"><a href="cleaning-and-preparing-data.html#cb448-2" aria-hidden="true" tabindex="-1"></a>all_tables <span class="sc">%&gt;%</span> </span>
<span id="cb448-3"><a href="cleaning-and-preparing-data.html#cb448-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(table <span class="sc">==</span> <span class="st">&quot;Table 2.3: Distribution of Population by Age, Sex*, County and Sub- County&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb448-4"><a href="cleaning-and-preparing-data.html#cb448-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(area <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Busia&quot;</span>,</span>
<span id="cb448-5"><a href="cleaning-and-preparing-data.html#cb448-5" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;Garissa&quot;</span>,</span>
<span id="cb448-6"><a href="cleaning-and-preparing-data.html#cb448-6" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;Homa Bay&quot;</span>,</span>
<span id="cb448-7"><a href="cleaning-and-preparing-data.html#cb448-7" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;Isiolo&quot;</span>,</span>
<span id="cb448-8"><a href="cleaning-and-preparing-data.html#cb448-8" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;Kiambu&quot;</span>,</span>
<span id="cb448-9"><a href="cleaning-and-preparing-data.html#cb448-9" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;Machakos&quot;</span>,</span>
<span id="cb448-10"><a href="cleaning-and-preparing-data.html#cb448-10" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;Makueni&quot;</span>,</span>
<span id="cb448-11"><a href="cleaning-and-preparing-data.html#cb448-11" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;Samburu&quot;</span>,</span>
<span id="cb448-12"><a href="cleaning-and-preparing-data.html#cb448-12" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;Siaya&quot;</span>,</span>
<span id="cb448-13"><a href="cleaning-and-preparing-data.html#cb448-13" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;Tana River&quot;</span>,</span>
<span id="cb448-14"><a href="cleaning-and-preparing-data.html#cb448-14" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;Vihiga&quot;</span>,</span>
<span id="cb448-15"><a href="cleaning-and-preparing-data.html#cb448-15" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;West Pokot&quot;</span>)</span>
<span id="cb448-16"><a href="cleaning-and-preparing-data.html#cb448-16" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">%&gt;%</span> </span>
<span id="cb448-17"><a href="cleaning-and-preparing-data.html#cb448-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(area, page) <span class="sc">%&gt;%</span> </span>
<span id="cb448-18"><a href="cleaning-and-preparing-data.html#cb448-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span></code></pre></div>
<pre><code>## # A tibble: 0 × 2
## # … with 2 variables: area &lt;chr&gt;, page &lt;int&gt;</code></pre>
<p>Now we can add the flag for whether the area is a county and adjust for the ones that are troublesome,</p>
<div class="sourceCode" id="cb450"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb450-1"><a href="cleaning-and-preparing-data.html#cb450-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add flag for whether it is a county or a sub-county</span></span>
<span id="cb450-2"><a href="cleaning-and-preparing-data.html#cb450-2" aria-hidden="true" tabindex="-1"></a>all_tables <span class="ot">&lt;-</span> </span>
<span id="cb450-3"><a href="cleaning-and-preparing-data.html#cb450-3" aria-hidden="true" tabindex="-1"></a>  all_tables <span class="sc">%&gt;%</span> </span>
<span id="cb450-4"><a href="cleaning-and-preparing-data.html#cb450-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">area_type =</span> <span class="fu">if_else</span>(area <span class="sc">%in%</span> list_counties<span class="sc">$</span>area, <span class="st">&quot;county&quot;</span>, <span class="st">&quot;sub-county&quot;</span>))</span>
<span id="cb450-5"><a href="cleaning-and-preparing-data.html#cb450-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Fix the flag for the ones that have their names used twice</span></span>
<span id="cb450-6"><a href="cleaning-and-preparing-data.html#cb450-6" aria-hidden="true" tabindex="-1"></a>all_tables <span class="ot">&lt;-</span> </span>
<span id="cb450-7"><a href="cleaning-and-preparing-data.html#cb450-7" aria-hidden="true" tabindex="-1"></a>  all_tables <span class="sc">%&gt;%</span> </span>
<span id="cb450-8"><a href="cleaning-and-preparing-data.html#cb450-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">area_type =</span> <span class="fu">case_when</span>(</span>
<span id="cb450-9"><a href="cleaning-and-preparing-data.html#cb450-9" aria-hidden="true" tabindex="-1"></a>    area <span class="sc">==</span> <span class="st">&quot;Samburu&quot;</span> <span class="sc">&amp;</span> page <span class="sc">==</span> <span class="dv">42</span> <span class="sc">~</span> <span class="st">&quot;sub-county&quot;</span>,</span>
<span id="cb450-10"><a href="cleaning-and-preparing-data.html#cb450-10" aria-hidden="true" tabindex="-1"></a>    area <span class="sc">==</span> <span class="st">&quot;Tana River&quot;</span> <span class="sc">&amp;</span> page <span class="sc">==</span> <span class="dv">56</span> <span class="sc">~</span> <span class="st">&quot;sub-county&quot;</span>,</span>
<span id="cb450-11"><a href="cleaning-and-preparing-data.html#cb450-11" aria-hidden="true" tabindex="-1"></a>    area <span class="sc">==</span> <span class="st">&quot;Garissa&quot;</span> <span class="sc">&amp;</span> page <span class="sc">==</span> <span class="dv">69</span> <span class="sc">~</span> <span class="st">&quot;sub-county&quot;</span>,</span>
<span id="cb450-12"><a href="cleaning-and-preparing-data.html#cb450-12" aria-hidden="true" tabindex="-1"></a>    area <span class="sc">==</span> <span class="st">&quot;Isiolo&quot;</span> <span class="sc">&amp;</span> page <span class="sc">==</span> <span class="dv">100</span> <span class="sc">~</span> <span class="st">&quot;sub-county&quot;</span>,</span>
<span id="cb450-13"><a href="cleaning-and-preparing-data.html#cb450-13" aria-hidden="true" tabindex="-1"></a>    area <span class="sc">==</span> <span class="st">&quot;Machakos&quot;</span> <span class="sc">&amp;</span> page <span class="sc">==</span> <span class="dv">154</span> <span class="sc">~</span> <span class="st">&quot;sub-county&quot;</span>,</span>
<span id="cb450-14"><a href="cleaning-and-preparing-data.html#cb450-14" aria-hidden="true" tabindex="-1"></a>    area <span class="sc">==</span> <span class="st">&quot;Makueni&quot;</span> <span class="sc">&amp;</span> page <span class="sc">==</span> <span class="dv">164</span> <span class="sc">~</span> <span class="st">&quot;sub-county&quot;</span>,</span>
<span id="cb450-15"><a href="cleaning-and-preparing-data.html#cb450-15" aria-hidden="true" tabindex="-1"></a>    area <span class="sc">==</span> <span class="st">&quot;Kiambu&quot;</span> <span class="sc">&amp;</span> page <span class="sc">==</span> <span class="dv">213</span> <span class="sc">~</span> <span class="st">&quot;sub-county&quot;</span>,</span>
<span id="cb450-16"><a href="cleaning-and-preparing-data.html#cb450-16" aria-hidden="true" tabindex="-1"></a>    area <span class="sc">==</span> <span class="st">&quot;West Pokot&quot;</span> <span class="sc">&amp;</span> page <span class="sc">==</span> <span class="dv">233</span> <span class="sc">~</span> <span class="st">&quot;sub-county&quot;</span>,</span>
<span id="cb450-17"><a href="cleaning-and-preparing-data.html#cb450-17" aria-hidden="true" tabindex="-1"></a>    area <span class="sc">==</span> <span class="st">&quot;Vihiga&quot;</span> <span class="sc">&amp;</span> page <span class="sc">==</span> <span class="dv">333</span> <span class="sc">~</span> <span class="st">&quot;sub-county&quot;</span>,</span>
<span id="cb450-18"><a href="cleaning-and-preparing-data.html#cb450-18" aria-hidden="true" tabindex="-1"></a>    area <span class="sc">==</span> <span class="st">&quot;Busia&quot;</span> <span class="sc">&amp;</span> page <span class="sc">==</span> <span class="dv">353</span> <span class="sc">~</span> <span class="st">&quot;sub-county&quot;</span>,</span>
<span id="cb450-19"><a href="cleaning-and-preparing-data.html#cb450-19" aria-hidden="true" tabindex="-1"></a>    area <span class="sc">==</span> <span class="st">&quot;Siaya&quot;</span> <span class="sc">&amp;</span> page <span class="sc">==</span> <span class="dv">360</span> <span class="sc">~</span> <span class="st">&quot;sub-county&quot;</span>,</span>
<span id="cb450-20"><a href="cleaning-and-preparing-data.html#cb450-20" aria-hidden="true" tabindex="-1"></a>    area <span class="sc">==</span> <span class="st">&quot;Homa Bay&quot;</span> <span class="sc">&amp;</span> page <span class="sc">==</span> <span class="dv">375</span> <span class="sc">~</span> <span class="st">&quot;sub-county&quot;</span>,</span>
<span id="cb450-21"><a href="cleaning-and-preparing-data.html#cb450-21" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> area_type</span>
<span id="cb450-22"><a href="cleaning-and-preparing-data.html#cb450-22" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb450-23"><a href="cleaning-and-preparing-data.html#cb450-23" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb450-24"><a href="cleaning-and-preparing-data.html#cb450-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb450-25"><a href="cleaning-and-preparing-data.html#cb450-25" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(list_counties)</span></code></pre></div>
</div>
<div id="ages" class="section level4" number="11.3.3.3">
<h4><span class="header-section-number">11.3.3.3</span> Ages</h4>
<p>Now we can deal with the ages.</p>
<p>First we need to fix some errors.</p>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb451-1"><a href="cleaning-and-preparing-data.html#cb451-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean up ages</span></span>
<span id="cb451-2"><a href="cleaning-and-preparing-data.html#cb451-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(all_tables<span class="sc">$</span>age) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code></pre></div>
<pre><code>## 
##           0   0-4     1    10 10-14 
##   392   484   484   484   484   482</code></pre>
<div class="sourceCode" id="cb453"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb453-1"><a href="cleaning-and-preparing-data.html#cb453-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(all_tables<span class="sc">$</span>age) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code></pre></div>
<pre><code>## [1] &quot;&quot;        &quot;Table&quot;   &quot;MOMBASA&quot; &quot;Age&quot;     &quot;Total&quot;   &quot;0&quot;</code></pre>
<div class="sourceCode" id="cb455"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb455-1"><a href="cleaning-and-preparing-data.html#cb455-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Looks like there should be 484, so need to follow up on some:</span></span>
<span id="cb455-2"><a href="cleaning-and-preparing-data.html#cb455-2" aria-hidden="true" tabindex="-1"></a>all_tables<span class="sc">$</span>age[all_tables<span class="sc">$</span>age <span class="sc">==</span> <span class="st">&quot;NotStated&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Not Stated&quot;</span></span>
<span id="cb455-3"><a href="cleaning-and-preparing-data.html#cb455-3" aria-hidden="true" tabindex="-1"></a>all_tables<span class="sc">$</span>age[all_tables<span class="sc">$</span>age <span class="sc">==</span> <span class="st">&quot;43594&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;5-9&quot;</span></span>
<span id="cb455-4"><a href="cleaning-and-preparing-data.html#cb455-4" aria-hidden="true" tabindex="-1"></a>all_tables<span class="sc">$</span>age[all_tables<span class="sc">$</span>age <span class="sc">==</span> <span class="st">&quot;43752&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;10-14&quot;</span></span>
<span id="cb455-5"><a href="cleaning-and-preparing-data.html#cb455-5" aria-hidden="true" tabindex="-1"></a>all_tables<span class="sc">$</span>age[all_tables<span class="sc">$</span>age <span class="sc">==</span> <span class="st">&quot;9-14&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;5-9&quot;</span></span>
<span id="cb455-6"><a href="cleaning-and-preparing-data.html#cb455-6" aria-hidden="true" tabindex="-1"></a>all_tables<span class="sc">$</span>age[all_tables<span class="sc">$</span>age <span class="sc">==</span> <span class="st">&quot;10-19&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;10-14&quot;</span></span></code></pre></div>
<p>The census has done some of the work of putting together age-groups for us, but we want to make it easy to just focus on the counts by single-year-age. As such I’ll add a flag as to the type of age it is: an age group, such as ages 0 to 5, or a single age, such as 1.</p>
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb456-1"><a href="cleaning-and-preparing-data.html#cb456-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a flag as to whether it&#39;s a summary or not</span></span>
<span id="cb456-2"><a href="cleaning-and-preparing-data.html#cb456-2" aria-hidden="true" tabindex="-1"></a>all_tables<span class="sc">$</span>age_type <span class="ot">&lt;-</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(all_tables<span class="sc">$</span>age, <span class="fu">c</span>(<span class="st">&quot;-&quot;</span>)), <span class="st">&quot;age-group&quot;</span>, <span class="st">&quot;single-year&quot;</span>)</span>
<span id="cb456-3"><a href="cleaning-and-preparing-data.html#cb456-3" aria-hidden="true" tabindex="-1"></a>all_tables<span class="sc">$</span>age_type <span class="ot">&lt;-</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(all_tables<span class="sc">$</span>age, <span class="fu">c</span>(<span class="st">&quot;Total&quot;</span>)), <span class="st">&quot;age-group&quot;</span>, all_tables<span class="sc">$</span>age_type)</span></code></pre></div>
<p>At the moment, age is a character variable. We have a decision to make here, because we don’t want it to be a character variable (because it won’t graph properly), but we don’t want it to be a numeric, because there is <code>total</code> and also <code>100+</code> in there. For now, we’ll just make it into a factor, and at least that will be able to be nicely graphed.</p>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb457-1"><a href="cleaning-and-preparing-data.html#cb457-1" aria-hidden="true" tabindex="-1"></a>all_tables<span class="sc">$</span>age <span class="ot">&lt;-</span> <span class="fu">as_factor</span>(all_tables<span class="sc">$</span>age)</span></code></pre></div>
</div>
</div>
<div id="check" class="section level3" number="11.3.4">
<h3><span class="header-section-number">11.3.4</span> Check</h3>
<div id="gender-sum" class="section level4" number="11.3.4.1">
<h4><span class="header-section-number">11.3.4.1</span> Gender sum</h4>
<p>Given the format of the data, at this point it is easy to check that <code>total</code> is the sum of <code>male</code> and <code>female</code>.</p>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb458-1"><a href="cleaning-and-preparing-data.html#cb458-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check the parts and the sums</span></span>
<span id="cb458-2"><a href="cleaning-and-preparing-data.html#cb458-2" aria-hidden="true" tabindex="-1"></a>follow_up <span class="ot">&lt;-</span> </span>
<span id="cb458-3"><a href="cleaning-and-preparing-data.html#cb458-3" aria-hidden="true" tabindex="-1"></a>  all_tables <span class="sc">%&gt;%</span> </span>
<span id="cb458-4"><a href="cleaning-and-preparing-data.html#cb458-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">check_sum =</span> male <span class="sc">+</span> female,</span>
<span id="cb458-5"><a href="cleaning-and-preparing-data.html#cb458-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">totals_match =</span> <span class="fu">if_else</span>(total <span class="sc">==</span> check_sum, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb458-6"><a href="cleaning-and-preparing-data.html#cb458-6" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">%&gt;%</span> </span>
<span id="cb458-7"><a href="cleaning-and-preparing-data.html#cb458-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(totals_match <span class="sc">==</span> <span class="dv">0</span>)</span></code></pre></div>
<p>There is just one that seems wrong.</p>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb459-1"><a href="cleaning-and-preparing-data.html#cb459-1" aria-hidden="true" tabindex="-1"></a><span class="co"># There is just one that looks wrong</span></span>
<span id="cb459-2"><a href="cleaning-and-preparing-data.html#cb459-2" aria-hidden="true" tabindex="-1"></a>all_tables<span class="sc">$</span>male[all_tables<span class="sc">$</span>age <span class="sc">==</span> <span class="st">&quot;10&quot;</span> <span class="sc">&amp;</span> all_tables<span class="sc">$</span>page <span class="sc">==</span> <span class="dv">187</span>] <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="dv">1</span>)</span>
<span id="cb459-3"><a href="cleaning-and-preparing-data.html#cb459-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb459-4"><a href="cleaning-and-preparing-data.html#cb459-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(follow_up)</span></code></pre></div>
</div>
<div id="rural-urban-split" class="section level4" number="11.3.4.2">
<h4><span class="header-section-number">11.3.4.2</span> Rural-urban split</h4>
<p>The census provides different tables for the total of each county and sub-county; and then within each county, for the number in an urban area in that county, and the number in a urban area in that county. Some counties only have an urban count, but we’d like to make sure that the sum of rural and urban counts equals the total count. This requires reshaping the data from a long to wide format.</p>
<p>First, construct different tables for each of the three. I just do it manually, but I could probably do this a nicer way.</p>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb460-1"><a href="cleaning-and-preparing-data.html#cb460-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Table 2.3</span></span>
<span id="cb460-2"><a href="cleaning-and-preparing-data.html#cb460-2" aria-hidden="true" tabindex="-1"></a>table_2_3 <span class="ot">&lt;-</span> all_tables <span class="sc">%&gt;%</span> </span>
<span id="cb460-3"><a href="cleaning-and-preparing-data.html#cb460-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(table <span class="sc">==</span> <span class="st">&quot;Table 2.3: Distribution of Population by Age, Sex*, County and Sub- County&quot;</span>)</span>
<span id="cb460-4"><a href="cleaning-and-preparing-data.html#cb460-4" aria-hidden="true" tabindex="-1"></a>table_2_4a <span class="ot">&lt;-</span> all_tables <span class="sc">%&gt;%</span> </span>
<span id="cb460-5"><a href="cleaning-and-preparing-data.html#cb460-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(table <span class="sc">==</span> <span class="st">&quot;Table 2.4a: Distribution of Rural Population by Age, Sex* and County&quot;</span>)</span>
<span id="cb460-6"><a href="cleaning-and-preparing-data.html#cb460-6" aria-hidden="true" tabindex="-1"></a>table_2_4b <span class="ot">&lt;-</span> all_tables <span class="sc">%&gt;%</span> </span>
<span id="cb460-7"><a href="cleaning-and-preparing-data.html#cb460-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(table <span class="sc">==</span> <span class="st">&quot;Table 2.4b: Distribution of Urban Population by Age, Sex* and County&quot;</span>)</span></code></pre></div>
<p>Having constructed the constituent parts, I now join then based on age, area, and whether it is a county.</p>
<div class="sourceCode" id="cb461"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb461-1"><a href="cleaning-and-preparing-data.html#cb461-1" aria-hidden="true" tabindex="-1"></a>both_2_4s <span class="ot">&lt;-</span> <span class="fu">full_join</span>(table_2_4a, table_2_4b, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;age&quot;</span>, <span class="st">&quot;area&quot;</span>, <span class="st">&quot;area_type&quot;</span>), <span class="at">suffix =</span> <span class="fu">c</span>(<span class="st">&quot;_rural&quot;</span>, <span class="st">&quot;_urban&quot;</span>))</span>
<span id="cb461-2"><a href="cleaning-and-preparing-data.html#cb461-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb461-3"><a href="cleaning-and-preparing-data.html#cb461-3" aria-hidden="true" tabindex="-1"></a>all <span class="ot">&lt;-</span> <span class="fu">full_join</span>(table_2_3, both_2_4s, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;age&quot;</span>, <span class="st">&quot;area&quot;</span>, <span class="st">&quot;area_type&quot;</span>), <span class="at">suffix =</span> <span class="fu">c</span>(<span class="st">&quot;_all&quot;</span>, <span class="st">&quot;_&quot;</span>))</span>
<span id="cb461-4"><a href="cleaning-and-preparing-data.html#cb461-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb461-5"><a href="cleaning-and-preparing-data.html#cb461-5" aria-hidden="true" tabindex="-1"></a>all <span class="ot">&lt;-</span> </span>
<span id="cb461-6"><a href="cleaning-and-preparing-data.html#cb461-6" aria-hidden="true" tabindex="-1"></a>  all <span class="sc">%&gt;%</span> </span>
<span id="cb461-7"><a href="cleaning-and-preparing-data.html#cb461-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">page =</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;Total from p. {page}, rural from p. {page_rural}, urban from p. {page_urban}&#39;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb461-8"><a href="cleaning-and-preparing-data.html#cb461-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>page, <span class="sc">-</span>page_rural, <span class="sc">-</span>page_urban,</span>
<span id="cb461-9"><a href="cleaning-and-preparing-data.html#cb461-9" aria-hidden="true" tabindex="-1"></a>         <span class="sc">-</span>table, <span class="sc">-</span>table_rural, <span class="sc">-</span>table_urban,</span>
<span id="cb461-10"><a href="cleaning-and-preparing-data.html#cb461-10" aria-hidden="true" tabindex="-1"></a>         <span class="sc">-</span>age_type_rural, <span class="sc">-</span>age_type_urban</span>
<span id="cb461-11"><a href="cleaning-and-preparing-data.html#cb461-11" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb461-12"><a href="cleaning-and-preparing-data.html#cb461-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb461-13"><a href="cleaning-and-preparing-data.html#cb461-13" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(both_2_4s, table_2_3, table_2_4a, table_2_4b)</span></code></pre></div>
<p>We can now check that the sum of rural and urban is the same as the total.</p>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb462-1"><a href="cleaning-and-preparing-data.html#cb462-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check that the urban + rural = total</span></span>
<span id="cb462-2"><a href="cleaning-and-preparing-data.html#cb462-2" aria-hidden="true" tabindex="-1"></a>follow_up <span class="ot">&lt;-</span> </span>
<span id="cb462-3"><a href="cleaning-and-preparing-data.html#cb462-3" aria-hidden="true" tabindex="-1"></a>  all <span class="sc">%&gt;%</span> </span>
<span id="cb462-4"><a href="cleaning-and-preparing-data.html#cb462-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_from_bits =</span> total_rural <span class="sc">+</span> total_urban,</span>
<span id="cb462-5"><a href="cleaning-and-preparing-data.html#cb462-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">check_total_is_rural_plus_urban =</span> <span class="fu">if_else</span>(total <span class="sc">==</span> total_from_bits, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb462-6"><a href="cleaning-and-preparing-data.html#cb462-6" aria-hidden="true" tabindex="-1"></a>         total_from_bits <span class="sc">-</span> total) <span class="sc">%&gt;%</span> </span>
<span id="cb462-7"><a href="cleaning-and-preparing-data.html#cb462-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(check_total_is_rural_plus_urban <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb462-8"><a href="cleaning-and-preparing-data.html#cb462-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb462-9"><a href="cleaning-and-preparing-data.html#cb462-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(follow_up)</span></code></pre></div>
<pre><code>## # A tibble: 0 × 16
## # … with 16 variables: age &lt;fct&gt;, male &lt;int&gt;, female &lt;int&gt;, total &lt;int&gt;,
## #   area &lt;chr&gt;, area_type &lt;chr&gt;, age_type &lt;chr&gt;, male_rural &lt;int&gt;,
## #   female_rural &lt;int&gt;, total_rural &lt;int&gt;, male_urban &lt;int&gt;,
## #   female_urban &lt;int&gt;, total_urban &lt;int&gt;, total_from_bits &lt;int&gt;,
## #   check_total_is_rural_plus_urban &lt;dbl&gt;, total_from_bits - total &lt;int&gt;</code></pre>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb464-1"><a href="cleaning-and-preparing-data.html#cb464-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(follow_up)</span></code></pre></div>
<p>There are just a few, but they only have a difference of 1, so I’ll just move on.</p>
</div>
<div id="ages-sum-to-age-groups" class="section level4" number="11.3.4.3">
<h4><span class="header-section-number">11.3.4.3</span> Ages sum to age-groups</h4>
<p>Finally, I want to check that the single age counts sum to the age-groups.</p>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb465-1"><a href="cleaning-and-preparing-data.html#cb465-1" aria-hidden="true" tabindex="-1"></a><span class="co"># One last thing to check is that the ages sum to their age-groups.</span></span>
<span id="cb465-2"><a href="cleaning-and-preparing-data.html#cb465-2" aria-hidden="true" tabindex="-1"></a>follow_up <span class="ot">&lt;-</span> </span>
<span id="cb465-3"><a href="cleaning-and-preparing-data.html#cb465-3" aria-hidden="true" tabindex="-1"></a>  all <span class="sc">%&gt;%</span> </span>
<span id="cb465-4"><a href="cleaning-and-preparing-data.html#cb465-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">groups =</span> <span class="fu">case_when</span>(age <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;4&quot;</span>, <span class="st">&quot;0-4&quot;</span>) <span class="sc">~</span> <span class="st">&quot;0-4&quot;</span>,</span>
<span id="cb465-5"><a href="cleaning-and-preparing-data.html#cb465-5" aria-hidden="true" tabindex="-1"></a>                            age <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;5&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;7&quot;</span>, <span class="st">&quot;8&quot;</span>, <span class="st">&quot;9&quot;</span>, <span class="st">&quot;5-9&quot;</span>) <span class="sc">~</span> <span class="st">&quot;5-9&quot;</span>,</span>
<span id="cb465-6"><a href="cleaning-and-preparing-data.html#cb465-6" aria-hidden="true" tabindex="-1"></a>                            age <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;10&quot;</span>, <span class="st">&quot;11&quot;</span>, <span class="st">&quot;12&quot;</span>, <span class="st">&quot;13&quot;</span>, <span class="st">&quot;14&quot;</span>, <span class="st">&quot;10-14&quot;</span>) <span class="sc">~</span> <span class="st">&quot;10-14&quot;</span>,</span>
<span id="cb465-7"><a href="cleaning-and-preparing-data.html#cb465-7" aria-hidden="true" tabindex="-1"></a>                            age <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;15&quot;</span>, <span class="st">&quot;16&quot;</span>, <span class="st">&quot;17&quot;</span>, <span class="st">&quot;18&quot;</span>, <span class="st">&quot;19&quot;</span>, <span class="st">&quot;15-19&quot;</span>) <span class="sc">~</span> <span class="st">&quot;15-19&quot;</span>,</span>
<span id="cb465-8"><a href="cleaning-and-preparing-data.html#cb465-8" aria-hidden="true" tabindex="-1"></a>                            age <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;20&quot;</span>, <span class="st">&quot;21&quot;</span>, <span class="st">&quot;22&quot;</span>, <span class="st">&quot;23&quot;</span>, <span class="st">&quot;24&quot;</span>, <span class="st">&quot;20-24&quot;</span>) <span class="sc">~</span> <span class="st">&quot;20-24&quot;</span>,</span>
<span id="cb465-9"><a href="cleaning-and-preparing-data.html#cb465-9" aria-hidden="true" tabindex="-1"></a>                            age <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;25&quot;</span>, <span class="st">&quot;26&quot;</span>, <span class="st">&quot;27&quot;</span>, <span class="st">&quot;28&quot;</span>, <span class="st">&quot;29&quot;</span>, <span class="st">&quot;25-29&quot;</span>) <span class="sc">~</span> <span class="st">&quot;25-29&quot;</span>,</span>
<span id="cb465-10"><a href="cleaning-and-preparing-data.html#cb465-10" aria-hidden="true" tabindex="-1"></a>                            age <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;30&quot;</span>, <span class="st">&quot;31&quot;</span>, <span class="st">&quot;32&quot;</span>, <span class="st">&quot;33&quot;</span>, <span class="st">&quot;34&quot;</span>, <span class="st">&quot;30-34&quot;</span>) <span class="sc">~</span> <span class="st">&quot;30-34&quot;</span>,</span>
<span id="cb465-11"><a href="cleaning-and-preparing-data.html#cb465-11" aria-hidden="true" tabindex="-1"></a>                            age <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;35&quot;</span>, <span class="st">&quot;36&quot;</span>, <span class="st">&quot;37&quot;</span>, <span class="st">&quot;38&quot;</span>, <span class="st">&quot;39&quot;</span>, <span class="st">&quot;35-39&quot;</span>) <span class="sc">~</span> <span class="st">&quot;35-39&quot;</span>,</span>
<span id="cb465-12"><a href="cleaning-and-preparing-data.html#cb465-12" aria-hidden="true" tabindex="-1"></a>                            age <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;40&quot;</span>, <span class="st">&quot;41&quot;</span>, <span class="st">&quot;42&quot;</span>, <span class="st">&quot;43&quot;</span>, <span class="st">&quot;44&quot;</span>, <span class="st">&quot;40-44&quot;</span>) <span class="sc">~</span> <span class="st">&quot;40-44&quot;</span>,</span>
<span id="cb465-13"><a href="cleaning-and-preparing-data.html#cb465-13" aria-hidden="true" tabindex="-1"></a>                            age <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;45&quot;</span>, <span class="st">&quot;46&quot;</span>, <span class="st">&quot;47&quot;</span>, <span class="st">&quot;48&quot;</span>, <span class="st">&quot;49&quot;</span>, <span class="st">&quot;45-49&quot;</span>) <span class="sc">~</span> <span class="st">&quot;45-49&quot;</span>,</span>
<span id="cb465-14"><a href="cleaning-and-preparing-data.html#cb465-14" aria-hidden="true" tabindex="-1"></a>                            age <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;50&quot;</span>, <span class="st">&quot;51&quot;</span>, <span class="st">&quot;52&quot;</span>, <span class="st">&quot;53&quot;</span>, <span class="st">&quot;54&quot;</span>, <span class="st">&quot;50-54&quot;</span>) <span class="sc">~</span> <span class="st">&quot;50-54&quot;</span>,</span>
<span id="cb465-15"><a href="cleaning-and-preparing-data.html#cb465-15" aria-hidden="true" tabindex="-1"></a>                            age <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;55&quot;</span>, <span class="st">&quot;56&quot;</span>, <span class="st">&quot;57&quot;</span>, <span class="st">&quot;58&quot;</span>, <span class="st">&quot;59&quot;</span>, <span class="st">&quot;55-59&quot;</span>) <span class="sc">~</span> <span class="st">&quot;55-59&quot;</span>,</span>
<span id="cb465-16"><a href="cleaning-and-preparing-data.html#cb465-16" aria-hidden="true" tabindex="-1"></a>                            age <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;60&quot;</span>, <span class="st">&quot;61&quot;</span>, <span class="st">&quot;62&quot;</span>, <span class="st">&quot;63&quot;</span>, <span class="st">&quot;64&quot;</span>, <span class="st">&quot;60-64&quot;</span>) <span class="sc">~</span> <span class="st">&quot;60-64&quot;</span>,</span>
<span id="cb465-17"><a href="cleaning-and-preparing-data.html#cb465-17" aria-hidden="true" tabindex="-1"></a>                            age <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;65&quot;</span>, <span class="st">&quot;66&quot;</span>, <span class="st">&quot;67&quot;</span>, <span class="st">&quot;68&quot;</span>, <span class="st">&quot;69&quot;</span>, <span class="st">&quot;65-69&quot;</span>) <span class="sc">~</span> <span class="st">&quot;65-69&quot;</span>,</span>
<span id="cb465-18"><a href="cleaning-and-preparing-data.html#cb465-18" aria-hidden="true" tabindex="-1"></a>                            age <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;70&quot;</span>, <span class="st">&quot;71&quot;</span>, <span class="st">&quot;72&quot;</span>, <span class="st">&quot;73&quot;</span>, <span class="st">&quot;74&quot;</span>, <span class="st">&quot;70-74&quot;</span>) <span class="sc">~</span> <span class="st">&quot;70-74&quot;</span>,</span>
<span id="cb465-19"><a href="cleaning-and-preparing-data.html#cb465-19" aria-hidden="true" tabindex="-1"></a>                            age <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;75&quot;</span>, <span class="st">&quot;76&quot;</span>, <span class="st">&quot;77&quot;</span>, <span class="st">&quot;78&quot;</span>, <span class="st">&quot;79&quot;</span>, <span class="st">&quot;75-79&quot;</span>) <span class="sc">~</span> <span class="st">&quot;75-79&quot;</span>,</span>
<span id="cb465-20"><a href="cleaning-and-preparing-data.html#cb465-20" aria-hidden="true" tabindex="-1"></a>                            age <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;80&quot;</span>, <span class="st">&quot;81&quot;</span>, <span class="st">&quot;82&quot;</span>, <span class="st">&quot;83&quot;</span>, <span class="st">&quot;84&quot;</span>, <span class="st">&quot;80-84&quot;</span>) <span class="sc">~</span> <span class="st">&quot;80-84&quot;</span>,</span>
<span id="cb465-21"><a href="cleaning-and-preparing-data.html#cb465-21" aria-hidden="true" tabindex="-1"></a>                            age <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;85&quot;</span>, <span class="st">&quot;86&quot;</span>, <span class="st">&quot;87&quot;</span>, <span class="st">&quot;88&quot;</span>, <span class="st">&quot;89&quot;</span>, <span class="st">&quot;85-89&quot;</span>) <span class="sc">~</span> <span class="st">&quot;85-89&quot;</span>,</span>
<span id="cb465-22"><a href="cleaning-and-preparing-data.html#cb465-22" aria-hidden="true" tabindex="-1"></a>                            age <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;90&quot;</span>, <span class="st">&quot;91&quot;</span>, <span class="st">&quot;92&quot;</span>, <span class="st">&quot;93&quot;</span>, <span class="st">&quot;94&quot;</span>, <span class="st">&quot;90-94&quot;</span>) <span class="sc">~</span> <span class="st">&quot;90-94&quot;</span>,</span>
<span id="cb465-23"><a href="cleaning-and-preparing-data.html#cb465-23" aria-hidden="true" tabindex="-1"></a>                            age <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;95&quot;</span>, <span class="st">&quot;96&quot;</span>, <span class="st">&quot;97&quot;</span>, <span class="st">&quot;98&quot;</span>, <span class="st">&quot;99&quot;</span>, <span class="st">&quot;95-99&quot;</span>) <span class="sc">~</span> <span class="st">&quot;95-99&quot;</span>,</span>
<span id="cb465-24"><a href="cleaning-and-preparing-data.html#cb465-24" aria-hidden="true" tabindex="-1"></a>                            <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;Other&quot;</span>)</span>
<span id="cb465-25"><a href="cleaning-and-preparing-data.html#cb465-25" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">%&gt;%</span> </span>
<span id="cb465-26"><a href="cleaning-and-preparing-data.html#cb465-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(area_type, area, groups) <span class="sc">%&gt;%</span> </span>
<span id="cb465-27"><a href="cleaning-and-preparing-data.html#cb465-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group_sum =</span> <span class="fu">sum</span>(total, <span class="at">na.rm =</span> <span class="cn">FALSE</span>),</span>
<span id="cb465-28"><a href="cleaning-and-preparing-data.html#cb465-28" aria-hidden="true" tabindex="-1"></a>         <span class="at">group_sum =</span> group_sum <span class="sc">/</span> <span class="dv">2</span>,</span>
<span id="cb465-29"><a href="cleaning-and-preparing-data.html#cb465-29" aria-hidden="true" tabindex="-1"></a>         <span class="at">difference =</span> total <span class="sc">-</span> group_sum) <span class="sc">%&gt;%</span> </span>
<span id="cb465-30"><a href="cleaning-and-preparing-data.html#cb465-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb465-31"><a href="cleaning-and-preparing-data.html#cb465-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(age <span class="sc">==</span> groups) <span class="sc">%&gt;%</span> </span>
<span id="cb465-32"><a href="cleaning-and-preparing-data.html#cb465-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(total <span class="sc">!=</span> group_sum) </span>
<span id="cb465-33"><a href="cleaning-and-preparing-data.html#cb465-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb465-34"><a href="cleaning-and-preparing-data.html#cb465-34" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(follow_up)</span></code></pre></div>
<pre><code>## # A tibble: 0 × 16
## # … with 16 variables: age &lt;fct&gt;, male &lt;int&gt;, female &lt;int&gt;, total &lt;int&gt;,
## #   area &lt;chr&gt;, area_type &lt;chr&gt;, age_type &lt;chr&gt;, male_rural &lt;int&gt;,
## #   female_rural &lt;int&gt;, total_rural &lt;int&gt;, male_urban &lt;int&gt;,
## #   female_urban &lt;int&gt;, total_urban &lt;int&gt;, groups &lt;chr&gt;, group_sum &lt;dbl&gt;,
## #   difference &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb467"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb467-1"><a href="cleaning-and-preparing-data.html#cb467-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(follow_up)</span></code></pre></div>
<p>Mt. Kenya Forest, Aberdare Forest, Kakamega Forest are all slightly dodgy. I can’t see it in the documentation, but it looks like they have apportioned these between various countries. It’s understandable why they’d do this and it’s probably not a big deal, so I’ll just move on.</p>
</div>
</div>
<div id="tidy-up" class="section level3" number="11.3.5">
<h3><span class="header-section-number">11.3.5</span> Tidy-up</h3>
<p>Now that we are confident that everything is looking good, we can just convert it to long-format so that it is easy to work with.</p>
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb468-1"><a href="cleaning-and-preparing-data.html#cb468-1" aria-hidden="true" tabindex="-1"></a>all <span class="ot">&lt;-</span> </span>
<span id="cb468-2"><a href="cleaning-and-preparing-data.html#cb468-2" aria-hidden="true" tabindex="-1"></a>  all <span class="sc">%&gt;%</span> </span>
<span id="cb468-3"><a href="cleaning-and-preparing-data.html#cb468-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">male_total =</span> male,</span>
<span id="cb468-4"><a href="cleaning-and-preparing-data.html#cb468-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">female_total =</span> female,</span>
<span id="cb468-5"><a href="cleaning-and-preparing-data.html#cb468-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">total_total =</span> total) <span class="sc">%&gt;%</span> </span>
<span id="cb468-6"><a href="cleaning-and-preparing-data.html#cb468-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(male_total, female_total, total_total, male_rural, female_rural, total_rural, male_urban, female_urban, total_urban),</span>
<span id="cb468-7"><a href="cleaning-and-preparing-data.html#cb468-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;type&quot;</span>,</span>
<span id="cb468-8"><a href="cleaning-and-preparing-data.html#cb468-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;number&quot;</span></span>
<span id="cb468-9"><a href="cleaning-and-preparing-data.html#cb468-9" aria-hidden="true" tabindex="-1"></a>               ) <span class="sc">%&gt;%</span> </span>
<span id="cb468-10"><a href="cleaning-and-preparing-data.html#cb468-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(<span class="at">col =</span> type, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;gender&quot;</span>, <span class="st">&quot;part_of_area&quot;</span>), <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb468-11"><a href="cleaning-and-preparing-data.html#cb468-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(area, area_type, part_of_area, age, age_type, gender, number)</span>
<span id="cb468-12"><a href="cleaning-and-preparing-data.html#cb468-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb468-13"><a href="cleaning-and-preparing-data.html#cb468-13" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(all, <span class="at">path =</span> <span class="st">&quot;outputs/data/cleaned_kenya_2019_census.csv&quot;</span>)</span>
<span id="cb468-14"><a href="cleaning-and-preparing-data.html#cb468-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb468-15"><a href="cleaning-and-preparing-data.html#cb468-15" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(all)</span></code></pre></div>
<pre><code>## # A tibble: 0 × 7
## # … with 7 variables: area &lt;chr&gt;, area_type &lt;chr&gt;, part_of_area &lt;chr&gt;,
## #   age &lt;fct&gt;, age_type &lt;chr&gt;, gender &lt;chr&gt;, number &lt;int&gt;</code></pre>
</div>
<div id="make-monicas-dataset" class="section level3" number="11.3.6">
<h3><span class="header-section-number">11.3.6</span> Make Monica’s dataset</h3>
<p>The original purpose of all of this was to make a table for Monica. She needed single-year counts, by gender, for the counties.</p>
<div class="sourceCode" id="cb470"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb470-1"><a href="cleaning-and-preparing-data.html#cb470-1" aria-hidden="true" tabindex="-1"></a>monicas_dataset <span class="ot">&lt;-</span> </span>
<span id="cb470-2"><a href="cleaning-and-preparing-data.html#cb470-2" aria-hidden="true" tabindex="-1"></a>  all <span class="sc">%&gt;%</span> </span>
<span id="cb470-3"><a href="cleaning-and-preparing-data.html#cb470-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(area_type <span class="sc">==</span> <span class="st">&quot;county&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb470-4"><a href="cleaning-and-preparing-data.html#cb470-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(part_of_area <span class="sc">==</span> <span class="st">&quot;total&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb470-5"><a href="cleaning-and-preparing-data.html#cb470-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(age_type <span class="sc">==</span> <span class="st">&quot;single-year&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb470-6"><a href="cleaning-and-preparing-data.html#cb470-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(area, age, gender, number)</span>
<span id="cb470-7"><a href="cleaning-and-preparing-data.html#cb470-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb470-8"><a href="cleaning-and-preparing-data.html#cb470-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(monicas_dataset)</span></code></pre></div>
<pre><code>## # A tibble: 0 × 4
## # … with 4 variables: area &lt;chr&gt;, age &lt;fct&gt;, gender &lt;chr&gt;, number &lt;int&gt;</code></pre>
<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb472-1"><a href="cleaning-and-preparing-data.html#cb472-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(monicas_dataset, <span class="st">&quot;outputs/data/monicas_dataset.csv&quot;</span>)</span></code></pre></div>
<p>I’ll leave the fancy stats to Monica, but I’ll just make a quick graph of Nairobi.</p>
<div class="sourceCode" id="cb473"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb473-1"><a href="cleaning-and-preparing-data.html#cb473-1" aria-hidden="true" tabindex="-1"></a><span class="co"># monicas_dataset %&gt;% </span></span>
<span id="cb473-2"><a href="cleaning-and-preparing-data.html#cb473-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(area == &quot;Nairobi&quot;) %&gt;%</span></span>
<span id="cb473-3"><a href="cleaning-and-preparing-data.html#cb473-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot() +</span></span>
<span id="cb473-4"><a href="cleaning-and-preparing-data.html#cb473-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_col(aes(x = age, y = number, fill = gender), position = &quot;dodge&quot;) + </span></span>
<span id="cb473-5"><a href="cleaning-and-preparing-data.html#cb473-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_y_continuous(labels = scales::comma) +</span></span>
<span id="cb473-6"><a href="cleaning-and-preparing-data.html#cb473-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_x_discrete(breaks = c(seq(from = 0, to = 99, by = 5), &quot;100+&quot;)) +</span></span>
<span id="cb473-7"><a href="cleaning-and-preparing-data.html#cb473-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_classic()+</span></span>
<span id="cb473-8"><a href="cleaning-and-preparing-data.html#cb473-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_fill_brewer(palette = &quot;Set1&quot;) +</span></span>
<span id="cb473-9"><a href="cleaning-and-preparing-data.html#cb473-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(y = &quot;Number&quot;,</span></span>
<span id="cb473-10"><a href="cleaning-and-preparing-data.html#cb473-10" aria-hidden="true" tabindex="-1"></a><span class="co">#        x = &quot;Age&quot;,</span></span>
<span id="cb473-11"><a href="cleaning-and-preparing-data.html#cb473-11" aria-hidden="true" tabindex="-1"></a><span class="co">#        fill = &quot;Gender&quot;,</span></span>
<span id="cb473-12"><a href="cleaning-and-preparing-data.html#cb473-12" aria-hidden="true" tabindex="-1"></a><span class="co">#        title = &quot;Distribution of age and gender in Nairobi in 2019&quot;,</span></span>
<span id="cb473-13"><a href="cleaning-and-preparing-data.html#cb473-13" aria-hidden="true" tabindex="-1"></a><span class="co">#        caption = &quot;Data source: 2019 Kenya Census&quot;)</span></span></code></pre></div>
</div>
</div>
<div id="checks-and-tests" class="section level2" number="11.4">
<h2><span class="header-section-number">11.4</span> Checks and tests</h2>
<p>Robert Caro, the biographer of Lyndon Johnson, spent years tracking down everyone connected to the 36th President of the United States. He went to far as to live in Texas Hill Country for X years so that he could better understand where LBJ was from. When he heard a story that LBJ used to run to the Senate when he worked as a Y, he ran that route multiple times himself to try to understand why LBJ was running. Caro eventually understood it only when he ran the route as the sun was rising, just as LBJ had done, and found that at that time the sun hits the Senate Rotunda and it looks amazing (CITE). This background work enabled him to uncover aspects that no one else knew. For instance, it turns out that LBJ almost surely stole his first election win as a Texas Senator. You need to understand your data to this same extent. Turn every page and go to every extreme.</p>
<p>When we are cleaning data, we are looking for anomalies. We are interested in values that are in there that should not be, but also the opposite situation—values that are missing that should not be. I’ve I talked fairly generally about checks, tests and other considerations. Here I’d like to be more specific about what I mean. There are four tools that you should use to identify these situations: plots, counts, green/red conditions, targets.</p>
<div id="plots" class="section level3" number="11.4.1">
<h3><span class="header-section-number">11.4.1</span> Plots</h3>
<p>Plots are an invaluable tool when cleaning data, because they show each point in the dataset, in relation to the other points. They are especially useful for identifying when a value doesn’t belong. For instance, if a value is expected to be numerical, but it is still a character then it will not plot and a warning will be displayed.</p>
<p>Plots will be especially useful for numerical data, but are still useful for text and categorical data. Let’s pretend that we have a situation where we are interested in a person’s age, for some youth survey. We have the following data:</p>
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb474-1"><a href="cleaning-and-preparing-data.html#cb474-1" aria-hidden="true" tabindex="-1"></a>raw_data <span class="ot">&lt;-</span> </span>
<span id="cb474-2"><a href="cleaning-and-preparing-data.html#cb474-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">ages =</span> <span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">17</span>, <span class="dv">22</span>, <span class="dv">13</span>, <span class="dv">21</span>, <span class="dv">16</span>, <span class="dv">16</span>, <span class="dv">6</span>, <span class="dv">16</span>, <span class="dv">11</span>, <span class="dv">150</span>))</span>
<span id="cb474-3"><a href="cleaning-and-preparing-data.html#cb474-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb474-4"><a href="cleaning-and-preparing-data.html#cb474-4" aria-hidden="true" tabindex="-1"></a>raw_data <span class="sc">%&gt;%</span> </span>
<span id="cb474-5"><a href="cleaning-and-preparing-data.html#cb474-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> ages, <span class="at">x =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb474-6"><a href="cleaning-and-preparing-data.html#cb474-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="bookdown_files/figure-html/unnamed-chunk-270-1.png" width="672" /></p>
<p>The graph clearly shows the unexpected value of 150. The most likely explanation is that the data were incorrectly entered with a trailing 0, and should be 15.</p>
<p>We can fix that, and document it, and then redo the graph, so see that everything seems more reasonable now.</p>
</div>
<div id="counts" class="section level3" number="11.4.2">
<h3><span class="header-section-number">11.4.2</span> Counts</h3>
<p>We want to focus on getting most of the data right. So we are interested in the counts of unique values. Hopefully a majority of the data are concentrated in the most common counts. But it can also be useful to invert it, and see what is especially uncommon. The extent to which we want to deal with these depends on what we need. Ultimately, each time we fix one we are getting very few additional observations, potentially even just one! Counts are especially useful with text or categorical data, but can be helpful with numerical as well.</p>
<p>Let’s see an example.</p>
<div class="sourceCode" id="cb475"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb475-1"><a href="cleaning-and-preparing-data.html#cb475-1" aria-hidden="true" tabindex="-1"></a>raw_data <span class="ot">&lt;-</span> </span>
<span id="cb475-2"><a href="cleaning-and-preparing-data.html#cb475-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">country =</span> <span class="fu">c</span>(<span class="st">&#39;Australie&#39;</span>, <span class="st">&#39;Austrelia&#39;</span>, <span class="st">&#39;Australie&#39;</span>, <span class="st">&#39;Australie&#39;</span>, <span class="st">&#39;Aeustralia&#39;</span>, <span class="st">&#39;Austraia&#39;</span>, <span class="st">&#39;Australia&#39;</span>, <span class="st">&#39;Australia&#39;</span>, <span class="st">&#39;Australia&#39;</span>, <span class="st">&#39;Australia&#39;</span></span>
<span id="cb475-3"><a href="cleaning-and-preparing-data.html#cb475-3" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb475-4"><a href="cleaning-and-preparing-data.html#cb475-4" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb475-5"><a href="cleaning-and-preparing-data.html#cb475-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-6"><a href="cleaning-and-preparing-data.html#cb475-6" aria-hidden="true" tabindex="-1"></a>raw_data <span class="sc">%&gt;%</span> </span>
<span id="cb475-7"><a href="cleaning-and-preparing-data.html#cb475-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(country, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## # A tibble: 5 × 2
##   country        n
##   &lt;chr&gt;      &lt;int&gt;
## 1 Australia      4
## 2 Australie      3
## 3 Aeustralia     1
## 4 Austraia       1
## 5 Austrelia      1</code></pre>
<p>The use of this count clearly identifies where we should spend our time - changing ‘Australie’ to ‘Australia’ would almost double our amount of useable data.</p>
</div>
<div id="gono-go" class="section level3" number="11.4.3">
<h3><span class="header-section-number">11.4.3</span> Go/no-go</h3>
<p>Some things are so important that you require that your cleaned dataset have them. These are go/no-go conditions. They would typically come out of experience, expert knowledge, or the planning and simulation exercises. An example may be that there are no negative numbers in an age column, and no ages above 140.</p>
<p>For these we could specifically require that the condition is met. Other examples include:</p>
<ul>
<li>If doing cross-country analysis, then a list of country names that we know should be in our dataset would be useful. Our no-go conditions would then be if there were: 1) values not in that list in our dataset, or, vice versa; 2) countries that we expected to be in there that were not.</li>
</ul>
<p>To have a concrete example, let’s consider if we were doing some analysis about the five largest counties in Kenya: ‘Nairobi,’ ‘Kiambu,’ ‘Nakuru,’ ‘Kakamega,’ ‘Bungoma.’ Let’s create that array first:</p>
<div class="sourceCode" id="cb477"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb477-1"><a href="cleaning-and-preparing-data.html#cb477-1" aria-hidden="true" tabindex="-1"></a>correct_counties <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;Nairobi&#39;</span>, <span class="st">&#39;Kiambu&#39;</span>, <span class="st">&#39;Nakuru&#39;</span>, <span class="st">&#39;Kakamega&#39;</span>, <span class="st">&#39;Bungoma&#39;</span>)</span></code></pre></div>
<p>We begin with the following dataset:</p>
<div class="sourceCode" id="cb478"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb478-1"><a href="cleaning-and-preparing-data.html#cb478-1" aria-hidden="true" tabindex="-1"></a>top_five_kenya <span class="ot">&lt;-</span> </span>
<span id="cb478-2"><a href="cleaning-and-preparing-data.html#cb478-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">county =</span> <span class="fu">c</span>(<span class="st">&#39;Nairobi&#39;</span>, <span class="st">&#39;Nairob1&#39;</span>, <span class="st">&#39;Nakuru&#39;</span>, <span class="st">&#39;Kakamega&#39;</span>, <span class="st">&#39;Nakuru&#39;</span>, </span>
<span id="cb478-3"><a href="cleaning-and-preparing-data.html#cb478-3" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&#39;Kiambu&#39;</span>, <span class="st">&#39;Kiambru&#39;</span>, <span class="st">&#39;Kabamega&#39;</span>, <span class="st">&#39;Bun8oma&#39;</span>, <span class="st">&#39;Bungoma&#39;</span>)</span>
<span id="cb478-4"><a href="cleaning-and-preparing-data.html#cb478-4" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb478-5"><a href="cleaning-and-preparing-data.html#cb478-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb478-6"><a href="cleaning-and-preparing-data.html#cb478-6" aria-hidden="true" tabindex="-1"></a>top_five_kenya <span class="sc">%&gt;%</span> </span>
<span id="cb478-7"><a href="cleaning-and-preparing-data.html#cb478-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(county, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## # A tibble: 9 × 2
##   county       n
##   &lt;chr&gt;    &lt;int&gt;
## 1 Nakuru       2
## 2 Bun8oma      1
## 3 Bungoma      1
## 4 Kabamega     1
## 5 Kakamega     1
## 6 Kiambru      1
## 7 Kiambu       1
## 8 Nairob1      1
## 9 Nairobi      1</code></pre>
<p>Based on the count we know that we have to fix some of them and there are two with numbers that are obvious fixes:</p>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb480-1"><a href="cleaning-and-preparing-data.html#cb480-1" aria-hidden="true" tabindex="-1"></a>top_five_kenya <span class="ot">&lt;-</span> </span>
<span id="cb480-2"><a href="cleaning-and-preparing-data.html#cb480-2" aria-hidden="true" tabindex="-1"></a>  top_five_kenya <span class="sc">%&gt;%</span> </span>
<span id="cb480-3"><a href="cleaning-and-preparing-data.html#cb480-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">county =</span> <span class="fu">str_replace_all</span>(county, <span class="st">&#39;Nairob1&#39;</span>, <span class="st">&#39;Nairobi&#39;</span>),</span>
<span id="cb480-4"><a href="cleaning-and-preparing-data.html#cb480-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">county =</span> <span class="fu">str_replace_all</span>(county, <span class="st">&#39;Bun8oma&#39;</span>, <span class="st">&#39;Nairobi&#39;</span>)</span>
<span id="cb480-5"><a href="cleaning-and-preparing-data.html#cb480-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb480-6"><a href="cleaning-and-preparing-data.html#cb480-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb480-7"><a href="cleaning-and-preparing-data.html#cb480-7" aria-hidden="true" tabindex="-1"></a>top_five_kenya <span class="sc">%&gt;%</span> </span>
<span id="cb480-8"><a href="cleaning-and-preparing-data.html#cb480-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(county, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## # A tibble: 7 × 2
##   county       n
##   &lt;chr&gt;    &lt;int&gt;
## 1 Nairobi      3
## 2 Nakuru       2
## 3 Bungoma      1
## 4 Kabamega     1
## 5 Kakamega     1
## 6 Kiambru      1
## 7 Kiambu       1</code></pre>
<p>At this point we can use our go/no-go conditions to decide whether we are finished or not.</p>
<div class="sourceCode" id="cb482"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb482-1"><a href="cleaning-and-preparing-data.html#cb482-1" aria-hidden="true" tabindex="-1"></a>top_five_kenya<span class="sc">$</span>county <span class="sc">%&gt;%</span> <span class="fu">unique</span>()</span></code></pre></div>
<pre><code>## [1] &quot;Nairobi&quot;  &quot;Nakuru&quot;   &quot;Kakamega&quot; &quot;Kiambu&quot;   &quot;Kiambru&quot;  &quot;Kabamega&quot; &quot;Bungoma&quot;</code></pre>
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb484-1"><a href="cleaning-and-preparing-data.html#cb484-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">all</span>(top_five_kenya<span class="sc">$</span>county <span class="sc">%&gt;%</span> <span class="fu">unique</span>() <span class="sc">==</span> top_five_kenya)) {</span>
<span id="cb484-2"><a href="cleaning-and-preparing-data.html#cb484-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Oh no&quot;</span></span>
<span id="cb484-3"><a href="cleaning-and-preparing-data.html#cb484-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb484-4"><a href="cleaning-and-preparing-data.html#cb484-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">all</span>(top_five_kenya<span class="sc">==</span>top_five_kenya<span class="sc">$</span>county <span class="sc">%&gt;%</span> <span class="fu">unique</span>()) ) {</span>
<span id="cb484-5"><a href="cleaning-and-preparing-data.html#cb484-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Oh no&quot;</span></span>
<span id="cb484-6"><a href="cleaning-and-preparing-data.html#cb484-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>And so it is clear that we still have cleaning to do!</p>
<p>We may also find similar conditions from experts and those with experience in the particular field.</p>
<!-- ### Targets -->
<!-- We could clean data indefinitely, but we need an end state. Part of this is sketching an end-point, and simulating. But sometimes it helps to have a metric. This may be especially the case when we have a large dataset, a deadline, and a team, because the data cleaning stage is just one part of what needs to happen. One helpful aspect is to set targets against which we can judge a dataset and then just achieve those. -->
<!-- Let's turn to a common use-case which is merging two datasets. Of particular interest is the unique key between the two, which is  -->
<!-- Add in the notion of precision and recall. Maybe have a look at: -->
<!-- https://arxiv.org/pdf/2101.05308.pdf -->
<!-- ### Consistency -->
<!-- Consistency refers to the proportion -->
<!-- #### Internal consistency -->
<!-- #### External consistency -->
</div>
<div id="class-1" class="section level3" number="11.4.4">
<h3><span class="header-section-number">11.4.4</span> Class</h3>
<p>I can’t emphasize this enough, but it is vital that you put in place explicit checks of class because getting this wrong can have a large effect on your analysis. In particular:</p>
<ul>
<li>check whether some value should be a number or a factor.</li>
<li>check that dates are correctly formatted.</li>
</ul>
<p>To understand why it is important to be clear about whether a value is a number or a factor, consider the following situation:</p>
<div class="sourceCode" id="cb485"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb485-1"><a href="cleaning-and-preparing-data.html#cb485-1" aria-hidden="true" tabindex="-1"></a>some_data <span class="ot">&lt;-</span> </span>
<span id="cb485-2"><a href="cleaning-and-preparing-data.html#cb485-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">response =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb485-3"><a href="cleaning-and-preparing-data.html#cb485-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">group =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>))</span></code></pre></div>
<p>Let’s start with <code>group</code> as an integer and look at a logistic regression.</p>
<div class="sourceCode" id="cb486"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb486-1"><a href="cleaning-and-preparing-data.html#cb486-1" aria-hidden="true" tabindex="-1"></a>some_data <span class="sc">%&gt;%</span> </span>
<span id="cb486-2"><a href="cleaning-and-preparing-data.html#cb486-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">as.integer</span>(group)) <span class="sc">%&gt;%</span> </span>
<span id="cb486-3"><a href="cleaning-and-preparing-data.html#cb486-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(response<span class="sc">~</span>group, <span class="at">data =</span> .) <span class="sc">%&gt;%</span> </span>
<span id="cb486-4"><a href="cleaning-and-preparing-data.html#cb486-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = response ~ group, data = .)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
##  -0.68  -0.52   0.32   0.32   0.64 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)    0.840      0.450    1.87     0.10
## group         -0.160      0.231   -0.69     0.51
## 
## Residual standard error: 0.545 on 7 degrees of freedom
## Multiple R-squared:  0.064,  Adjusted R-squared:  -0.0697 
## F-statistic: 0.479 on 1 and 7 DF,  p-value: 0.511</code></pre>
<p>Now we can try it as a factor. The intepretation of the variable is completely different.</p>
<div class="sourceCode" id="cb488"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb488-1"><a href="cleaning-and-preparing-data.html#cb488-1" aria-hidden="true" tabindex="-1"></a>some_data <span class="sc">%&gt;%</span> </span>
<span id="cb488-2"><a href="cleaning-and-preparing-data.html#cb488-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">as.factor</span>(group)) <span class="sc">%&gt;%</span> </span>
<span id="cb488-3"><a href="cleaning-and-preparing-data.html#cb488-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(response<span class="sc">~</span>group, <span class="at">data =</span> .) <span class="sc">%&gt;%</span> </span>
<span id="cb488-4"><a href="cleaning-and-preparing-data.html#cb488-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = response ~ group, data = .)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -0.750 -0.333  0.250  0.250  0.667 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)    0.750      0.283    2.65    0.038 *
## group2        -0.417      0.432   -0.97    0.372  
## group3        -0.250      0.489   -0.51    0.628  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.565 on 6 degrees of freedom
## Multiple R-squared:  0.138,  Adjusted R-squared:  -0.15 
## F-statistic: 0.478 on 2 and 6 DF,  p-value: 0.642</code></pre>
<p>Another critical aspect is to check the dates. In particular we want to try to make it into the following format: YYYY-MM-DD. There are of course differences of opinion as to what is an appropriate date format in the broader world, and reasonable people can differ on whether 1 July 2010 or July 1, 2020, is better, but YYYY-MM-DD is the format that is generally most appropriate for data.</p>
</div>
</div>
<div id="naming-things" class="section level2" number="11.5">
<h2><span class="header-section-number">11.5</span> Naming things</h2>
<p>Names matter. I wrote this book on land that is today named Toronto, which is within a country named Canada, but for a long time before was known as Turtle Island. While not common, these days people will sometimes still refer to themselves as being on Turtle Island. That tells us something about them, and our use of the name Canada tells them something about us. There is a big rock in the centre of the country that I’m from, Australia. For a long time, it was called Uluru, then it was known as Ayers Rock. Today it has a dual name the combines both, and the choice of which name you use tells someone something about you. Even the British Royal Family recognise the power of names. In 1917 they changed from the House of Saxe-Coburg and Gotha to the House of Windsor, due to a feeling that the former was too Germanic given World War I was ongoing. Names matter in everyday life. And they matter in data science too.</p>
<p>The importance of names, and of ignoring existing claims through re-naming was clear in those cases, but we see it in data science as well. We need to be very careful when we name our datasets, our variables, and our functions. There is a tendency, these days, to call the variable ‘gender’ even though it may only have male and female, because we do not want to say the word ‘sex.’ <span class="citation">(<a href="#ref-tukey1962future" role="doc-biblioref">Tukey 1962</a>)</span> essentially defines what we today call data science, but it was popularised by folks in computer science in the 2010s who ignored, either deliberately or through ignorance, what came before them. The past ten years has been characteristic by the renaming of concepts that were well-established in the fields that computer science has recently expanded into. For instance, the use of binary variables in regression, sometimes called ‘dummy variables,’ is called one-hot encoding in computer science. Like all fashions, this one will pass also. We most recently saw this through the 1980s through to early 2010s with economics. Economists described themselves as the ‘queen of the social sciences’ and self-described as imperialistic <span class="citation">(<a href="#ref-lazear2000economic" role="doc-biblioref">Lazear 2000</a>)</span>. We are now recognising the costs of this imperialism in social sciences, and in the future we will look back and count the cost of computer science imperialism in data science. The key here is that no area of study is ever <em>terra nullius</em>, or nobody’s land. It is important to recognise, adopt, and use existing names, and practices.</p>
<p>Names give places meaning, and by ignoring existing names, we ignore what has come before us. <span class="citation"><a href="#ref-kimmerer2013" role="doc-biblioref">Kimmerer</a> (<a href="#ref-kimmerer2013" role="doc-biblioref">2012, 34</a>)</span> describes how ‘Tahawus is the Algonquin name for Mount Marcy, the highest peak in the Adirondacks. It’s called Mount March to commemorate a governor who never set foot on those wild slopes.’ She continues that ‘[w]hen we call a place by name it is transformed from wilderness to homeland.’ She is talking with regard to physical places, but the same is true of our function names, our variable names and our dataset names. When we use gender instead of sex because we don’t want to say sex in front of others, we ignore the preferences of those that provided data.</p>
<p>In addition to respecting the nature of the data, names need to satisfy two additional considerations: 1) they need to be machine readable, and 2) they need to be human readable.</p>
<p>Machine readable names is an easier standard to meet, but usually means avoiding spaces and special characters. A space can be replaced with a underbar. Usually, special characters should just be removed because they can be inconsistent between different computers and languages. The names should also be unique within a dataset, and unique within a collection of datasets unless that particular column is being deliberately used as a key to join different datasets.</p>
<p>An especially useful function to use to get closer to machine readable names is <code>janitor::clean_names()</code> which is from the <code>janitor</code> package <span class="citation">(<a href="#ref-janitor" role="doc-biblioref">Firke 2020</a>)</span>. This deals with those issues mentioned above as well as a few others. We can see an example.</p>
<div class="sourceCode" id="cb490"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb490-1"><a href="cleaning-and-preparing-data.html#cb490-1" aria-hidden="true" tabindex="-1"></a>bad_names_good_names <span class="ot">&lt;-</span> </span>
<span id="cb490-2"><a href="cleaning-and-preparing-data.html#cb490-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb490-3"><a href="cleaning-and-preparing-data.html#cb490-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;First&#39;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>),</span>
<span id="cb490-4"><a href="cleaning-and-preparing-data.html#cb490-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;second name has spaces&#39;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>),</span>
<span id="cb490-5"><a href="cleaning-and-preparing-data.html#cb490-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;weird#symbol&#39;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>),</span>
<span id="cb490-6"><a href="cleaning-and-preparing-data.html#cb490-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;InCoNsIsTaNtCaPs&#39;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>)</span>
<span id="cb490-7"><a href="cleaning-and-preparing-data.html#cb490-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb490-8"><a href="cleaning-and-preparing-data.html#cb490-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb490-9"><a href="cleaning-and-preparing-data.html#cb490-9" aria-hidden="true" tabindex="-1"></a>bad_names_good_names</span></code></pre></div>
<pre><code>## # A tibble: 1 × 4
##   First `second name has spaces` `weird#symbol` InCoNsIsTaNtCaPs
##   &lt;dbl&gt;                    &lt;dbl&gt;          &lt;dbl&gt;            &lt;dbl&gt;
## 1     1                        1              1                1</code></pre>
<div class="sourceCode" id="cb492"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb492-1"><a href="cleaning-and-preparing-data.html#cb492-1" aria-hidden="true" tabindex="-1"></a>bad_names_good_names <span class="ot">&lt;-</span> </span>
<span id="cb492-2"><a href="cleaning-and-preparing-data.html#cb492-2" aria-hidden="true" tabindex="-1"></a>  bad_names_good_names <span class="sc">%&gt;%</span> </span>
<span id="cb492-3"><a href="cleaning-and-preparing-data.html#cb492-3" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>()</span>
<span id="cb492-4"><a href="cleaning-and-preparing-data.html#cb492-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb492-5"><a href="cleaning-and-preparing-data.html#cb492-5" aria-hidden="true" tabindex="-1"></a>bad_names_good_names</span></code></pre></div>
<pre><code>## # A tibble: 1 × 4
##   first second_name_has_spaces weird_number_symbol in_co_ns_is_ta_nt_ca_ps
##   &lt;dbl&gt;                  &lt;dbl&gt;               &lt;dbl&gt;                   &lt;dbl&gt;
## 1     1                      1                   1                       1</code></pre>
<p>Human readable names require an additional layer! You need to consider other cultures and how they may interpret some of the names that you’re using. You also need to consider different experience levels that subsequent users of your dataset may have. This is both in terms of experience with programming and statistics, but also experience with similar datasets. For instance, a column of ‘flag’ is often used to signal that a column contains data that needs to be followed up with or treated carefully in some way. An experienced analyst will know this, but a beginner will not. Try to use meaningful names wherever possible <span class="citation">(<a href="#ref-lin2020ten" role="doc-biblioref">Lin, Ali, and Wilson 2020</a>)</span>.</p>
<p>One interesting feature of R is that in certain cases partial matching on names is possible. For instance:</p>
<div class="sourceCode" id="cb494"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb494-1"><a href="cleaning-and-preparing-data.html#cb494-1" aria-hidden="true" tabindex="-1"></a>never_use_partial_matching <span class="ot">&lt;-</span> </span>
<span id="cb494-2"><a href="cleaning-and-preparing-data.html#cb494-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb494-3"><a href="cleaning-and-preparing-data.html#cb494-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">my_first_name =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb494-4"><a href="cleaning-and-preparing-data.html#cb494-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">another_name =</span> <span class="fu">c</span>(<span class="st">&quot;wow&quot;</span>, <span class="st">&quot;great&quot;</span>)</span>
<span id="cb494-5"><a href="cleaning-and-preparing-data.html#cb494-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb494-6"><a href="cleaning-and-preparing-data.html#cb494-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb494-7"><a href="cleaning-and-preparing-data.html#cb494-7" aria-hidden="true" tabindex="-1"></a>never_use_partial_matching<span class="sc">$</span>my_first_name</span></code></pre></div>
<pre><code>## [1] 1 2</code></pre>
<div class="sourceCode" id="cb496"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb496-1"><a href="cleaning-and-preparing-data.html#cb496-1" aria-hidden="true" tabindex="-1"></a>never_use_partial_matching<span class="sc">$</span>my</span></code></pre></div>
<pre><code>## [1] 1 2</code></pre>
<p>This behaviour is not possible within the <code>tidyverse</code> (for instance if <code>data.frame</code> were replaced with <code>tibble</code> in the above code) and I recommend never using this feature. It makes it more difficult to understand your code after a break, and for others to come to it fresh.</p>
<!-- ## Pipelines -->
<!-- Following @suresh2020framework -->
</div>
<div id="exercises-and-tutorial-10" class="section level2" number="11.6">
<h2><span class="header-section-number">11.6</span> Exercises and tutorial</h2>
<div id="exercises-10" class="section level3" number="11.6.1">
<h3><span class="header-section-number">11.6.1</span> Exercises</h3>
<ol style="list-style-type: decimal">
<li>Is the following an example of tidy data?</li>
</ol>
<div class="sourceCode" id="cb498"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb498-1"><a href="cleaning-and-preparing-data.html#cb498-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">name =</span> <span class="fu">c</span>(<span class="st">&#39;Anne&#39;</span>, <span class="st">&#39;Bethany&#39;</span>, <span class="st">&#39;Stephen&#39;</span>, <span class="st">&#39;William&#39;</span>),</span>
<span id="cb498-2"><a href="cleaning-and-preparing-data.html#cb498-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">age_group =</span> <span class="fu">c</span>(<span class="st">&#39;18-29&#39;</span>, <span class="st">&#39;30-44&#39;</span>, <span class="st">&#39;45-60&#39;</span>, <span class="st">&#39;60+&#39;</span>),</span>
<span id="cb498-3"><a href="cleaning-and-preparing-data.html#cb498-3" aria-hidden="true" tabindex="-1"></a>       )</span></code></pre></div>
<pre><code>## # A tibble: 4 × 2
##   name    age_group
##   &lt;chr&gt;   &lt;chr&gt;    
## 1 Anne    18-29    
## 2 Bethany 30-44    
## 3 Stephen 45-60    
## 4 William 60+</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>If I am dealing with ages then what is the most likely class for the variable? [Select all that apply.]
<ol style="list-style-type: lower-alpha">
<li>integer</li>
<li>matrix</li>
<li>numeric</li>
<li>factor</li>
</ol></li>
</ol>
</div>
<div id="tutorial-10" class="section level3" number="11.6.2">
<h3><span class="header-section-number">11.6.2</span> Tutorial</h3>
<p>With regard to <span class="citation"><a href="#ref-Jordan2019Artificial" role="doc-biblioref">Jordan</a> (<a href="#ref-Jordan2019Artificial" role="doc-biblioref">2019</a>)</span>, <span class="citation"><a href="#ref-datafeminism2020" role="doc-biblioref">D’Ignazio and Klein</a> (<a href="#ref-datafeminism2020" role="doc-biblioref">2020</a>)</span>, Chapter 6, <span class="citation"><a href="#ref-thatrandyauperson" role="doc-biblioref">Au</a> (<a href="#ref-thatrandyauperson" role="doc-biblioref">2020</a>)</span>, and other relevant work, to what extent do you think we should let the data speak for themselves? [Please write a page or two.]</p>

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-thatrandyauperson" class="csl-entry">
Au, Randy. 2020. <span>“Data Cleaning IS Analysis, Not Grunt Work.”</span> Counting Stuff. <a href="https://counting.substack.com/p/data-cleaning-is-analysis-not-grunt">https://counting.substack.com/p/data-cleaning-is-analysis-not-grunt</a>.
</div>
<div id="ref-cohn2016" class="csl-entry">
Cohn, Nate. 2016. <em>We Gave Four Good Pollsters the Same Raw Data. They Had Four Different Results</em>.
</div>
<div id="ref-craiu2019hiring" class="csl-entry">
Craiu, Radu V. 2019. <span>“The Hiring Gambit: In Search of the Twofer Data Scientist.”</span> <em>Harvard Data Science Review</em> 1 (1).
</div>
<div id="ref-datafeminism2020" class="csl-entry">
D’Ignazio, Catherine, and Lauren F Klein. 2020. <em>Data Feminism</em>. Mit Press.
</div>
<div id="ref-euller1997data" class="csl-entry">
Euller, Roald, Stephen H Long, and M Susan Marquis. 1997. <span>“<span class="nocase">Data Cleaning Procedures for the 1993 Robert Wood Johnson Foundation Employer Health Insurance Survey</span>.”</span> RAND CORP SANTA MONICA CA.
</div>
<div id="ref-janitor" class="csl-entry">
Firke, Sam. 2020. <em>Janitor: Simple Tools for Examining and Cleaning Dirty Data</em>. <a href="https://CRAN.R-project.org/package=janitor">https://CRAN.R-project.org/package=janitor</a>.
</div>
<div id="ref-stringi" class="csl-entry">
Gagolewski, Marek. 2020. <em>R Package Stringi: Character String Processing Facilities</em>. <a href="http://www.gagolewski.com/software/stringi/">http://www.gagolewski.com/software/stringi/</a>.
</div>
<div id="ref-gelman2013garden" class="csl-entry">
Gelman, Andrew, and Eric Loken. 2013. <span>“The Garden of Forking Paths: Why Multiple Comparisons Can Be a Problem, Even When There Is No <span>‘Fishing Expedition’</span> or <span>‘p-Hacking’</span> and the Research Hypothesis Was Posited Ahead of Time.”</span> <em>Department of Statistics, Columbia University</em> 348.
</div>
<div id="ref-gelman2020most" class="csl-entry">
Gelman, Andrew, and Aki Vehtari. 2020. <span>“What Are the Most Important Statistical Ideas of the Past 50 Years?”</span> <em>arXiv Preprint arXiv:2012.00174</em>.
</div>
<div id="ref-halberstam" class="csl-entry">
Halberstam, David. 1972. <em><span class="nocase">The Best and the Brightest</span></em>. Random House.
</div>
<div id="ref-huntington2020influence" class="csl-entry">
Huntington-Klein, Nick, Andreu Arenas, Emily Beam, Marco Bertoni, Jeffrey Bloem, Pralhad H Burli, Naibin Chen, et al. 2020. <span>“The Influence of Hidden Researcher Decisions in Applied Microeconomics.”</span>
</div>
<div id="ref-ilyas2019data" class="csl-entry">
Ilyas, Ihab F, and Xu Chu. 2019. <em>Data Cleaning</em>. Morgan &amp; Claypool.
</div>
<div id="ref-Jordan2019Artificial" class="csl-entry">
Jordan, Michael I. 2019. <span>“Artificial Intelligence—the Revolution Hasn’t Happened Yet.”</span> <em>Harvard Data Science Review</em> 1 (1). <a href="https://doi.org/10.1162/99608f92.f06c6e61">https://doi.org/10.1162/99608f92.f06c6e61</a>.
</div>
<div id="ref-kimmerer2013" class="csl-entry">
Kimmerer, Robin Wall. 2012. <em>Braiding Sweetgrass</em>. Milkweed Editions.
</div>
<div id="ref-lazear2000economic" class="csl-entry">
Lazear, Edward P. 2000. <span>“Economic Imperialism.”</span> <em>The Quarterly Journal of Economics</em> 115 (1): 99–146.
</div>
<div id="ref-lin2020ten" class="csl-entry">
Lin, Sarah, Ibraheem Ali, and Greg Wilson. 2020. <span>“Ten Quick Tips for Making Things Findable.”</span> <em>PLoS Computational Biology</em> 16 (12): e1008469.
</div>
<div id="ref-meng2018statistical" class="csl-entry">
Meng, Xiao-Li. 2018. <span>“Statistical Paradises and Paradoxes in Big Data (i): Law of Large Populations, Big Data Paradox, and the 2016 US Presidential Election.”</span> <em>The Annals of Applied Statistics</em> 12 (2): 685–726.
</div>
<div id="ref-pdftools" class="csl-entry">
———. 2019b. <em>Pdftools: Text Extraction, Rendering and Converting of PDF Documents</em>. <a href="https://CRAN.R-project.org/package=pdftools">https://CRAN.R-project.org/package=pdftools</a>.
</div>
<div id="ref-silberzahn2018many" class="csl-entry">
Silberzahn, Raphael, Eric L Uhlmann, Daniel P Martin, Pasquale Anselmi, Frederik Aust, Eli Awtrey, Štěpán Bahnı́k, et al. 2018. <span>“Many Analysts, One Data Set: Making Transparent How Variations in Analytic Choices Affect Results.”</span> <em>Advances in Methods and Practices in Psychological Science</em> 1 (3): 337–56.
</div>
<div id="ref-tukey1962future" class="csl-entry">
Tukey, John W. 1962. <span>“The Future of Data Analysis.”</span> <em>The Annals of Mathematical Statistics</em> 33 (1): 1–67.
</div>
<div id="ref-van2005data" class="csl-entry">
Van den Broeck, Jan, Solveig Argeseanu Cunningham, Roger Eeckels, and Kobus Herbst. 2005. <span>“Data Cleaning: Detecting, Diagnosing, and Editing Data Abnormalities.”</span> <em>PLoS Medicine</em> 2 (10): e267.
</div>
<div id="ref-wickham2014tidy" class="csl-entry">
———. 2014. <span>“Tidy Data.”</span> <em>Journal of Statistical Software</em> 59 (1): 1–23.
</div>
<div id="ref-citestringr" class="csl-entry">
———. 2019e. <em>Stringr: Simple, Consistent Wrappers for Common String Operations</em>. <a href="https://CRAN.R-project.org/package=stringr">https://CRAN.R-project.org/package=stringr</a>.
</div>
<div id="ref-citetidyr" class="csl-entry">
———. 2021. <em>Tidyr: Tidy Messy Data</em>. <a href="https://CRAN.R-project.org/package=tidyr">https://CRAN.R-project.org/package=tidyr</a>.
</div>
<div id="ref-tidyverse" class="csl-entry">
———, et al. 2019a. <span>“Welcome to the <span class="nocase">tidyverse</span>.”</span> <em>Journal of Open Source Software</em> 4 (43): 1686. <a href="https://doi.org/10.21105/joss.01686">https://doi.org/10.21105/joss.01686</a>.
</div>
<div id="ref-r4ds" class="csl-entry">
Wickham, Hadley, and Garrett Grolemund. 2017. <em>R for Data Science</em>. <a href="https://r4ds.had.co.nz/">https://r4ds.had.co.nz/</a>.
</div>
<div id="ref-buildingsoftwaretogether" class="csl-entry">
Wilson, Greg. 2021. <em>Building Software Together</em>. CRC Books.
</div>
<div id="ref-wilsongoodenough" class="csl-entry">
Wilson, Jennifer AND Cranston, Greg AND Bryan. 2017. <span>“Good Enough Practices in Scientific Computing.”</span> <em>PLOS Computational Biology</em> 13 (6): 1–20. <a href="https://doi.org/10.1371/journal.pcbi.1005510">https://doi.org/10.1371/journal.pcbi.1005510</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="farm-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="storing-and-retrieving-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/lunr.js"></script>
<script src="libs/gitbook/js/clipboard.min.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script src="libs/gitbook/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown.pdf"],
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
