<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 2 Drinking from a fire hose | Telling Stories With Data</title>
<meta name="author" content="Rohan Alexander">
<meta name="description" content="Required material Read Data science as an atomic habit, (Barrett 2021a) Read This is how AI bias really happens—and why it’s so hard to fix, (Hao 2019) Read The mundanity of excellence: An...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="Chapter 2 Drinking from a fire hose | Telling Stories With Data">
<meta property="og:type" content="book">
<meta property="og:image" content="/tellingstorieswithdatapainting.png">
<meta property="og:description" content="Required material Read Data science as an atomic habit, (Barrett 2021a) Read This is how AI bias really happens—and why it’s so hard to fix, (Hao 2019) Read The mundanity of excellence: An...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 2 Drinking from a fire hose | Telling Stories With Data">
<meta name="twitter:description" content="Required material Read Data science as an atomic habit, (Barrett 2021a) Read This is how AI bias really happens—and why it’s so hard to fix, (Hao 2019) Read The mundanity of excellence: An...">
<meta name="twitter:image" content="/tellingstorieswithdatapainting.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.11/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><link href="libs/_Atkinson%20Hyperlegible-0.4.0/font.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=IBM%20Plex%20Mono&amp;display=swap" rel="stylesheet">
<script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script><link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="libs/leaflet-1.3.1/leaflet.js"></script><link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="libs/proj4-2.6.2/proj4.min.js"></script><script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script><script src="libs/mapdeck-binding-0.3.4/mapdeck.js"></script><script src="libs/mpadeck_functions-0.0.1/mapdeck_functions.js"></script><script src="libs/deckgl-8.1.6/deckgl.min.js"></script><script src="libs/legend-0.0.1/legend.js"></script><script src="libs/title-0.0.1/title.js"></script><script src="libs/mapdeck_location-0.0.1/mapdeck_location.js"></script><script src="libs/mapdeck_colours-0.0.1/mapdeck_colours.js"></script><script src="libs/mapdeck_coordinates-0.0.1/mapdeck_coordinates.js"></script><link href="libs/mapboxgl-1.10.0/mapbox-gl.css" rel="stylesheet">
<script src="libs/mapboxgl-1.10.0/mapbox-gl.js"></script><link href="libs/mapdeck-0.0.1/mapdeck.css" rel="stylesheet">
<script src="libs/mpadeck-binding-0.3.4/mapdeck.js"></script><script src="libs/scatterplot-1.0.0/scatterplot.js"></script><script src="libs/viz-1.8.2/viz.js"></script><link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="bs4_style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Telling Stories With Data</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Preface</a></li>
<li><a class="" href="about-the-author.html">About the author</a></li>
<li class="book-part">Foundations</li>
<li><a class="" href="telling-stories-with-data.html"><span class="header-section-number">1</span> Telling stories with data</a></li>
<li><a class="active" href="drinking-from-a-fire-hose.html"><span class="header-section-number">2</span> Drinking from a fire hose</a></li>
<li><a class="" href="r-essentials.html"><span class="header-section-number">3</span> R essentials</a></li>
<li><a class="" href="reproducible-workflows.html"><span class="header-section-number">4</span> Reproducible workflows</a></li>
<li class="book-part">Communication</li>
<li><a class="" href="on-writing.html"><span class="header-section-number">5</span> On writing</a></li>
<li><a class="" href="static-communication.html"><span class="header-section-number">6</span> Static communication</a></li>
<li><a class="" href="interactive-communication.html"><span class="header-section-number">7</span> Interactive communication</a></li>
<li class="book-part">Acquisition</li>
<li><a class="" href="gather-data.html"><span class="header-section-number">8</span> Gather data</a></li>
<li><a class="" href="hunt-data.html"><span class="header-section-number">9</span> Hunt data</a></li>
<li><a class="" href="farm-data.html"><span class="header-section-number">10</span> Farm data</a></li>
<li class="book-part">Preparation</li>
<li><a class="" href="cleaning-and-preparing-data.html"><span class="header-section-number">11</span> Cleaning and preparing data</a></li>
<li><a class="" href="storing-and-retrieving-data.html"><span class="header-section-number">12</span> Storing and retrieving data</a></li>
<li><a class="" href="disseminating-and-protecting-data.html"><span class="header-section-number">13</span> Disseminating and protecting data</a></li>
<li class="book-part">Modelling</li>
<li><a class="" href="exploratory-data-analysis.html"><span class="header-section-number">14</span> Exploratory data analysis</a></li>
<li><a class="" href="ijalm.html"><span class="header-section-number">15</span> It’s Just A Linear Model</a></li>
<li><a class="" href="causality.html"><span class="header-section-number">16</span> Causality from observational data</a></li>
<li><a class="" href="mrp.html"><span class="header-section-number">17</span> Multilevel regression with post-stratification</a></li>
<li><a class="" href="text-as-data.html"><span class="header-section-number">18</span> Text as data</a></li>
<li class="book-part">Enrichment</li>
<li><a class="" href="using-the-cloud.html"><span class="header-section-number">19</span> Using the cloud</a></li>
<li><a class="" href="deploying-models.html"><span class="header-section-number">20</span> Deploying models</a></li>
<li><a class="" href="efficiency.html"><span class="header-section-number">21</span> Efficiency</a></li>
<li><a class="" href="concludingremarks.html"><span class="header-section-number">22</span> Concluding remarks</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="oh-you-think-and-shoulders-and-datasets.html"><span class="header-section-number">A</span> Oh you think and shoulders and datasets</a></li>
<li><a class="" href="papers.html"><span class="header-section-number">B</span> Papers</a></li>
<li><a class="" href="references-1.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/rstudio/bookdown-demo">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="drinking-from-a-fire-hose" class="section level1" number="2">
<h1>
<span class="header-section-number">2</span> Drinking from a fire hose<a class="anchor" aria-label="anchor" href="#drinking-from-a-fire-hose"><i class="fas fa-link"></i></a>
</h1>
<p><strong>Required material</strong></p>
<ul>
<li>Read <em>Data science as an atomic habit</em>, <span class="citation">(<a href="references-1.html#ref-citeBarrett" role="doc-biblioref">Barrett 2021a</a>)</span>
</li>
<li>Read <em>This is how AI bias really happens—and why it’s so hard to fix</em>, <span class="citation">(<a href="references-1.html#ref-hao2019" role="doc-biblioref">Hao 2019</a>)</span>
</li>
<li>Read <em>The mundanity of excellence: An ethnographic report on stratification and Olympic swimmers</em>, <span class="citation">(<a href="references-1.html#ref-chambliss1989mundanity" role="doc-biblioref">Chambliss 1989</a>)</span>
</li>
</ul>
<p><strong>Key concepts and skills</strong></p>
<ul>
<li>The statistical programming language R enables us to tell interesting stories using data. It is a language like any other, and the path to mastery can be slow.</li>
<li>The framework that we use to approach projects is: plan, simulate, gather, explore, and share.</li>
<li>The way to learn R is to start with a small project and break down what is required to achieve it into tiny steps, look at other people’s code, and draw on that to achieve each step. Complete that project and move onto the next project. Each project you will get a little better.</li>
<li>The key is to start actively working regularly.</li>
</ul>
<p><strong>Key libraries</strong></p>
<ul>
<li>
<code>ggplot2</code> <span class="citation">(<a href="references-1.html#ref-citeggplot" role="doc-biblioref">Wickham 2016</a>)</span>
</li>
<li>
<code>janitor</code> <span class="citation">(<a href="references-1.html#ref-janitor" role="doc-biblioref">Firke 2020</a>)</span>
</li>
<li>
<code>opendatatoronto</code> <span class="citation">(<a href="references-1.html#ref-citeSharla" role="doc-biblioref">Gelfand 2020</a>)</span>
</li>
<li>
<code>tidyr</code> <span class="citation">(<a href="references-1.html#ref-citetidyr" role="doc-biblioref">Wickham 2021c</a>)</span>
</li>
<li>
<code>tidyverse</code> <span class="citation">(<a href="references-1.html#ref-Wickham2017" role="doc-biblioref">Wickham 2017</a>)</span>
</li>
</ul>
<p><strong>Key functions</strong></p>
<ul>
<li>
<code>&lt;-</code> ‘assign’</li>
<li>
<code>|&gt;</code> ‘pipe’</li>
<li>
<code>+</code> ‘add’</li>
<li><code><a href="https://rdrr.io/r/base/c.html">c()</a></code></li>
<li><code><a href="https://rdrr.io/r/utils/citation.html">citation()</a></code></li>
<li><code><a href="https://rdrr.io/r/base/class.html">class()</a></code></li>
<li><code><a href="https://dplyr.tidyverse.org/reference/arrange.html">dplyr::arrange()</a></code></li>
<li><code><a href="https://dplyr.tidyverse.org/reference/filter.html">dplyr::filter()</a></code></li>
<li><code><a href="https://dplyr.tidyverse.org/reference/mutate.html">dplyr::mutate()</a></code></li>
<li><code><a href="https://dplyr.tidyverse.org/reference/recode.html">dplyr::recode()</a></code></li>
<li><code><a href="https://dplyr.tidyverse.org/reference/rename.html">dplyr::rename()</a></code></li>
<li><code><a href="https://dplyr.tidyverse.org/reference/select.html">dplyr::select()</a></code></li>
<li><code><a href="https://dplyr.tidyverse.org/reference/summarise.html">dplyr::summarize()</a></code></li>
<li><code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">ggplot2::geom_bar()</a></code></li>
<li><code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">ggplot2::geom_point()</a></code></li>
<li><code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot2::ggplot()</a></code></li>
<li><code><a href="https://rdrr.io/r/utils/head.html">head()</a></code></li>
<li><code><a href="https://rdrr.io/pkg/janitor/man/clean_names.html">janitor::clean_names()</a></code></li>
<li><code><a href="https://rdrr.io/r/base/library.html">library()</a></code></li>
<li><code><a href="https://rdrr.io/r/base/names.html">names()</a></code></li>
<li><code><a href="https://readr.tidyverse.org/reference/read_delim.html">readr::read_csv()</a></code></li>
<li><code><a href="https://readr.tidyverse.org/reference/write_delim.html">readr::write_csv()</a></code></li>
<li><code><a href="https://rdrr.io/r/base/rep.html">rep()</a></code></li>
<li><code><a href="https://rdrr.io/r/stats/Poisson.html">rpois()</a></code></li>
<li><code><a href="https://rdrr.io/r/stats/Uniform.html">runif()</a></code></li>
<li><code><a href="https://rdrr.io/r/base/sample.html">sample()</a></code></li>
<li><code><a href="https://rdrr.io/r/base/Random.html">set.seed()</a></code></li>
<li><code><a href="https://stringr.tidyverse.org/reference/str_remove.html">stringr::str_remove()</a></code></li>
<li><code><a href="https://rdrr.io/r/base/sum.html">sum()</a></code></li>
<li><code><a href="https://rdrr.io/r/utils/head.html">tail()</a></code></li>
<li><code><a href="https://tidyr.tidyverse.org/reference/separate.html">tidyr::separate()</a></code></li>
</ul>
<div id="hello-world" class="section level2" number="2.1">
<h2>
<span class="header-section-number">2.1</span> Hello, World!<a class="anchor" aria-label="anchor" href="#hello-world"><i class="fas fa-link"></i></a>
</h2>
<p>The way to start, is to start. In this chapter we go through three complete examples of the workflow advocated in this book. This means we will: plan, simulate, acquire, explore, and share. If you are new to R, then some of the code may be a bit unfamiliar to you. If you are new to statistics, then some of the concepts may be unfamiliar. Do not worry. It will all soon become familiar.
The only way to learn how to tell stories, is to start telling stories yourself. This means that you should try to get these examples working. Do the sketches yourself, type everything out yourself (using R Studio Cloud if you are new to R and do not have it installed on your own computer), and execute it all. It is important, and normal, to realize that it will be challenging at the start.</p>
<blockquote>
<p>Whenever you’re learning a new tool, for a long time, you’re going to suck… But the good news is that is typical; that’s something that happens to everyone, and it’s only temporary.</p>
<p>Hadley Wickham as quoted by <span class="citation"><a href="references-1.html#ref-citeBarrett" role="doc-biblioref">Barrett</a> (<a href="references-1.html#ref-citeBarrett" role="doc-biblioref">2021a</a>)</span>.</p>
</blockquote>
<p>You will be guided thoroughly here. Hopefully by experiencing the power of telling stories with data, you will feel empowered to stick with it.</p>
<p>To get started, go to R Studio Cloud – <a href="https://rstudio.cloud/" class="uri">https://rstudio.cloud/</a> – and create an account. As we are not doing anything too involved the free version will be fine for now. Once you have an account and log in, then it should look something like Figure <a href="drinking-from-a-fire-hose.html#fig:second">2.1</a>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:second"></span>
<img src="figures/01-03_r_essentials/02.png" alt="Opening R Studio Cloud for the first time" width="90%"><p class="caption">
Figure 2.1: Opening R Studio Cloud for the first time
</p>
</div>
<p>(You will be in ‘Your Workspace,’ and you will not have an ‘Example Workspace.’) From here you should start a ‘New Project.’ You can give the project a name by clicking on ‘Untitled Project’ and replacing it.</p>
<p>We will now go through three worked examples: Canadian elections, Toronto homelessness, and neonatal mortality. These examples build increasing complexity, but from the first one, we will be telling a story with data.</p>
</div>
<div id="canadian-elections" class="section level2" number="2.2">
<h2>
<span class="header-section-number">2.2</span> Canadian elections<a class="anchor" aria-label="anchor" href="#canadian-elections"><i class="fas fa-link"></i></a>
</h2>
<p>Canada is a parliamentary democracy with 338 seats in the House of Commons, which is the lower house and that from which government is formed. There are two major parties – ‘Liberal’ and ‘Conservative’ – three minor parties – ‘Bloc Québécois,’ ‘New Democratic,’ and ‘Green’ – and many smaller parties and independents. In this example we will create a graph of the number of seats that each party won in the 2019 Federal Election.</p>
<div id="plan" class="section level3" number="2.2.1">
<h3>
<span class="header-section-number">2.2.1</span> Plan<a class="anchor" aria-label="anchor" href="#plan"><i class="fas fa-link"></i></a>
</h3>
<p>For this example, we need to plan two aspects. The first is what the dataset that we need will look like, and the second is what the final graph will look like.</p>
<p>The basic requirement for the dataset is that it has the name of the seat (sometimes called a ‘riding’ in Canada) and the party of the person elected. So, a quick sketch of the dataset that we would need could look something like Figure <a href="drinking-from-a-fire-hose.html#fig:canadaexampledata">2.2</a>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:canadaexampledata"></span>
<img src="figures/IMG_1815.png" alt="Quick sketch of a dataset that could be useful for analysing Canadian elections" width="40%"><p class="caption">
Figure 2.2: Quick sketch of a dataset that could be useful for analysing Canadian elections
</p>
</div>
<p>We also need to plan the graph that we are interested in. Given we want to display the number of seats that each party won, a quick sketch of what we might aim for is Figure <a href="drinking-from-a-fire-hose.html#fig:canadaexampletable">2.3</a>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:canadaexampletable"></span>
<img src="figures/IMG_1814.png" alt="Quick sketch of a possible graph of the number of ridings won by each party" width="75%"><p class="caption">
Figure 2.3: Quick sketch of a possible graph of the number of ridings won by each party
</p>
</div>
</div>
<div id="simulate" class="section level3" number="2.2.2">
<h3>
<span class="header-section-number">2.2.2</span> Simulate<a class="anchor" aria-label="anchor" href="#simulate"><i class="fas fa-link"></i></a>
</h3>
<p>We now simulate some data, to bring some specificity to our sketches.</p>
<p>To get started, within R Studio Cloud, make a new R Markdown file (‘File’ -&gt; ‘New File’ -&gt; ‘R Markdown’). When you do this, you will be asked to install some packages, which you should agree to. For this example, we will put everything into this one R Markdown document. You should save it as ‘canadian_elections.Rmd’ (‘File’ -&gt; ‘Save As…’)</p>
<p>In the R Markdown document create a new R code chunk (‘Code’ -&gt; ‘Insert Chunk’) and add preamble documentation that explains:</p>
<ul>
<li>the purpose of the document;</li>
<li>the author and contact details;</li>
<li>when the file was written or last updated; and</li>
<li>pre-requisites that the file relies on.</li>
</ul>
<p>In R, lines that start with ‘#’ are comments. This means that they are not run as code by R, but are instead designed to be read by humans. Each line of this preamble should start with a ‘#.’ Also make it clear that this is the preamble section by surrounding that with ‘####.’</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#### Preamble ####</span>
<span class="co"># Purpose: Read in data from the 2019 Canadian Election and make a</span>
<span class="co"># graph of the number of ridings each party won.</span>
<span class="co"># Author: Rohan Alexander</span>
<span class="co"># Email: rohan.alexander@utoronto.ca</span>
<span class="co"># Date: 1 January 2022</span>
<span class="co"># Prerequisites: Need to know where to get Canadian elections data.</span></code></pre></div>
<p>After this we need to set-up the workspace. This involves installing and loading any packages that will be needed. A package only needs to be installed once for each computer, but needs to be loaded each time it is to be used. In this case we are going to use <code>tidyverse</code> <span class="citation">(<a href="references-1.html#ref-Wickham2017" role="doc-biblioref">Wickham 2017</a>)</span>, <code>janitor</code> <span class="citation">(<a href="references-1.html#ref-janitor" role="doc-biblioref">Firke 2020</a>)</span>, and <code>tidyr</code> <span class="citation">(<a href="references-1.html#ref-citetidyr" role="doc-biblioref">Wickham 2021c</a>)</span>. They will need to be installed because this is the first time they are being used, and then each will need to be loaded.</p>
<p>An example of installing the packages follows (excessive comments have been added to be clear about what is going on; in general, this level of commenting is unnecessary). Run this code by clicking the small green arrow associated with the R code chunk.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#### Workspace set-up ####</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"tidyverse"</span><span class="op">)</span> <span class="co"># Only need to do this once per computer</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"janitor"</span><span class="op">)</span> <span class="co"># Only need to do this once per computer</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"tidyr"</span><span class="op">)</span> <span class="co"># Only need to do this once per computer</span></code></pre></div>
<p>Now that the packages are installed, they need to be loaded. As that installation step only needs to be done once per computer, that code can be commented out so that it is not accidentally run.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#### Workspace set-up ####</span>
<span class="co"># install.packages("tidyverse") # Only need to do this once per computer</span>
<span class="co"># install.packages("janitor") # Only need to do this once per computer</span>
<span class="co"># install.packages("tidyr") # Only need to do this once per computer</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span> <span class="co"># A collection of data-related packages</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sfirke/janitor">janitor</a></span><span class="op">)</span> <span class="co"># Helps clean datasets</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span> <span class="co"># Helps make tidy datasets</span></code></pre></div>
<p>All packages contain a help file that provides information about them and their functions. It can be accessed by appending a question mark before the package name and then running that code. For instance <code><a href="https://tidyverse.tidyverse.org/reference/tidyverse-package.html">?tidyverse</a></code>.</p>
<p>To simulate our data, we need to create a dataset with two columns: ‘Riding’ and ‘Party,’ and some values for each. In the case of ‘Riding’ reasonable values would be a name of one of the 338 Canadian ridings. In the case of ‘Party’ reasonable values would be one of the following six: ‘Liberal,’ ‘Conservative,’ ‘Bloc Québécois,’ ‘New Democratic,’ ‘Green,’ ‘Other.’ Again, this code can be run by clicking the small green arrow associated with the R code chunk.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">simulated_data</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>
    <span class="co"># Use 1 through to 338 to represent each riding</span>
    <span class="st">'Riding'</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">338</span>,
    <span class="co"># Randomly choose one of six options, with replacement, 338 times</span>
    <span class="st">'Party'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span>
      x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
        <span class="st">'Liberal'</span>,
        <span class="st">'Conservative'</span>,
        <span class="st">'Bloc Québécois'</span>,
        <span class="st">'New Democratic'</span>,
        <span class="st">'Green'</span>,
        <span class="st">'Other'</span>
      <span class="op">)</span>,
      size <span class="op">=</span> <span class="fl">338</span>,
      replace <span class="op">=</span> <span class="cn">TRUE</span>
    <span class="op">)</span><span class="op">)</span>

<span class="va">simulated_data</span>
<span class="co">#&gt; # A tibble: 338 × 2</span>
<span class="co">#&gt;    Riding Party         </span>
<span class="co">#&gt;     &lt;int&gt; &lt;chr&gt;         </span>
<span class="co">#&gt;  1      1 Other         </span>
<span class="co">#&gt;  2      2 Liberal       </span>
<span class="co">#&gt;  3      3 Green         </span>
<span class="co">#&gt;  4      4 Liberal       </span>
<span class="co">#&gt;  5      5 New Democratic</span>
<span class="co">#&gt;  6      6 Green         </span>
<span class="co">#&gt;  7      7 Other         </span>
<span class="co">#&gt;  8      8 New Democratic</span>
<span class="co">#&gt;  9      9 Other         </span>
<span class="co">#&gt; 10     10 Bloc Québécois</span>
<span class="co">#&gt; # … with 328 more rows</span></code></pre></div>
</div>
<div id="acquire" class="section level3" number="2.2.3">
<h3>
<span class="header-section-number">2.2.3</span> Acquire<a class="anchor" aria-label="anchor" href="#acquire"><i class="fas fa-link"></i></a>
</h3>
<p>Now we want to get the actual data. The data we need is from Elections Canada, which is the non-partisan agency that organizes Canadian Federal elections. We can pass a website to <code><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv()</a></code> from the <code>readr</code> package <span class="citation">(<a href="references-1.html#ref-citereadr" role="doc-biblioref">Wickham, Hester, and Bryan 2021</a>)</span>. We do not need to explicitly load the <code>readr</code> package because it is part of the <code>tidyverse</code>. The ‘&lt;-’ or ‘assignment operator’ is allocating the output of <code><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv()</a></code> to an object called ‘raw_elections_data.’</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#### Read in the data ####</span>
<span class="va">raw_elections_data</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span>
    file <span class="op">=</span>
      <span class="st">"https://www.elections.ca/res/rep/off/ovr2019app/51/data_donnees/table_tableau11.csv"</span>,
    show_col_types <span class="op">=</span> <span class="cn">FALSE</span>
    <span class="op">)</span> 

<span class="co"># We have read the data from the Elections Canada website. We may like</span>
<span class="co"># to save it in case something happens or they move it. </span>
<span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html">write_csv</a></span><span class="op">(</span>
  x <span class="op">=</span> <span class="va">raw_elections_data</span>, 
  file <span class="op">=</span> <span class="st">"canadian_voting.csv"</span>
  <span class="op">)</span></code></pre></div>
<p>We can take a quick look at the dataset using <code><a href="https://rdrr.io/r/utils/head.html">head()</a></code> which will show the first six rows, and <code><a href="https://rdrr.io/r/utils/head.html">tail()</a></code> which will show the last six rows.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">raw_elections_data</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 × 13</span>
<span class="co">#&gt;   Province      `Electoral Dis…` `Electoral Dis…` Population</span>
<span class="co">#&gt;   &lt;chr&gt;         &lt;chr&gt;                       &lt;dbl&gt;      &lt;dbl&gt;</span>
<span class="co">#&gt; 1 Newfoundland… Avalon                      10001      86494</span>
<span class="co">#&gt; 2 Newfoundland… Bonavista--Buri…            10002      74116</span>
<span class="co">#&gt; 3 Newfoundland… Coast of Bays--…            10003      77680</span>
<span class="co">#&gt; 4 Newfoundland… Labrador                    10004      27197</span>
<span class="co">#&gt; 5 Newfoundland… Long Range Moun…            10005      86553</span>
<span class="co">#&gt; 6 Newfoundland… St. John's East…            10006      85697</span>
<span class="co">#&gt; # … with 9 more variables: `Electors/Électeurs` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `Polling Stations/Bureaux de scrutin` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `Valid Ballots/Bulletins valides` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `Percentage of Valid Ballots /Pourcentage des bulletins valides` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `Rejected Ballots/Bulletins rejetés` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `Percentage of Rejected Ballots /Pourcentage des bulletins rejetés` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `Total Ballots Cast/Total des bulletins déposés` &lt;dbl&gt;, …</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span><span class="op">(</span><span class="va">raw_elections_data</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 × 13</span>
<span class="co">#&gt;   Province      `Electoral Dis…` `Electoral Dis…` Population</span>
<span class="co">#&gt;   &lt;chr&gt;         &lt;chr&gt;                       &lt;dbl&gt;      &lt;dbl&gt;</span>
<span class="co">#&gt; 1 British Colu… Vancouver South…            59040     102927</span>
<span class="co">#&gt; 2 British Colu… Victoria                    59041     117133</span>
<span class="co">#&gt; 3 British Colu… West Vancouver-…            59042     119113</span>
<span class="co">#&gt; 4 Yukon         Yukon                       60001      35874</span>
<span class="co">#&gt; 5 Northwest Te… Northwest Terri…            61001      41786</span>
<span class="co">#&gt; 6 Nunavut       Nunavut                     62001      35944</span>
<span class="co">#&gt; # … with 9 more variables: `Electors/Électeurs` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `Polling Stations/Bureaux de scrutin` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `Valid Ballots/Bulletins valides` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `Percentage of Valid Ballots /Pourcentage des bulletins valides` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `Rejected Ballots/Bulletins rejetés` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `Percentage of Rejected Ballots /Pourcentage des bulletins rejetés` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `Total Ballots Cast/Total des bulletins déposés` &lt;dbl&gt;, …</span></code></pre></div>
<p>We need to clean the data so that we can use it. We are trying to make it similar to the dataset that we thought we wanted in the planning stage. While it is fine to move away from the plan, this needs to be a deliberate, reasoned, decision. After reading in the dataset that we saved, the first thing that we will do is adjust the names to make them easier to type. Removing the spaces helps to type column names. We will do this using <code><a href="https://rdrr.io/pkg/janitor/man/clean_names.html">clean_names()</a></code> from <code>janitor</code> <span class="citation">(<a href="references-1.html#ref-janitor" role="doc-biblioref">Firke 2020</a>)</span> which changes the names into ‘snake_case.’</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#### Basic cleaning ####</span>
<span class="va">raw_elections_data</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"canadian_voting.csv"</span>,
           show_col_types <span class="op">=</span> <span class="cn">FALSE</span>
           <span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Make the names easier to type</span>
<span class="va">cleaned_elections_data</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/janitor/man/clean_names.html">clean_names</a></span><span class="op">(</span><span class="va">raw_elections_data</span><span class="op">)</span>

<span class="co"># Have a look at the first six rows</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">cleaned_elections_data</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 × 13</span>
<span class="co">#&gt;   province      electoral_distr… electoral_distr… population</span>
<span class="co">#&gt;   &lt;chr&gt;         &lt;chr&gt;                       &lt;dbl&gt;      &lt;dbl&gt;</span>
<span class="co">#&gt; 1 Newfoundland… Avalon                      10001      86494</span>
<span class="co">#&gt; 2 Newfoundland… Bonavista--Buri…            10002      74116</span>
<span class="co">#&gt; 3 Newfoundland… Coast of Bays--…            10003      77680</span>
<span class="co">#&gt; 4 Newfoundland… Labrador                    10004      27197</span>
<span class="co">#&gt; 5 Newfoundland… Long Range Moun…            10005      86553</span>
<span class="co">#&gt; 6 Newfoundland… St. John's East…            10006      85697</span>
<span class="co">#&gt; # … with 9 more variables: electors_electeurs &lt;dbl&gt;,</span>
<span class="co">#&gt; #   polling_stations_bureaux_de_scrutin &lt;dbl&gt;,</span>
<span class="co">#&gt; #   valid_ballots_bulletins_valides &lt;dbl&gt;,</span>
<span class="co">#&gt; #   percentage_of_valid_ballots_pourcentage_des_bulletins_valides &lt;dbl&gt;,</span>
<span class="co">#&gt; #   rejected_ballots_bulletins_rejetes &lt;dbl&gt;,</span>
<span class="co">#&gt; #   percentage_of_rejected_ballots_pourcentage_des_bulletins_rejetes &lt;dbl&gt;,</span>
<span class="co">#&gt; #   total_ballots_cast_total_des_bulletins_deposes &lt;dbl&gt;, …</span></code></pre></div>
<p>The names are faster to type because R Studio will auto-complete them. To do this, we begin typing the name of a column and then use ‘tab’ to auto-complete it.</p>
<p>There are many columns in the dataset, and we are primarily interested in two: ‘electoral_district_name_nom_de_circonscription,’ and ‘elected_candidate_candidat_elu.’ We can choose certain columns of interest using <code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code> from <code>dplyr</code> <span class="citation">(<a href="references-1.html#ref-citedplyr" role="doc-biblioref">Wickham et al. 2020</a>)</span> which we loaded as part of the <code>tidyverse</code>. The ‘pipe operator,’ <code>|&gt;</code>, pushes the output of one line to be the first input of the function on the next line.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cleaned_elections_data</span> <span class="op">&lt;-</span> 
  <span class="va">cleaned_elections_data</span> |&gt; 
  <span class="co"># Select only certain columns</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">electoral_district_name_nom_de_circonscription</span>,
         <span class="va">elected_candidate_candidat_elu</span>
         <span class="op">)</span>

<span class="co"># Have a look at the first six rows</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">cleaned_elections_data</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 × 2</span>
<span class="co">#&gt;   electoral_district_name_nom_de_circonscr… elected_candida…</span>
<span class="co">#&gt;   &lt;chr&gt;                                     &lt;chr&gt;           </span>
<span class="co">#&gt; 1 Avalon                                    McDonald, Kenne…</span>
<span class="co">#&gt; 2 Bonavista--Burin--Trinity                 Rogers, Churenc…</span>
<span class="co">#&gt; 3 Coast of Bays--Central--Notre Dame        Simms, Scott Li…</span>
<span class="co">#&gt; 4 Labrador                                  Jones, Yvonne L…</span>
<span class="co">#&gt; 5 Long Range Mountains                      Hutchings, Gudi…</span>
<span class="co">#&gt; 6 St. John's East/St. John's-Est            Harris, Jack ND…</span></code></pre></div>
<p>Some of the names of the columns are still quite long because they have both English and French in them. We can look at the names of the columns with <code><a href="https://rdrr.io/r/base/names.html">names()</a></code>. And we can change the names using <code><a href="https://dplyr.tidyverse.org/reference/rename.html">rename()</a></code> from <code>dplyr</code> <span class="citation">(<a href="references-1.html#ref-citedplyr" role="doc-biblioref">Wickham et al. 2020</a>)</span>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">cleaned_elections_data</span><span class="op">)</span>
<span class="co">#&gt; [1] "electoral_district_name_nom_de_circonscription"</span>
<span class="co">#&gt; [2] "elected_candidate_candidat_elu"</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cleaned_elections_data</span> <span class="op">&lt;-</span> 
  <span class="va">cleaned_elections_data</span> |&gt; 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>
    riding <span class="op">=</span> <span class="va">electoral_district_name_nom_de_circonscription</span>,
    elected_candidate <span class="op">=</span> <span class="va">elected_candidate_candidat_elu</span>
    <span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">cleaned_elections_data</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 × 2</span>
<span class="co">#&gt;   riding                             elected_candidate      </span>
<span class="co">#&gt;   &lt;chr&gt;                              &lt;chr&gt;                  </span>
<span class="co">#&gt; 1 Avalon                             McDonald, Kenneth Libe…</span>
<span class="co">#&gt; 2 Bonavista--Burin--Trinity          Rogers, Churence Liber…</span>
<span class="co">#&gt; 3 Coast of Bays--Central--Notre Dame Simms, Scott Liberal/L…</span>
<span class="co">#&gt; 4 Labrador                           Jones, Yvonne Liberal/…</span>
<span class="co">#&gt; 5 Long Range Mountains               Hutchings, Gudie Liber…</span>
<span class="co">#&gt; 6 St. John's East/St. John's-Est     Harris, Jack NDP-New D…</span></code></pre></div>
<p>We will now look at this dataset, and the ‘elected_candidate’ column in particular.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">cleaned_elections_data</span><span class="op">$</span><span class="va">elected_candidate</span><span class="op">)</span>
<span class="co">#&gt; [1] "McDonald, Kenneth Liberal/Libéral"                                   </span>
<span class="co">#&gt; [2] "Rogers, Churence Liberal/Libéral"                                    </span>
<span class="co">#&gt; [3] "Simms, Scott Liberal/Libéral"                                        </span>
<span class="co">#&gt; [4] "Jones, Yvonne Liberal/Libéral"                                       </span>
<span class="co">#&gt; [5] "Hutchings, Gudie Liberal/Libéral"                                    </span>
<span class="co">#&gt; [6] "Harris, Jack NDP-New Democratic Party/NPD-Nouveau Parti démocratique"</span></code></pre></div>
<p>We can see that we have the surname of the elected candidate, followed by a comma, followed by their first name, followed by a space, followed by the name of the party in both English and French, separated by a slash. We can break-up this column into its pieces using <code><a href="https://tidyr.tidyverse.org/reference/separate.html">separate()</a></code> from <code>tidyr</code> <span class="citation">(<a href="references-1.html#ref-citetidyr" role="doc-biblioref">Wickham 2021c</a>)</span>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cleaned_elections_data</span> <span class="op">&lt;-</span> 
  <span class="va">cleaned_elections_data</span> |&gt; 
  <span class="co"># Separate the column into two based on the slash</span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html">separate</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">elected_candidate</span>,
           into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'other'</span>, <span class="st">'party'</span><span class="op">)</span>,
           sep <span class="op">=</span> <span class="st">'/'</span><span class="op">)</span> |&gt; 
  <span class="co"># Remove the 'other' column</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">other</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">cleaned_elections_data</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 × 2</span>
<span class="co">#&gt;   riding                             party                  </span>
<span class="co">#&gt;   &lt;chr&gt;                              &lt;chr&gt;                  </span>
<span class="co">#&gt; 1 Avalon                             Libéral                </span>
<span class="co">#&gt; 2 Bonavista--Burin--Trinity          Libéral                </span>
<span class="co">#&gt; 3 Coast of Bays--Central--Notre Dame Libéral                </span>
<span class="co">#&gt; 4 Labrador                           Libéral                </span>
<span class="co">#&gt; 5 Long Range Mountains               Libéral                </span>
<span class="co">#&gt; 6 St. John's East/St. John's-Est     NPD-Nouveau Parti démo…</span></code></pre></div>
<p>Finally we want to change the party names from French to English to match what we simulated, using <code><a href="https://dplyr.tidyverse.org/reference/recode.html">recode()</a></code> from <code>dplyr</code> <span class="citation">(<a href="references-1.html#ref-citedplyr" role="doc-biblioref">Wickham et al. 2020</a>)</span>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cleaned_elections_data</span> <span class="op">&lt;-</span>
  <span class="va">cleaned_elections_data</span> |&gt;
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
    party <span class="op">=</span>
      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html">recode</a></span><span class="op">(</span>
        <span class="va">party</span>,
        <span class="st">'Conservateur'</span> <span class="op">=</span> <span class="st">'Conservative'</span>,
        <span class="st">'Indépendant(e)'</span> <span class="op">=</span> <span class="st">'Other'</span>,
        <span class="st">'Libéral'</span> <span class="op">=</span> <span class="st">'Liberal'</span>,
        <span class="st">'NPD-Nouveau Parti démocratique'</span> <span class="op">=</span> <span class="st">'New Democratic'</span>,
        <span class="st">'Parti Vert'</span> <span class="op">=</span> <span class="st">'Green'</span>
      <span class="op">)</span>
  <span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">cleaned_elections_data</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 × 2</span>
<span class="co">#&gt;   riding                             party         </span>
<span class="co">#&gt;   &lt;chr&gt;                              &lt;chr&gt;         </span>
<span class="co">#&gt; 1 Avalon                             Liberal       </span>
<span class="co">#&gt; 2 Bonavista--Burin--Trinity          Liberal       </span>
<span class="co">#&gt; 3 Coast of Bays--Central--Notre Dame Liberal       </span>
<span class="co">#&gt; 4 Labrador                           Liberal       </span>
<span class="co">#&gt; 5 Long Range Mountains               Liberal       </span>
<span class="co">#&gt; 6 St. John's East/St. John's-Est     New Democratic</span></code></pre></div>
<p>Our data now matches our plan (Figure <a href="drinking-from-a-fire-hose.html#fig:canadaexampledata">2.2</a>) pretty well. For every electoral district we have the party of the person that won it.</p>
<p>Having now nicely cleaned the dataset, we should save it, so that we can start with that cleaned dataset in the next stage.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html">write_csv</a></span><span class="op">(</span>
  x <span class="op">=</span> <span class="va">cleaned_elections_data</span>,
  file <span class="op">=</span> <span class="st">"cleaned_elections_data.csv"</span>
  <span class="op">)</span></code></pre></div>
</div>
<div id="explore" class="section level3" number="2.2.4">
<h3>
<span class="header-section-number">2.2.4</span> Explore<a class="anchor" aria-label="anchor" href="#explore"><i class="fas fa-link"></i></a>
</h3>
<p>At this point we would like to explore the dataset that we created. One way to better understand a dataset is to make a graph. In particular, here we would like to build the graph that we planned in Figure <a href="drinking-from-a-fire-hose.html#fig:canadaexampletable">2.3</a>.</p>
<p>First, we read in the dataset that we just created.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#### Read in the data ####</span>
<span class="va">cleaned_elections_data</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span>
    file <span class="op">=</span> <span class="st">"cleaned_elections_data.csv"</span>,
    show_col_types <span class="op">=</span> <span class="cn">FALSE</span>
    <span class="op">)</span></code></pre></div>
<p>We can get a quick count of how many seats each party won using <code><a href="https://dplyr.tidyverse.org/reference/count.html">count()</a></code> from <code>dplyr</code> <span class="citation">(<a href="references-1.html#ref-citedplyr" role="doc-biblioref">Wickham et al. 2020</a>)</span>.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cleaned_elections_data</span> |&gt; 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">party</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 × 2</span>
<span class="co">#&gt;   party              n</span>
<span class="co">#&gt;   &lt;chr&gt;          &lt;int&gt;</span>
<span class="co">#&gt; 1 Bloc Québécois    32</span>
<span class="co">#&gt; 2 Conservative     121</span>
<span class="co">#&gt; 3 Green              3</span>
<span class="co">#&gt; 4 Liberal          157</span>
<span class="co">#&gt; 5 New Democratic    24</span>
<span class="co">#&gt; 6 Other              1</span></code></pre></div>
<p>To build the graph that we are interested in, we will rely on the <code>ggplot2</code> package <span class="citation">(<a href="references-1.html#ref-citeggplot" role="doc-biblioref">Wickham 2016</a>)</span>. The key aspect of this package is that we build graphs by adding layers using ‘+,’ which we call the ‘add operator.’ In particular we will create a bar chart using <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar()</a></code> from <code>ggplot2</code> <span class="citation">(<a href="references-1.html#ref-citeggplot" role="doc-biblioref">Wickham 2016</a>)</span>.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cleaned_elections_data</span> |&gt; 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">party</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="co"># aes abbreviates aesthetics and enables us </span>
  <span class="co"># to specify the x axis variable</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-drinking_from_a_fire_hose_files/figure-html/unnamed-chunk-24-1.png" width="672"></div>
<p>This accomplishes what we set out to do. But we can make it look a bit nicer by modifying the default options (Figure <a href="drinking-from-a-fire-hose.html#fig:canadanice">2.4</a>).</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cleaned_elections_data</span> |&gt; 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">party</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="co"># Make the theme neater</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="co"># Swap the x and y axis to make parties easier to read</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Party"</span>,
       y <span class="op">=</span> <span class="st">"Number of seats"</span><span class="op">)</span> <span class="co"># Make the labels more meaningful</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:canadanice"></span>
<img src="02-drinking_from_a_fire_hose_files/figure-html/canadanice-1.png" alt="Number of seats won, by political party, at the 2019 Canadian Federal Election" width="672"><p class="caption">
Figure 2.4: Number of seats won, by political party, at the 2019 Canadian Federal Election
</p>
</div>
</div>
<div id="communicate" class="section level3" number="2.2.5">
<h3>
<span class="header-section-number">2.2.5</span> Communicate<a class="anchor" aria-label="anchor" href="#communicate"><i class="fas fa-link"></i></a>
</h3>
<p>To this point we have downloaded some data, cleaned it, and made a graph. We would typically need to communicate what we have done at some length. In this case, we can write a few paragraphs about what we did, why we did it, and what we found. An example follows.</p>
<blockquote>
<p>Canada is a parliamentary democracy with 338 seats in the House of Commons, which is the house that forms government. There are two major parties—‘Liberal’ and ‘Conservative’—three minor parties—‘Bloc Québécois,’ ‘New Democratic,’ and ‘Green’—and many smaller parties. The 2019 Federal Election occurred on 21 October, and more than 17 million votes were cast. We were interested in the number of seats that were won by each party.</p>
<p>We downloaded the results, on a seat-specific basis, from the Elections Canada website. We cleaned and tidied the dataset using the statistical programming language R <span class="citation">(<a href="references-1.html#ref-citeR" role="doc-biblioref">R Core Team 2021</a>)</span> as well as the packages <code>tidyverse</code> <span class="citation">(<a href="references-1.html#ref-citetidyverse" role="doc-biblioref">Wickham et al. 2019a</a>)</span> and <code>janitor</code> <span class="citation">(<a href="references-1.html#ref-janitor" role="doc-biblioref">Firke 2020</a>)</span>. We then created a graph of the number of seats that each political party won (Figure <a href="drinking-from-a-fire-hose.html#fig:canadanice">2.4</a>).</p>
<p>We found that the Liberal Party won 157 seats, followed by the Conservative Party with 121 seats. The minor parties won the following number of seats: Bloc Québécois, 32 seats, New Democratic Party, 24 seats, and the Green Party, 3 seats. Finally, one independent candidate won a seat.</p>
<p>The distribution of seats is skewed toward the two major parties which could reflect relatively stable preferences on the part of Canadian voters, or possibly inertia due to the benefits of already being a major party such a national network and funding, or some other reason. A better understanding the reasons for this distribution are of interest in future work. While the dataset consists of everyone who voted, it worth noting that in Canada some are systematically excluded from voting; and it is much difficult for some to vote than others.</p>
</blockquote>
</div>
</div>
<div id="toronto-homelessness" class="section level2" number="2.3">
<h2>
<span class="header-section-number">2.3</span> Toronto homelessness<a class="anchor" aria-label="anchor" href="#toronto-homelessness"><i class="fas fa-link"></i></a>
</h2>
<p>Toronto has a large homeless population <span class="citation">(<a href="references-1.html#ref-torontohomeless" role="doc-biblioref">City of Toronto 2021</a>)</span>. Freezing winters mean it is important there are enough places in shelters. In this example we will make a table of shelter usage in the second half of 2021 that compares average use in each month. Our expectation is that there is greater usage in the colder months, for instance, December, compared with warmer months, for instance, July.</p>
<div id="plan-1" class="section level3" number="2.3.1">
<h3>
<span class="header-section-number">2.3.1</span> Plan<a class="anchor" aria-label="anchor" href="#plan-1"><i class="fas fa-link"></i></a>
</h3>
<p>The dataset that we are interested in would need to have date, the shelter, and the number of beds that were occupied that night. A quick sketch of a dataset that would work is Figure <a href="drinking-from-a-fire-hose.html#fig:torontohomelessdataplan">2.5</a>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:torontohomelessdataplan"></span>
<img src="figures/IMG_1817.png" alt="Quick sketch of a dataset that could be useful for understanding shelter usage in Toronto" width="50%"><p class="caption">
Figure 2.5: Quick sketch of a dataset that could be useful for understanding shelter usage in Toronto
</p>
</div>
<p>We are interested in creating a table that has the monthly average number of beds occupied each night. The table would probably look something like Figure <a href="drinking-from-a-fire-hose.html#fig:houselessexampletable">2.6</a>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:houselessexampletable"></span>
<img src="figures/IMG_1818.png" alt="Quick sketch of a table of the average number of beds occupied each month" width="50%"><p class="caption">
Figure 2.6: Quick sketch of a table of the average number of beds occupied each month
</p>
</div>
</div>
<div id="simulate-1" class="section level3" number="2.3.2">
<h3>
<span class="header-section-number">2.3.2</span> Simulate<a class="anchor" aria-label="anchor" href="#simulate-1"><i class="fas fa-link"></i></a>
</h3>
<p>The next step is to simulate some data that could resemble our dataset.</p>
<p>Within R Studio Cloud make a new R Markdown file, save it, and make a new R code chunk and add preamble documentation. Then install and/or load the libraries that are needed. We will again use <code>tidyverse</code> <span class="citation">(<a href="references-1.html#ref-Wickham2017" role="doc-biblioref">Wickham 2017</a>)</span>, <code>janitor</code> <span class="citation">(<a href="references-1.html#ref-janitor" role="doc-biblioref">Firke 2020</a>)</span>, and <code>tidyr</code> <span class="citation">(<a href="references-1.html#ref-citetidyr" role="doc-biblioref">Wickham 2021c</a>)</span>. As those were installed earlier, they do not need to be installed again. In this example we will also use <code>lubridate</code> <span class="citation">(<a href="references-1.html#ref-GrolemundWickham2011" role="doc-biblioref">Grolemund and Wickham 2011</a>)</span>, which is part of the <code>tidyverse</code> and so it does not need to be installed independently. We will also use <code>opendatatoronto</code> <span class="citation">(<a href="references-1.html#ref-citeSharla" role="doc-biblioref">Gelfand 2020</a>)</span>, and <code>knitr</code> <span class="citation">(<a href="references-1.html#ref-citeknitr" role="doc-biblioref">Xie 2021</a>)</span> and these will need to be installed.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#### Preamble ####</span>
<span class="co"># Purpose: Get data about 2021 houseless shelter usage and make a table</span>
<span class="co"># Author: Rohan Alexander</span>
<span class="co"># Email: rohan.alexander@utoronto.ca</span>
<span class="co"># Date: 1 January 2022</span>
<span class="co"># Prerequisites: - </span>

<span class="co">#### Workspace set-up ####</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"opendatatoronto"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"lubridate"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"knitr"</span><span class="op">)</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/">knitr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sfirke/janitor">janitor</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org">lubridate</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://sharlagelfand.github.io/opendatatoronto/">opendatatoronto</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span></code></pre></div>
<p>To add a bit more detail to the earlier example, libraries contain code that other people have written. There are a few common ones that you will see regularly, especially the <code>tidyverse</code>. To use a package, we must first install it and then we need to load it. A package only needs to be installed once per computer but must be loaded every time. So, the packages that we installed earlier do not need to be reinstalled here.</p>
<p>Given that folks freely gave up their time to make <code>R</code> and the packages that we use, it is important to cite them. To get the information that is needed, we can use <code><a href="https://rdrr.io/r/utils/citation.html">citation()</a></code>. When run without any arguments, that provides the citation information for <code>R</code> itself, and when run with an argument that is the name of a package, it provides the citation information for that package.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/citation.html">citation</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># Get the citation information for R</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; To cite R in publications use:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   R Core Team (2021). R: A language and environment</span>
<span class="co">#&gt;   for statistical computing. R Foundation for</span>
<span class="co">#&gt;   Statistical Computing, Vienna, Austria. URL</span>
<span class="co">#&gt;   https://www.R-project.org/.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; A BibTeX entry for LaTeX users is</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   @Manual{,</span>
<span class="co">#&gt;     title = {R: A Language and Environment for Statistical Computing},</span>
<span class="co">#&gt;     author = {{R Core Team}},</span>
<span class="co">#&gt;     organization = {R Foundation for Statistical Computing},</span>
<span class="co">#&gt;     address = {Vienna, Austria},</span>
<span class="co">#&gt;     year = {2021},</span>
<span class="co">#&gt;     url = {https://www.R-project.org/},</span>
<span class="co">#&gt;   }</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; We have invested a lot of time and effort in creating</span>
<span class="co">#&gt; R, please cite it when using it for data analysis.</span>
<span class="co">#&gt; See also 'citation("pkgname")' for citing R packages.</span>
<span class="fu"><a href="https://rdrr.io/r/utils/citation.html">citation</a></span><span class="op">(</span><span class="st">'tidyverse'</span><span class="op">)</span> <span class="co"># Get the citation information for a particular package</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   Wickham et al., (2019). Welcome to the tidyverse.</span>
<span class="co">#&gt;   Journal of Open Source Software, 4(43), 1686,</span>
<span class="co">#&gt;   https://doi.org/10.21105/joss.01686</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; A BibTeX entry for LaTeX users is</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   @Article{,</span>
<span class="co">#&gt;     title = {Welcome to the {tidyverse}},</span>
<span class="co">#&gt;     author = {Hadley Wickham and Mara Averick and Jennifer Bryan and Winston Chang and Lucy D'Agostino McGowan and Romain François and Garrett Grolemund and Alex Hayes and Lionel Henry and Jim Hester and Max Kuhn and Thomas Lin Pedersen and Evan Miller and Stephan Milton Bache and Kirill Müller and Jeroen Ooms and David Robinson and Dana Paige Seidel and Vitalie Spinu and Kohske Takahashi and Davis Vaughan and Claus Wilke and Kara Woo and Hiroaki Yutani},</span>
<span class="co">#&gt;     year = {2019},</span>
<span class="co">#&gt;     journal = {Journal of Open Source Software},</span>
<span class="co">#&gt;     volume = {4},</span>
<span class="co">#&gt;     number = {43},</span>
<span class="co">#&gt;     pages = {1686},</span>
<span class="co">#&gt;     doi = {10.21105/joss.01686},</span>
<span class="co">#&gt;   }</span></code></pre></div>
<p>Turning to the simulation, we need three columns: ‘date,’ ‘shelter,’ and ‘occupancy.’ This example will build on the earlier one by adding a seed using <code><a href="https://rdrr.io/r/base/Random.html">set.seed()</a></code>. A seed enables us to always generate the same random data. Any integer can be used as the seed. In this case the seed will be 853. If you use that as your seed, then you should get the same random numbers as in this example. If you use a different seed, then you should expect different random numbers. Finally, we use <code><a href="https://rdrr.io/r/base/rep.html">rep()</a></code> to repeat something a certain number of times. For instance, we repeat ‘Shelter 1,’ 184 times which accounts for half a year.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#### Simulate ####</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">853</span><span class="op">)</span>   

<span class="va">simulated_occupancy_data</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>
    date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2021-07-01"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">183</span><span class="op">)</span>, times <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>, 
    <span class="co"># Based on Dirk Eddelbuettel: https://stackoverflow.com/a/21502386</span>
    shelter <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Shelter 1"</span>, times <span class="op">=</span> <span class="fl">184</span><span class="op">)</span>, 
                <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Shelter 2"</span>, times <span class="op">=</span> <span class="fl">184</span><span class="op">)</span>,
                <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Shelter 3"</span>, times <span class="op">=</span> <span class="fl">184</span><span class="op">)</span><span class="op">)</span>,
    number_occupied <span class="op">=</span> 
      <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">rpois</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">184</span><span class="op">*</span><span class="fl">3</span>,
            lambda <span class="op">=</span> <span class="fl">30</span><span class="op">)</span> <span class="co"># Draw 552 times from the Poisson distribution</span>
    <span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">simulated_occupancy_data</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 × 3</span>
<span class="co">#&gt;   date       shelter   number_occupied</span>
<span class="co">#&gt;   &lt;date&gt;     &lt;chr&gt;               &lt;int&gt;</span>
<span class="co">#&gt; 1 2021-07-01 Shelter 1              28</span>
<span class="co">#&gt; 2 2021-07-02 Shelter 1              29</span>
<span class="co">#&gt; 3 2021-07-03 Shelter 1              35</span>
<span class="co">#&gt; 4 2021-07-04 Shelter 1              25</span>
<span class="co">#&gt; 5 2021-07-05 Shelter 1              21</span>
<span class="co">#&gt; 6 2021-07-06 Shelter 1              30</span></code></pre></div>
<p>In this simulation we first create a list of all the dates in 2021. We repeat that list three times. We assume data for three shelters for every day of the year. To simulate the number of beds that are occupied each night, we draw from a Poisson distribution, assuming a mean number of 30 beds occupied per shelter.</p>
</div>
<div id="acquire-1" class="section level3" number="2.3.3">
<h3>
<span class="header-section-number">2.3.3</span> Acquire<a class="anchor" aria-label="anchor" href="#acquire-1"><i class="fas fa-link"></i></a>
</h3>
<p>We use data made available about Toronto homeless shelters by the City of Toronto. The premise of the data is that each night at 4am a count is made of the occupied beds. To access the data, we use <code>opendatatoronto</code> <span class="citation">(<a href="references-1.html#ref-citeSharla" role="doc-biblioref">Gelfand 2020</a>)</span> and then save our own copy.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#### Acquire ####</span>
<span class="co"># Based on code from: </span>
<span class="co"># https://open.toronto.ca/dataset/daily-shelter-overnight-service-occupancy-capacity/</span>
<span class="co"># Thank you to Heath Priston for assistance</span>
<span class="va">toronto_shelters</span> <span class="op">&lt;-</span> 
  <span class="co"># Each package is associated with a unique id which can be found in </span>
  <span class="co"># 'For Developers':</span>
  <span class="co"># https://open.toronto.ca/dataset/daily-shelter-overnight-service-occupancy-capacity/</span>
  <span class="fu"><a href="https://sharlagelfand.github.io/opendatatoronto//reference/list_package_resources.html">list_package_resources</a></span><span class="op">(</span><span class="st">"21c83b32-d5a8-4106-a54f-010dbe49f6f2"</span><span class="op">)</span> |&gt; 
  <span class="co"># Within that package, we are interested in the 2021 dataset</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op">==</span> <span class="st">"daily-shelter-overnight-service-occupancy-capacity-2021"</span><span class="op">)</span> |&gt; 
  <span class="co"># Having reduce the dataset down to one row we can get the resource</span>
  <span class="fu"><a href="https://sharlagelfand.github.io/opendatatoronto//reference/get_resource.html">get_resource</a></span><span class="op">(</span><span class="op">)</span>

<span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html">write_csv</a></span><span class="op">(</span>
  x <span class="op">=</span> <span class="va">toronto_shelters</span>, 
  file <span class="op">=</span> <span class="st">"toronto_shelters.csv"</span>
  <span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">toronto_shelters</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; # A tibble: 6 × 32
#&gt;     `_id` OCCUPANCY_DATE ORGANIZATION_ID ORGANIZATION_NAME  
#&gt;     &lt;dbl&gt; &lt;date&gt;                   &lt;dbl&gt; &lt;chr&gt;              
#&gt; 1 7272806 2021-01-01                  24 COSTI Immigrant Se…
#&gt; 2 7272807 2021-01-01                  24 COSTI Immigrant Se…
#&gt; 3 7272808 2021-01-01                  24 COSTI Immigrant Se…
#&gt; 4 7272809 2021-01-01                  24 COSTI Immigrant Se…
#&gt; 5 7272810 2021-01-01                  24 COSTI Immigrant Se…
#&gt; 6 7272811 2021-01-01                  24 COSTI Immigrant Se…
#&gt; # … with 28 more variables: SHELTER_ID &lt;dbl&gt;,
#&gt; #   SHELTER_GROUP &lt;chr&gt;, LOCATION_ID &lt;dbl&gt;,
#&gt; #   LOCATION_NAME &lt;chr&gt;, LOCATION_ADDRESS &lt;chr&gt;,
#&gt; #   LOCATION_POSTAL_CODE &lt;chr&gt;, LOCATION_CITY &lt;chr&gt;,
#&gt; #   LOCATION_PROVINCE &lt;chr&gt;, PROGRAM_ID &lt;dbl&gt;,
#&gt; #   PROGRAM_NAME &lt;chr&gt;, SECTOR &lt;chr&gt;, PROGRAM_MODEL &lt;chr&gt;,
#&gt; #   OVERNIGHT_SERVICE_TYPE &lt;chr&gt;, PROGRAM_AREA &lt;chr&gt;, …</code></pre>
<p>Not much needs to be done to this to make it similar to the dataset that we were interested in (Figure <a href="drinking-from-a-fire-hose.html#fig:torontohomelessdataplan">2.5</a>). We need to change the names to make them easier to type using <code><a href="https://rdrr.io/pkg/janitor/man/clean_names.html">clean_names()</a></code>, reduce the columns to only those that are relevant using <code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code>, and only keep the second half of the year using <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code>.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">toronto_shelters_clean</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/janitor/man/clean_names.html">clean_names</a></span><span class="op">(</span><span class="va">toronto_shelters</span><span class="op">)</span> |&gt; 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">occupancy_date</span>, <span class="va">id</span>, <span class="va">occupied_beds</span><span class="op">)</span> |&gt; 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">occupancy_date</span> <span class="op">&gt;=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/as_date.html">as_date</a></span><span class="op">(</span><span class="st">"2021-07-01"</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">toronto_shelters_clean</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 × 3</span>
<span class="co">#&gt;   occupancy_date      id occupied_beds</span>
<span class="co">#&gt;   &lt;date&gt;           &lt;dbl&gt;         &lt;dbl&gt;</span>
<span class="co">#&gt; 1 2021-12-27     7323151            50</span>
<span class="co">#&gt; 2 2021-12-27     7323152            18</span>
<span class="co">#&gt; 3 2021-12-27     7323153            28</span>
<span class="co">#&gt; 4 2021-12-27     7323154            50</span>
<span class="co">#&gt; 5 2021-12-27     7323155            NA</span>
<span class="co">#&gt; 6 2021-12-27     7323156            NA</span></code></pre></div>
<p>All that remains is to save the cleaned dataset.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html">write_csv</a></span><span class="op">(</span>
  x <span class="op">=</span> <span class="va">toronto_shelters_clean</span>, 
  file <span class="op">=</span> <span class="st">"cleaned_toronto_shelters.csv"</span>
  <span class="op">)</span></code></pre></div>
</div>
<div id="explore-1" class="section level3" number="2.3.4">
<h3>
<span class="header-section-number">2.3.4</span> Explore<a class="anchor" aria-label="anchor" href="#explore-1"><i class="fas fa-link"></i></a>
</h3>
<p>First, we load the dataset that we just created.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#### Explore ####</span>
<span class="va">toronto_shelters_clean</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span>
    <span class="st">"cleaned_toronto_shelters.csv"</span>,
    show_col_types <span class="op">=</span> <span class="cn">FALSE</span>
    <span class="op">)</span></code></pre></div>
<p>The dataset is on a daily basis for each shelter. We are interested in understanding average usage for each month. To do this, we need to and add a month column, which we do using <code><a href="https://lubridate.tidyverse.org/reference/month.html">month()</a></code> from <code>lubridate</code> <span class="citation">(<a href="references-1.html#ref-GrolemundWickham2011" role="doc-biblioref">Grolemund and Wickham 2011</a>)</span>. By default, <code><a href="https://lubridate.tidyverse.org/reference/month.html">month()</a></code> provides the number of the month, and so we include two arguments ‘label’ and ‘abbr’ to get the full name of the month. We remove rows that do not have any data for the number of beds using <code><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na()</a></code> from <code>tidyr</code>. And we then create a summary statistic on the basis of monthly groups, using <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize()</a></code> from <code>dplyr</code> <span class="citation">(<a href="references-1.html#ref-citedplyr" role="doc-biblioref">Wickham et al. 2020</a>)</span>. We use <code><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable()</a></code> from <code>knitr</code> <span class="citation">(<a href="references-1.html#ref-citeknitr" role="doc-biblioref">Xie 2021</a>)</span> to create a table.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Based on code from Florence Vallée-Dubois and Lisa Lendway</span>
<span class="va">toronto_shelters_clean</span> |&gt;
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>occupancy_month <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/month.html">month</a></span><span class="op">(</span><span class="va">occupancy_date</span>, 
                                 label <span class="op">=</span> <span class="cn">TRUE</span>, 
                                 abbr <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> |&gt;
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="va">occupied_beds</span><span class="op">)</span> |&gt; <span class="co"># We only want rows that have data</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">occupancy_month</span><span class="op">)</span> |&gt; <span class="co"># We want to know the occupancy by month</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>number_occupied <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">occupied_beds</span><span class="op">)</span><span class="op">)</span> |&gt;
  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left">occupancy_month</th>
<th align="right">number_occupied</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">July</td>
<td align="right">29.67137</td>
</tr>
<tr class="even">
<td align="left">August</td>
<td align="right">30.83975</td>
</tr>
<tr class="odd">
<td align="left">September</td>
<td align="right">31.65405</td>
</tr>
<tr class="even">
<td align="left">October</td>
<td align="right">32.32991</td>
</tr>
<tr class="odd">
<td align="left">November</td>
<td align="right">33.26980</td>
</tr>
<tr class="even">
<td align="left">December</td>
<td align="right">33.57806</td>
</tr>
</tbody>
</table></div>
<p>As with before, this looks fine, and achieves what we set out to do. But we can make some tweaks to the defaults to make it look even better (Table <a href="drinking-from-a-fire-hose.html#tab:homelessoccupancy">2.1</a>). We can add a caption, make the column names easier to read, only show an appropriate level of decimal places, and improve the formatting.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">toronto_shelters_clean</span> |&gt;
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>occupancy_month <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/month.html">month</a></span><span class="op">(</span><span class="va">occupancy_date</span>, 
                                 label <span class="op">=</span> <span class="cn">TRUE</span>, 
                                 abbr <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> |&gt;
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="va">occupied_beds</span><span class="op">)</span> |&gt; <span class="co"># We only want rows that have data</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">occupancy_month</span><span class="op">)</span> |&gt; <span class="co"># We want to know the occupancy by month</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>number_occupied <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">occupied_beds</span><span class="op">)</span><span class="op">)</span> |&gt; 
  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Homeless shelter usage in Toronto in 2021"</span>, 
        col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Month"</span>, <span class="st">"Average daily number of occupied beds"</span><span class="op">)</span>,
        digits <span class="op">=</span> <span class="fl">1</span>,
        booktabs <span class="op">=</span> <span class="cn">TRUE</span>,
        linesep <span class="op">=</span> <span class="st">""</span>
        <span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:homelessoccupancy">Table 2.1: </span>Homeless shelter usage in Toronto in 2021</caption>
<thead><tr class="header">
<th align="left">Month</th>
<th align="right">Average daily number of occupied beds</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">July</td>
<td align="right">29.7</td>
</tr>
<tr class="even">
<td align="left">August</td>
<td align="right">30.8</td>
</tr>
<tr class="odd">
<td align="left">September</td>
<td align="right">31.7</td>
</tr>
<tr class="even">
<td align="left">October</td>
<td align="right">32.3</td>
</tr>
<tr class="odd">
<td align="left">November</td>
<td align="right">33.3</td>
</tr>
<tr class="even">
<td align="left">December</td>
<td align="right">33.6</td>
</tr>
</tbody>
</table></div>
</div>
<div id="communicate-1" class="section level3" number="2.3.5">
<h3>
<span class="header-section-number">2.3.5</span> Communicate<a class="anchor" aria-label="anchor" href="#communicate-1"><i class="fas fa-link"></i></a>
</h3>
<p>We need to write a few brief paragraphs about what we did, why we did it, and what we found. An example follows.</p>
<blockquote>
<p>Toronto has a large homeless population. Freezing winters mean it is critical there are enough places in shelters. We are interested to understand how usage of shelters changes in colder months, compared with warmer months.</p>
<p>We use data provided by the City of Toronto about Toronto homeless shelter bed occupancy. Specifically, at 4am each night a count is made of the occupied beds. We are interested in averaging this over the month. We cleaned, tidied, and analyzed the dataset using the statistical programming language R <span class="citation">(<a href="references-1.html#ref-citeR" role="doc-biblioref">R Core Team 2021</a>)</span> as well as the packages <code>tidyverse</code> <span class="citation">(<a href="references-1.html#ref-Wickham2017" role="doc-biblioref">Wickham 2017</a>)</span>, <code>janitor</code> <span class="citation">(<a href="references-1.html#ref-janitor" role="doc-biblioref">Firke 2020</a>)</span>, <code>tidyr</code> <span class="citation">(<a href="references-1.html#ref-citetidyr" role="doc-biblioref">Wickham 2021c</a>)</span>, <code>opendatatoronto</code> <span class="citation">(<a href="references-1.html#ref-citeSharla" role="doc-biblioref">Gelfand 2020</a>)</span>, <code>lubridate</code> <span class="citation">(<a href="references-1.html#ref-GrolemundWickham2011" role="doc-biblioref">Grolemund and Wickham 2011</a>)</span>, and <code>knitr</code> <span class="citation">(<a href="references-1.html#ref-citeknitr" role="doc-biblioref">Xie 2021</a>)</span>. We then made a table of the average number of occupied beds each night for each month (Table <a href="drinking-from-a-fire-hose.html#tab:homelessoccupancy">2.1</a>).</p>
<p>We found that the daily average number of occupied beds was higher in December 2021 than July 2021, with 34 occupied beds in December, compared with 30 in July (Table <a href="drinking-from-a-fire-hose.html#tab:homelessoccupancy">2.1</a>). More generally, there was a steady increase in the daily average number of occupied beds between July and December, with a slight increase each month.</p>
<p>The dataset is on the basis of shelters, and so our results may be skewed by changes that are specific to especially large or especially small shelters. It may be that particular shelters are especially attractive in colder months. Additionally, we were concerned with counts of the number of occupied beds, but if the supply of beds changes over the season, then an additional statistic of interest would be proportion occupied.</p>
</blockquote>
<p>Although this example is only a few paragraphs, it could be reduced to form an abstract, or increased to form a full report. The first paragraph is a general overview, the second focuses on the data, the third on the results, and the fourth is a discussion. Each of these could be expanded to form sections of a short report.</p>
</div>
</div>
<div id="neonatal-mortality" class="section level2" number="2.4">
<h2>
<span class="header-section-number">2.4</span> Neonatal mortality<a class="anchor" aria-label="anchor" href="#neonatal-mortality"><i class="fas fa-link"></i></a>
</h2>
<p>Neonatal mortality refers to a death that occurs within the first month of life, and in particular, the neonatal mortality rate (NMR) is the number of neonatal deaths per 1,000 live births <span class="citation">(<a href="references-1.html#ref-unigme" role="doc-biblioref">UN IGME 2021</a>)</span>. Reducing it is part of the third Sustainable Development Goal <span class="citation">(<a href="references-1.html#ref-hug2019national" role="doc-biblioref">Hug et al. 2019</a>)</span>. In this example we will create a graph of the estimated NMR for the past fifty years for: Argentina, Australia, Canada, and Kenya.</p>
<div id="plan-2" class="section level3" number="2.4.1">
<h3>
<span class="header-section-number">2.4.1</span> Plan<a class="anchor" aria-label="anchor" href="#plan-2"><i class="fas fa-link"></i></a>
</h3>
<p>For this example, we need to think about what our dataset should look like, and what the graph should look like.</p>
<p>The dataset needs to have columns that specify the country, and the year. It also needs to have a column with the NMR estimate for that year for that country. Roughly, it should look like Figure <a href="drinking-from-a-fire-hose.html#fig:nmrexampledata">2.7</a>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:nmrexampledata"></span>
<img src="figures/IMG_1812.png" alt="Quick sketch of a potentially useful NMR dataset" width="40%"><p class="caption">
Figure 2.7: Quick sketch of a potentially useful NMR dataset
</p>
</div>
<p>We are interested to make a graph with year on the x-axis and estimated NMR on the y-axis. Each country should have its own series Roughly similar to Figure <a href="drinking-from-a-fire-hose.html#fig:nmrexamplegraph">2.8</a>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:nmrexamplegraph"></span>
<img src="figures/IMG_1813.png" alt="Quick sketch of a graph of NMR by country over time" width="75%"><p class="caption">
Figure 2.8: Quick sketch of a graph of NMR by country over time
</p>
</div>
</div>
<div id="simulate-2" class="section level3" number="2.4.2">
<h3>
<span class="header-section-number">2.4.2</span> Simulate<a class="anchor" aria-label="anchor" href="#simulate-2"><i class="fas fa-link"></i></a>
</h3>
<p>We would like to simulate some data that aligns with our plan. In this case we will need three columns: country, year, and NMR.</p>
<p>Within R Studio Cloud make a new R Markdown file and save it. Add preamble documentation and set-up the workspace. We will use <code>tidyverse</code> <span class="citation">(<a href="references-1.html#ref-Wickham2017" role="doc-biblioref">Wickham 2017</a>)</span>, <code>janitor</code> <span class="citation">(<a href="references-1.html#ref-janitor" role="doc-biblioref">Firke 2020</a>)</span>, and <code>lubridate</code> <span class="citation">(<a href="references-1.html#ref-GrolemundWickham2011" role="doc-biblioref">Grolemund and Wickham 2011</a>)</span>.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#### Preamble ####</span>
<span class="co"># Purpose: Obtain and prepare data about neonatal mortality for four</span>
<span class="co"># countries for the past fifty years and create a graph.</span>
<span class="co"># Author: Rohan Alexander</span>
<span class="co"># Email: rohan.alexander@utoronto.ca</span>
<span class="co"># Date: 1 January 2022</span>
<span class="co"># Prerequisites: - </span>

<span class="co">#### Workspace set-up ####</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sfirke/janitor">janitor</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org">lubridate</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></code></pre></div>
<p>The code contained in libraries can change from time to time as the authors update it and release new versions. We can see which version of a package we are using with <code><a href="https://rdrr.io/r/utils/packageDescription.html">packageVersion()</a></code>. For instance, we are using version 1.3.1 of the <code>tidyverse</code> and version 2.1.0 of <code>janitor</code>.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/packageDescription.html">packageVersion</a></span><span class="op">(</span><span class="st">'tidyverse'</span><span class="op">)</span>
<span class="co">#&gt; [1] '1.3.1'</span>
<span class="fu"><a href="https://rdrr.io/r/utils/packageDescription.html">packageVersion</a></span><span class="op">(</span><span class="st">'janitor'</span><span class="op">)</span>
<span class="co">#&gt; [1] '2.1.0'</span></code></pre></div>
<p>To update the version of the package, we use <code><a href="https://rdrr.io/r/utils/update.packages.html">update.packages()</a></code>.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/update.packages.html">update.packages</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>This does not need to be run, say, every day, but from time-to-time it is worth updating packages. While many packages take care to ensure backward compatibility, at a certain point this does not become reasonable, and so it is important to be aware the updating packages can result in old code needing to be updated.</p>
<p>Returning to the simulation, we repeat the name of each country 50 times with <code><a href="https://rdrr.io/r/base/rep.html">rep()</a></code>, and enable the passing of 50 years. Finally, we draw from the uniform distribution with <code><a href="https://rdrr.io/r/stats/Uniform.html">runif()</a></code> to simulate an estimated NMR value for that year for that country.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#### Simulate data ####</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">853</span><span class="op">)</span>

<span class="va">simulated_nmr_data</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>
    country <span class="op">=</span> 
      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
        <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">'Argentina'</span>, <span class="fl">50</span><span class="op">)</span>,
        <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">'Australia'</span>, <span class="fl">50</span><span class="op">)</span>,
        <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">'Canada'</span>, <span class="fl">50</span><span class="op">)</span>,
        <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">'Kenya'</span>, <span class="fl">50</span><span class="op">)</span>
        <span class="op">)</span>,
    year <span class="op">=</span> 
      <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1971</span><span class="op">:</span><span class="fl">2020</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span>,
    nmr <span class="op">=</span> 
      <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">200</span>,
            min <span class="op">=</span> <span class="fl">0</span>, 
            max <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>
  <span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">simulated_nmr_data</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 × 3</span>
<span class="co">#&gt;   country    year   nmr</span>
<span class="co">#&gt;   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1 Argentina  1971 35.9 </span>
<span class="co">#&gt; 2 Argentina  1972 12.0 </span>
<span class="co">#&gt; 3 Argentina  1973 48.4 </span>
<span class="co">#&gt; 4 Argentina  1974 31.6 </span>
<span class="co">#&gt; 5 Argentina  1975  3.74</span>
<span class="co">#&gt; 6 Argentina  1976 40.4</span></code></pre></div>
<p>While this simulation works, it would be time-consuming and error-prone if we decided that instead of fifty years, we were interested in simulating, say, sixty years. One way to make this easier is to replace all instances of 50 with a variable. An example follows.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#### Simulate data ####</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">853</span><span class="op">)</span>

<span class="va">number_of_years</span> <span class="op">&lt;-</span> <span class="fl">50</span>

<span class="va">simulated_nmr_data</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>
    country <span class="op">=</span> 
      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
        <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">'Argentina'</span>, <span class="va">number_of_years</span><span class="op">)</span>,
        <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">'Australia'</span>, <span class="va">number_of_years</span><span class="op">)</span>,
        <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">'Canada'</span>, <span class="va">number_of_years</span><span class="op">)</span>,
        <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">'Kenya'</span>, <span class="va">number_of_years</span><span class="op">)</span>
        <span class="op">)</span>,
    year <span class="op">=</span> 
      <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">number_of_years</span> <span class="op">+</span> <span class="fl">1970</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span>,
    nmr <span class="op">=</span> 
      <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">number_of_years</span> <span class="op">*</span> <span class="fl">4</span>,
            min <span class="op">=</span> <span class="fl">0</span>, 
            max <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>
  <span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">simulated_nmr_data</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 × 3</span>
<span class="co">#&gt;   country    year   nmr</span>
<span class="co">#&gt;   &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1 Argentina  1971 35.9 </span>
<span class="co">#&gt; 2 Argentina  1972 12.0 </span>
<span class="co">#&gt; 3 Argentina  1973 48.4 </span>
<span class="co">#&gt; 4 Argentina  1974 31.6 </span>
<span class="co">#&gt; 5 Argentina  1975  3.74</span>
<span class="co">#&gt; 6 Argentina  1976 40.4</span></code></pre></div>
<p>The result will be the same, but now if we want to change from fifty to sixty years is to make the change in one place.</p>
<p>We can have confidence in this simulated dataset because it is relatively straight-forward, and we wrote the code for it. But when we turn to the real dataset, it is more difficult to be sure that it is what it claims to be. Even if we trust the data, it is important that we can share that confidence with others. One way forward is to establish some checks that prove our data are as they should be. For instance, we expect:</p>
<ol style="list-style-type: decimal">
<li>That ‘country’ is, and only is, one of these four: ‘Argentina,’ ‘Australia,’ ‘Canada,’ or ‘Kenya.’</li>
<li>Conversely, that ‘country’ contains all those four countries.</li>
<li>That ‘year’ is no smaller than 1971 and no larger than 2020, and is a number, not a letter.</li>
<li>That ‘nmr’ is a value somewhere between 0 and 1,000, and is a number.</li>
</ol>
<p>We can write a series of tests based on these features, that we expect that dataset to pass.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Tests for simulated data</span>
<span class="va">simulated_nmr_data</span><span class="op">$</span><span class="va">country</span> |&gt; 
  <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="op">)</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Argentina"</span>, 
                <span class="st">"Australia"</span>, 
                <span class="st">"Canada"</span>, 
                <span class="st">"Kenya"</span><span class="op">)</span>
<span class="co">#&gt; [1] TRUE TRUE TRUE TRUE</span>

<span class="va">simulated_nmr_data</span><span class="op">$</span><span class="va">country</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="op">)</span> <span class="op">==</span> <span class="fl">4</span>
<span class="co">#&gt; [1] TRUE</span>

<span class="va">simulated_nmr_data</span><span class="op">$</span><span class="va">year</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1971</span>
<span class="co">#&gt; [1] TRUE</span>

<span class="va">simulated_nmr_data</span><span class="op">$</span><span class="va">year</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="op">)</span> <span class="op">==</span> <span class="fl">2020</span>
<span class="co">#&gt; [1] TRUE</span>

<span class="va">simulated_nmr_data</span><span class="op">$</span><span class="va">nmr</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">0</span>
<span class="co">#&gt; [1] TRUE</span>

<span class="va">simulated_nmr_data</span><span class="op">$</span><span class="va">nmr</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="op">)</span> <span class="op">&lt;=</span> <span class="fl">1000</span>
<span class="co">#&gt; [1] TRUE</span>

<span class="va">simulated_nmr_data</span><span class="op">$</span><span class="va">nmr</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="op">)</span> <span class="op">==</span> <span class="st">"numeric"</span>
<span class="co">#&gt; [1] TRUE</span></code></pre></div>
<p>Having passed these tests, we can have confidence in the simulated dataset. More importantly, we can apply these tests to the real dataset. This enables us to have greater confidence in that dataset and to share that confidence with others.</p>
</div>
<div id="acquire-2" class="section level3" number="2.4.3">
<h3>
<span class="header-section-number">2.4.3</span> Acquire<a class="anchor" aria-label="anchor" href="#acquire-2"><i class="fas fa-link"></i></a>
</h3>
<p>The UN Inter-agency Group for Child Mortality Estimation (IGME) provides estimates of the NMR – <a href="https://childmortality.org/" class="uri">https://childmortality.org/</a> – that we can download and save.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#### Acquire data ####</span>
<span class="va">raw_igme_data</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span>
    file <span class="op">=</span>
      <span class="st">"https://childmortality.org/wp-content/uploads/2021/09/UNIGME-2021.csv"</span>,
    show_col_types <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> 

<span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html">write_csv</a></span><span class="op">(</span>
  x <span class="op">=</span> <span class="va">raw_igme_data</span>, 
  file <span class="op">=</span> <span class="st">"igme.csv"</span>
  <span class="op">)</span></code></pre></div>
<p>We can take a quick look to get a better sense of it. We might be interested in what the dataset seems to look like (using <code><a href="https://rdrr.io/r/utils/head.html">head()</a></code> and <code><a href="https://rdrr.io/r/utils/head.html">tail()</a></code>), and what the names of the columns are (using <code><a href="https://rdrr.io/r/base/names.html">names()</a></code>).</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">raw_igme_data</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 × 29</span>
<span class="co">#&gt;   `Geographic area` Indicator         Sex   `Wealth Quinti…`</span>
<span class="co">#&gt;   &lt;chr&gt;             &lt;chr&gt;             &lt;chr&gt; &lt;chr&gt;           </span>
<span class="co">#&gt; 1 Afghanistan       Neonatal mortali… Total Total           </span>
<span class="co">#&gt; 2 Afghanistan       Neonatal mortali… Total Total           </span>
<span class="co">#&gt; 3 Afghanistan       Neonatal mortali… Total Total           </span>
<span class="co">#&gt; 4 Afghanistan       Neonatal mortali… Total Total           </span>
<span class="co">#&gt; 5 Afghanistan       Neonatal mortali… Total Total           </span>
<span class="co">#&gt; 6 Afghanistan       Neonatal mortali… Total Total           </span>
<span class="co">#&gt; # … with 25 more variables: `Series Name` &lt;chr&gt;,</span>
<span class="co">#&gt; #   `Series Year` &lt;chr&gt;, `Regional group` &lt;chr&gt;,</span>
<span class="co">#&gt; #   TIME_PERIOD &lt;chr&gt;, OBS_VALUE &lt;dbl&gt;,</span>
<span class="co">#&gt; #   COUNTRY_NOTES &lt;chr&gt;, CONNECTION &lt;lgl&gt;,</span>
<span class="co">#&gt; #   DEATH_CATEGORY &lt;lgl&gt;, CATEGORY &lt;chr&gt;,</span>
<span class="co">#&gt; #   `Observation Status` &lt;chr&gt;, `Unit of measure` &lt;chr&gt;,</span>
<span class="co">#&gt; #   `Series Category` &lt;chr&gt;, `Series Type` &lt;chr&gt;, …</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">raw_igme_data</span><span class="op">)</span>
<span class="co">#&gt;  [1] "Geographic area"        "Indicator"             </span>
<span class="co">#&gt;  [3] "Sex"                    "Wealth Quintile"       </span>
<span class="co">#&gt;  [5] "Series Name"            "Series Year"           </span>
<span class="co">#&gt;  [7] "Regional group"         "TIME_PERIOD"           </span>
<span class="co">#&gt;  [9] "OBS_VALUE"              "COUNTRY_NOTES"         </span>
<span class="co">#&gt; [11] "CONNECTION"             "DEATH_CATEGORY"        </span>
<span class="co">#&gt; [13] "CATEGORY"               "Observation Status"    </span>
<span class="co">#&gt; [15] "Unit of measure"        "Series Category"       </span>
<span class="co">#&gt; [17] "Series Type"            "STD_ERR"               </span>
<span class="co">#&gt; [19] "REF_DATE"               "Age Group of Women"    </span>
<span class="co">#&gt; [21] "Time Since First Birth" "DEFINITION"            </span>
<span class="co">#&gt; [23] "INTERVAL"               "Series Method"         </span>
<span class="co">#&gt; [25] "LOWER_BOUND"            "UPPER_BOUND"           </span>
<span class="co">#&gt; [27] "STATUS"                 "YEAR_TO_ACHIEVE"       </span>
<span class="co">#&gt; [29] "Model Used"</span></code></pre></div>
<p>We would like to clean up the names and only keep the rows and columns that we are interested in. Based on our plan, we are interested in rows where ‘Sex’ is ‘Total,’ ‘Series Name’ is ‘UN IGME estimate,’ ‘Geographic area’ is one of ‘Argentina,’ ‘Australia,’ ‘Canada,’ and ‘Kenya,’ and the ‘Indicator’ is ‘Neonatal mortality rate.’ After this we are interested in just a few columns: ‘geographic_area,’ ‘time_period,’ and ‘obs_value.’</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cleaned_igme_data</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/janitor/man/clean_names.html">clean_names</a></span><span class="op">(</span><span class="va">raw_igme_data</span><span class="op">)</span> |&gt; 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">sex</span> <span class="op">==</span> <span class="st">'Total'</span>,
         <span class="va">series_name</span> <span class="op">==</span> <span class="st">'UN IGME estimate'</span>,
         <span class="va">geographic_area</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> 
           <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Argentina'</span>, <span class="st">'Australia'</span>, <span class="st">'Canada'</span>, <span class="st">'Kenya'</span><span class="op">)</span>,
         <span class="va">indicator</span> <span class="op">==</span> <span class="st">'Neonatal mortality rate'</span><span class="op">)</span> |&gt; 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">geographic_area</span>,
         <span class="va">time_period</span>,
         <span class="va">obs_value</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">cleaned_igme_data</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 × 3</span>
<span class="co">#&gt;   geographic_area time_period obs_value</span>
<span class="co">#&gt;   &lt;chr&gt;           &lt;chr&gt;           &lt;dbl&gt;</span>
<span class="co">#&gt; 1 Argentina       1970-06          24.9</span>
<span class="co">#&gt; 2 Argentina       1971-06          24.7</span>
<span class="co">#&gt; 3 Argentina       1972-06          24.6</span>
<span class="co">#&gt; 4 Argentina       1973-06          24.6</span>
<span class="co">#&gt; 5 Argentina       1974-06          24.5</span>
<span class="co">#&gt; 6 Argentina       1975-06          24.1</span></code></pre></div>
<p>Finally, we need to fix two final aspects: the class of ‘time_period’ is character when we need it to be a year, and the name of ‘obs_value’ should be ‘nmr’ to be more informative.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cleaned_igme_data</span> <span class="op">&lt;-</span> 
  <span class="va">cleaned_igme_data</span> |&gt; 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>time_period <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove</a></span><span class="op">(</span><span class="va">time_period</span>, <span class="st">"-06"</span><span class="op">)</span>,
         time_period <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="va">time_period</span><span class="op">)</span><span class="op">)</span> |&gt; 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">time_period</span> <span class="op">&gt;=</span> <span class="fl">1971</span><span class="op">)</span> |&gt; 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>nmr <span class="op">=</span> <span class="va">obs_value</span>,
         year <span class="op">=</span> <span class="va">time_period</span>,
         country <span class="op">=</span> <span class="va">geographic_area</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">cleaned_igme_data</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 × 3</span>
<span class="co">#&gt;   country    year   nmr</span>
<span class="co">#&gt;   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1 Argentina  1971  24.7</span>
<span class="co">#&gt; 2 Argentina  1972  24.6</span>
<span class="co">#&gt; 3 Argentina  1973  24.6</span>
<span class="co">#&gt; 4 Argentina  1974  24.5</span>
<span class="co">#&gt; 5 Argentina  1975  24.1</span>
<span class="co">#&gt; 6 Argentina  1976  23.3</span></code></pre></div>
<p>Finally, we can check that our dataset passes the tests that we developed based on the simulated dataset.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Test the cleaned dataset</span>
<span class="va">cleaned_igme_data</span><span class="op">$</span><span class="va">country</span> |&gt; 
  <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="op">)</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Argentina"</span>, 
                <span class="st">"Australia"</span>, 
                <span class="st">"Canada"</span>, 
                <span class="st">"Kenya"</span><span class="op">)</span>
<span class="co">#&gt; [1] TRUE TRUE TRUE TRUE</span>

<span class="va">cleaned_igme_data</span><span class="op">$</span><span class="va">country</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="op">)</span> <span class="op">==</span> <span class="fl">4</span>
<span class="co">#&gt; [1] TRUE</span>

<span class="va">cleaned_igme_data</span><span class="op">$</span><span class="va">year</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1971</span>
<span class="co">#&gt; [1] TRUE</span>

<span class="va">cleaned_igme_data</span><span class="op">$</span><span class="va">year</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="op">)</span> <span class="op">==</span> <span class="fl">2020</span>
<span class="co">#&gt; [1] TRUE</span>

<span class="va">cleaned_igme_data</span><span class="op">$</span><span class="va">nmr</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">0</span>
<span class="co">#&gt; [1] TRUE</span>

<span class="va">cleaned_igme_data</span><span class="op">$</span><span class="va">nmr</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="op">)</span> <span class="op">&lt;=</span> <span class="fl">1000</span>
<span class="co">#&gt; [1] TRUE</span>

<span class="va">cleaned_igme_data</span><span class="op">$</span><span class="va">nmr</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="op">)</span> <span class="op">==</span> <span class="st">"numeric"</span>
<span class="co">#&gt; [1] TRUE</span></code></pre></div>
<p>All that remains is to save the nicely cleaned dataset.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html">write_csv</a></span><span class="op">(</span>
  x <span class="op">=</span> <span class="va">cleaned_igme_data</span>, 
  file <span class="op">=</span> <span class="st">"cleaned_igme_data.csv"</span>
  <span class="op">)</span></code></pre></div>
</div>
<div id="explore-2" class="section level3" number="2.4.4">
<h3>
<span class="header-section-number">2.4.4</span> Explore<a class="anchor" aria-label="anchor" href="#explore-2"><i class="fas fa-link"></i></a>
</h3>
<p>We would like to make a graph of estimated NMR using the cleaned dataset. First, we read in the dataset.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#### Explore ####</span>
<span class="va">cleaned_igme_data</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span>
    file <span class="op">=</span> <span class="st">"cleaned_igme_data.csv"</span>,
    show_col_types <span class="op">=</span> <span class="cn">FALSE</span>
    <span class="op">)</span></code></pre></div>
<p>We can now make the graph that we are interested in (Figure <a href="drinking-from-a-fire-hose.html#fig:nmrgraph">2.9</a>). We are interested in showing how NMR has changed over time and the difference between countries.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cleaned_igme_data</span> |&gt; 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">nmr</span>, color <span class="op">=</span> <span class="va">country</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Year"</span>,
       y <span class="op">=</span> <span class="st">"Neonatal Mortality Rate (NMR)"</span>,
       color <span class="op">=</span> <span class="st">"Country"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_color_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:nmrgraph"></span>
<img src="02-drinking_from_a_fire_hose_files/figure-html/nmrgraph-1.png" alt="Neonatal Mortality Rate (NMR), for Argentina, Australia, Canada, and Kenya, (1971-2020)" width="672"><p class="caption">
Figure 2.9: Neonatal Mortality Rate (NMR), for Argentina, Australia, Canada, and Kenya, (1971-2020)
</p>
</div>
</div>
<div id="communicate-2" class="section level3" number="2.4.5">
<h3>
<span class="header-section-number">2.4.5</span> Communicate<a class="anchor" aria-label="anchor" href="#communicate-2"><i class="fas fa-link"></i></a>
</h3>
<p>To this point we downloaded some data, cleaned it, wrote some tests, and made a graph. We would typically need to communicate what we have done at some length. In this case, we will write a few paragraphs about what we did, why we did it, and what we found.</p>
<blockquote>
<p>Neonatal mortality refers to a death that occurs within the first month of life. In particular, the neonatal mortality rate (NMR) is the number of neonatal deaths per 1,000 live births <span class="citation">(<a href="references-1.html#ref-alexander2018global" role="doc-biblioref">M. Alexander and Alkema 2018</a>)</span>. We obtain estimates for NMR for four countries—Argentina, Australia, Canada, China, and Kenya—over the past fifty years.</p>
<p>The UN Inter-agency Group for Child Mortality Estimation (IGME) provides estimates of the NMR at the website: <a href="https://childmortality.org/" class="uri">https://childmortality.org/</a>. We downloaded their estimates then cleaned and tidied the dataset using the statistical programming language R <span class="citation">(<a href="references-1.html#ref-citeR" role="doc-biblioref">R Core Team 2021</a>)</span>.</p>
<p>We found considerable change in the estimated NMR over time and between the four countries of interest (Figure <a href="drinking-from-a-fire-hose.html#fig:nmrgraph">2.9</a>). We found that the 1970s tended to be associated with reductions in the estimated NMR. Australia and Canada were estimated to have a low NMR at that point and remained there through 2020, with slight improvements. The estimates for Argentina and Kenya continued to have substantial reductions through 2020. Data were only available from 1990 for China and the estimates show a substantial reduction in the NMR, especially in the 1990s and 2000s.</p>
<p>Our results suggest considerable improvements in estimated NMR over time. But it is worth emphasizing that estimates of the NMR are based on a statistical model and underlying data. The paradox of data availability is that often high-quality data are less easily available for countries with worse outcomes. For instance, <span class="citation"><a href="references-1.html#ref-alexander2018global" role="doc-biblioref">M. Alexander and Alkema</a> (<a href="references-1.html#ref-alexander2018global" role="doc-biblioref">2018</a>)</span> say ‘[t]here is large variability in the availability of data on neonatal mortality.’ Our conclusions are subject to the model that underpins the estimates, and the quality of the underlying data and we did not independently verify either of these.</p>
</blockquote>
</div>
</div>
<div id="exercises-and-tutorial-1" class="section level2" number="2.5">
<h2>
<span class="header-section-number">2.5</span> Exercises and tutorial<a class="anchor" aria-label="anchor" href="#exercises-and-tutorial-1"><i class="fas fa-link"></i></a>
</h2>
<div id="exercises-1" class="section level3" number="2.5.1">
<h3>
<span class="header-section-number">2.5.1</span> Exercises<a class="anchor" aria-label="anchor" href="#exercises-1"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li>Following <span class="citation"><a href="references-1.html#ref-citeBarrett" role="doc-biblioref">Barrett</a> (<a href="references-1.html#ref-citeBarrett" role="doc-biblioref">2021a</a>)</span>, please write a stack of four or five atomic habits that you could implement this week.</li>
<li>What is not one of the four challenges for mitigating bias mentioned in <span class="citation"><a href="references-1.html#ref-hao2019" role="doc-biblioref">Hao</a> (<a href="references-1.html#ref-hao2019" role="doc-biblioref">2019</a>)</span> (pick one)?
<ol style="list-style-type: lower-alpha">
<li>Unknown unknowns.</li>
<li>Imperfect processes.</li>
<li>The definitions of fairness.</li>
<li>Lack of social context.</li>
<li>Disinterest given profit considerations.</li>
</ol>
</li>
<li>When was the dataset that underpins <span class="citation"><a href="references-1.html#ref-chambliss1989mundanity" role="doc-biblioref">Chambliss</a> (<a href="references-1.html#ref-chambliss1989mundanity" role="doc-biblioref">1989</a>)</span> collected (pick one)?
<ol style="list-style-type: lower-alpha">
<li>August 1983 to August 1984</li>
<li>January 1983 to August 1984</li>
<li>January 1983 to January 1984</li>
<li>August 1983 to January 1984</li>
</ol>
</li>
<li>When <span class="citation"><a href="references-1.html#ref-chambliss1989mundanity" role="doc-biblioref">Chambliss</a> (<a href="references-1.html#ref-chambliss1989mundanity" role="doc-biblioref">1989</a>)</span> talks of stratification, what is he talking about?</li>
<li>How does <span class="citation"><a href="references-1.html#ref-chambliss1989mundanity" role="doc-biblioref">Chambliss</a> (<a href="references-1.html#ref-chambliss1989mundanity" role="doc-biblioref">1989</a>)</span> define ‘excellence’ (pick one)?
<ol style="list-style-type: lower-alpha">
<li>Prolonged performance at world-class level.</li>
<li>All Olympic medal winners.</li>
<li>Consistent superiority of performance.</li>
<li>All national-level athletes.</li>
</ol>
</li>
<li>Think about the following quote from <span class="citation"><a href="references-1.html#ref-chambliss1989mundanity" role="doc-biblioref">Chambliss</a> (<a href="references-1.html#ref-chambliss1989mundanity" role="doc-biblioref">1989, 81</a>)</span> and list three small skills or activities that could help you achieve excellence in data science.</li>
</ol>
<blockquote>
<p>Excellence is mundane. Superlative performance is really a confluence of dozens of small skills or activities, each one learned or stumbled upon, which have been carefully drilled into habit and then are fitted together in a synthesized whole. There is nothing extraordinary or super-human in any one of those actions; only the fact that they are done consistently and correctly, and all together, produce excellence.</p>
</blockquote>
<ol start="7" style="list-style-type: decimal">
<li>Which of the following are arguments for <code><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv()</a></code> from <code>readr</code> <span class="citation">(<a href="references-1.html#ref-citereadr" role="doc-biblioref">Wickham, Hester, and Bryan 2021</a>)</span> (select all that apply)? (Hint: You can access the help for the function with <code>?readr::read_csv()</code>.)
<ol style="list-style-type: lower-alpha">
<li>‘all_cols’</li>
<li>‘file’</li>
<li>‘show_col_types’</li>
<li>‘number’</li>
</ol>
</li>
<li>We used <code><a href="https://rdrr.io/r/stats/Poisson.html">rpois()</a></code> and <code><a href="https://rdrr.io/r/stats/Uniform.html">runif()</a></code> to draw from the Poisson and Uniform distributions, respectively. Which of the following can be used to draw from the Normal and Binomial distributions (select all that apply)?
<ol style="list-style-type: lower-alpha">
<li>
<code>rnormal()</code> and <code><a href="https://rdrr.io/r/stats/Binomial.html">rbinom()</a></code>
</li>
<li>
<code><a href="https://rdrr.io/r/stats/Normal.html">rnorm()</a></code> and <code>rbinomial()</code>
</li>
<li>
<code>rnormal()</code> and <code>rbinomial()</code>
</li>
<li>
<code><a href="https://rdrr.io/r/stats/Normal.html">rnorm()</a></code> and <code><a href="https://rdrr.io/r/stats/Binomial.html">rbinom()</a></code>
</li>
</ol>
</li>
<li>What is the result of <code>sample(x = letters, size = 2)</code> when the seed is set to ‘853?’ What about when the seed is set to ‘1234’ (pick one)?
<ol style="list-style-type: lower-alpha">
<li>‘“i” “q”’ and ‘“p” “v”’</li>
<li>‘“e” “l”’ and ‘“e” “r”’</li>
<li>‘“i” “q”’ and ‘“e” “r”’</li>
<li>‘“e” “l”’ and ‘“p” “v”’</li>
</ol>
</li>
<li>Which function provides the recommended citation to cite R (pick one)?
<ol style="list-style-type: lower-alpha">
<li>
<code>cite('R')</code>.</li>
<li>
<code><a href="https://rdrr.io/r/utils/cite.html">cite()</a></code>.</li>
<li>
<code>citation('R')</code>.</li>
<li>
<code><a href="https://rdrr.io/r/utils/citation.html">citation()</a></code>.</li>
</ol>
</li>
<li>How do we get the citation information for <code>opendatatoronto</code> (pick one)?
<ol style="list-style-type: lower-alpha">
<li>cite()</li>
<li>citation()</li>
<li>cite(‘opendatatoronto’)</li>
<li>citation(‘opendatatoronto’)</li>
</ol>
</li>
<li>Which argument needs to be changed to change the headings in <code><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable()</a></code> from <code>knitr</code> <span class="citation">(<a href="references-1.html#ref-citeknitr" role="doc-biblioref">Xie 2021</a>)</span> (pick one)?
<ol style="list-style-type: lower-alpha">
<li>‘booktabs’</li>
<li>‘col.names’</li>
<li>‘digits’</li>
<li>‘linesep’</li>
<li>‘caption’</li>
</ol>
</li>
<li>Which function is used to update packages (pick one)?
<ol style="list-style-type: lower-alpha">
<li><code><a href="https://rdrr.io/r/utils/update.packages.html">update.packages()</a></code></li>
<li><code>upgrade.packages()</code></li>
<li><code>revise.packages()</code></li>
<li><code>renovate.packages()</code></li>
</ol>
</li>
<li>What are some features that we might typically expect of a column that claimed to be a year (select all that apply)?
<ol style="list-style-type: lower-alpha">
<li>The class is ‘character.’</li>
<li>There are no negative numbers.</li>
<li>There are letters in the column.</li>
<li>Each entry has four digits.</li>
</ol>
</li>
</ol>
</div>
<div id="tutorial-1" class="section level3" number="2.5.2">
<h3>
<span class="header-section-number">2.5.2</span> Tutorial<a class="anchor" aria-label="anchor" href="#tutorial-1"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li>Please pick either the seed-growing, or hair-length, example from Chapter <a href="telling-stories-with-data.html#telling-stories-with-data">1</a>. You should have already started to record some data, but you probably do not have much of it. First sketch an example of what the dataset could look like. Please use <code><a href="https://rdrr.io/r/base/sample.html">sample()</a></code> to create a tibble that has twelve weeks’ worth of simulated data.</li>
<li>Pretend that the dataset that you just generated is the actual data that you end up with. Please write a page or so to communicate what you did, why, and what you found.</li>
<li>Reflecting on <span class="citation"><a href="references-1.html#ref-chambliss1989mundanity" role="doc-biblioref">Chambliss</a> (<a href="references-1.html#ref-chambliss1989mundanity" role="doc-biblioref">1989</a>)</span>, please write a page or so about stratification and excellence as it relates to using programming languages, such as R or Python, for data science.</li>
</ol>
</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="telling-stories-with-data.html"><span class="header-section-number">1</span> Telling stories with data</a></div>
<div class="next"><a href="r-essentials.html"><span class="header-section-number">3</span> R essentials</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#drinking-from-a-fire-hose"><span class="header-section-number">2</span> Drinking from a fire hose</a></li>
<li><a class="nav-link" href="#hello-world"><span class="header-section-number">2.1</span> Hello, World!</a></li>
<li>
<a class="nav-link" href="#canadian-elections"><span class="header-section-number">2.2</span> Canadian elections</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#plan"><span class="header-section-number">2.2.1</span> Plan</a></li>
<li><a class="nav-link" href="#simulate"><span class="header-section-number">2.2.2</span> Simulate</a></li>
<li><a class="nav-link" href="#acquire"><span class="header-section-number">2.2.3</span> Acquire</a></li>
<li><a class="nav-link" href="#explore"><span class="header-section-number">2.2.4</span> Explore</a></li>
<li><a class="nav-link" href="#communicate"><span class="header-section-number">2.2.5</span> Communicate</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#toronto-homelessness"><span class="header-section-number">2.3</span> Toronto homelessness</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#plan-1"><span class="header-section-number">2.3.1</span> Plan</a></li>
<li><a class="nav-link" href="#simulate-1"><span class="header-section-number">2.3.2</span> Simulate</a></li>
<li><a class="nav-link" href="#acquire-1"><span class="header-section-number">2.3.3</span> Acquire</a></li>
<li><a class="nav-link" href="#explore-1"><span class="header-section-number">2.3.4</span> Explore</a></li>
<li><a class="nav-link" href="#communicate-1"><span class="header-section-number">2.3.5</span> Communicate</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#neonatal-mortality"><span class="header-section-number">2.4</span> Neonatal mortality</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#plan-2"><span class="header-section-number">2.4.1</span> Plan</a></li>
<li><a class="nav-link" href="#simulate-2"><span class="header-section-number">2.4.2</span> Simulate</a></li>
<li><a class="nav-link" href="#acquire-2"><span class="header-section-number">2.4.3</span> Acquire</a></li>
<li><a class="nav-link" href="#explore-2"><span class="header-section-number">2.4.4</span> Explore</a></li>
<li><a class="nav-link" href="#communicate-2"><span class="header-section-number">2.4.5</span> Communicate</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#exercises-and-tutorial-1"><span class="header-section-number">2.5</span> Exercises and tutorial</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#exercises-1"><span class="header-section-number">2.5.1</span> Exercises</a></li>
<li><a class="nav-link" href="#tutorial-1"><span class="header-section-number">2.5.2</span> Tutorial</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/rstudio/bookdown-demo/blob/master/02-drinking_from_a_fire_hose.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/rstudio/bookdown-demo/edit/master/02-drinking_from_a_fire_hose.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Telling Stories With Data</strong>" was written by Rohan Alexander. It was last built on 13 February, 2022.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
