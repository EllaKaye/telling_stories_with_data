<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 2 Drinking from a fire hose | Telling Stories With Data</title>
<meta name="author" content="Rohan Alexander">
<meta name="description" content="STATUS: Under construction. Required material Read Data science as an atomic habit, (Barrett 2021a) Read This is how AI bias really happens, (Hao 2019) Key concepts and skills The statistical...">
<meta name="generator" content="bookdown 0.22.17 with bs4_book()">
<meta property="og:title" content="Chapter 2 Drinking from a fire hose | Telling Stories With Data">
<meta property="og:type" content="book">
<meta property="og:image" content="/tellingstorieswithdatapainting.png">
<meta property="og:description" content="STATUS: Under construction. Required material Read Data science as an atomic habit, (Barrett 2021a) Read This is how AI bias really happens, (Hao 2019) Key concepts and skills The statistical...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 2 Drinking from a fire hose | Telling Stories With Data">
<meta name="twitter:description" content="STATUS: Under construction. Required material Read Data science as an atomic habit, (Barrett 2021a) Read This is how AI bias really happens, (Hao 2019) Key concepts and skills The statistical...">
<meta name="twitter:image" content="/tellingstorieswithdatapainting.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.10/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><link href="libs/_Atkinson%20Hyperlegible-0.4.0/font.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=IBM%20Plex%20Mono&amp;display=swap" rel="stylesheet">
<script src="libs/bs3compat-0.2.5.1/tabs.js"></script><script src="libs/bs3compat-0.2.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script><link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="libs/leaflet-1.3.1/leaflet.js"></script><link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="libs/proj4-2.6.2/proj4.min.js"></script><script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script><script src="libs/mapdeck-binding-0.3.4/mapdeck.js"></script><script src="libs/mpadeck_functions-0.0.1/mapdeck_functions.js"></script><script src="libs/deckgl-8.1.6/deckgl.min.js"></script><script src="libs/legend-0.0.1/legend.js"></script><script src="libs/title-0.0.1/title.js"></script><script src="libs/mapdeck_location-0.0.1/mapdeck_location.js"></script><script src="libs/mapdeck_colours-0.0.1/mapdeck_colours.js"></script><script src="libs/mapdeck_coordinates-0.0.1/mapdeck_coordinates.js"></script><link href="libs/mapboxgl-1.10.0/mapbox-gl.css" rel="stylesheet">
<script src="libs/mapboxgl-1.10.0/mapbox-gl.js"></script><link href="libs/mapdeck-0.0.1/mapdeck.css" rel="stylesheet">
<script src="libs/mpadeck-binding-0.3.4/mapdeck.js"></script><script src="libs/scatterplot-1.0.0/scatterplot.js"></script><script src="libs/viz-1.8.2/viz.js"></script><link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="bs4_style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Telling Stories With Data</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Preface</a></li>
<li><a class="" href="about-the-author.html">About the author</a></li>
<li class="book-part">Foundations</li>
<li><a class="" href="telling-stories-with-data.html"><span class="header-section-number">1</span> Telling Stories with Data</a></li>
<li><a class="active" href="drinking-from-a-fire-hose.html"><span class="header-section-number">2</span> Drinking from a fire hose</a></li>
<li><a class="" href="r-essentials.html"><span class="header-section-number">3</span> R Essentials</a></li>
<li><a class="" href="workflow.html"><span class="header-section-number">4</span> Workflow</a></li>
<li class="book-part">Communication</li>
<li><a class="" href="on-writing.html"><span class="header-section-number">5</span> On writing</a></li>
<li><a class="" href="static-communication.html"><span class="header-section-number">6</span> Static communication</a></li>
<li><a class="" href="interactive-communication.html"><span class="header-section-number">7</span> Interactive communication</a></li>
<li class="book-part">Measure and acquire</li>
<li><a class="" href="gather-data.html"><span class="header-section-number">8</span> Gather data</a></li>
<li><a class="" href="hunt-data.html"><span class="header-section-number">9</span> Hunt data</a></li>
<li><a class="" href="farm-data.html"><span class="header-section-number">10</span> Farm data</a></li>
<li class="book-part">Preparation</li>
<li><a class="" href="cleaning-and-preparing-data.html"><span class="header-section-number">11</span> Cleaning and preparing data</a></li>
<li><a class="" href="storing-and-retrieving-data.html"><span class="header-section-number">12</span> Storing and retrieving data</a></li>
<li><a class="" href="disseminating-and-protecting-data.html"><span class="header-section-number">13</span> Disseminating and protecting data</a></li>
<li class="book-part">Modelling</li>
<li><a class="" href="exploratory-data-analysis.html"><span class="header-section-number">14</span> Exploratory data analysis</a></li>
<li><a class="" href="ijalm.html"><span class="header-section-number">15</span> Itâ€™s Just A Linear Model</a></li>
<li><a class="" href="causality.html"><span class="header-section-number">16</span> Causality from observational data</a></li>
<li><a class="" href="mrp.html"><span class="header-section-number">17</span> Multilevel regression with post-stratification</a></li>
<li><a class="" href="text-as-data.html"><span class="header-section-number">18</span> Text as data</a></li>
<li class="book-part">Enrichment</li>
<li><a class="" href="using-the-cloud.html"><span class="header-section-number">19</span> Using the cloud</a></li>
<li><a class="" href="deploying-models.html"><span class="header-section-number">20</span> Deploying models</a></li>
<li><a class="" href="efficiency.html"><span class="header-section-number">21</span> Efficiency</a></li>
<li><a class="" href="concludingremarks.html"><span class="header-section-number">22</span> Concluding remarks, next steps, and open problems</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="oh-you-think-and-shoulders.html"><span class="header-section-number">A</span> Oh you think and shoulders</a></li>
<li><a class="" href="papers.html"><span class="header-section-number">B</span> Papers</a></li>
<li><a class="" href="references-1.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/rstudio/bookdown-demo">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="drinking-from-a-fire-hose" class="section level1" number="2">
<h1>
<span class="header-section-number">2</span> Drinking from a fire hose<a class="anchor" aria-label="anchor" href="#drinking-from-a-fire-hose"><i class="fas fa-link"></i></a>
</h1>
<p><strong>STATUS: Under construction.</strong></p>
<p><strong>Required material</strong></p>
<ul>
<li>Read <em>Data science as an atomic habit</em>, <span class="citation">(<a href="references-1.html#ref-citeBarrett" role="doc-biblioref">Barrett 2021a</a>)</span>
</li>
<li>Read <em>This is how AI bias really happens</em>, <span class="citation">(<a href="references-1.html#ref-hao2019" role="doc-biblioref">Hao 2019</a>)</span>
</li>
</ul>
<p><strong>Key concepts and skills</strong></p>
<ul>
<li>The statistical programming language R enables us to tell interesting stories using data.</li>
<li>It is a language like any other, and there is a slow path to mastery.</li>
<li>The way to learn is to start with a small project, and break down what is required to achieve it into tiny steps. Then look at other peopleâ€™s code to work out how you might deal with the steps. Copy, paste, and modify their code to achieve each step. Donâ€™t worry about perfection, just worry about achieving each step. Complete that project and move onto the next project. Rinse and repeat. Each project youâ€™ll get a little better.</li>
<li>The key is to just start.</li>
</ul>
<p><strong>Key libraries</strong></p>
<ul>
<li>
<code>ggplot2</code> <span class="citation">(<a href="references-1.html#ref-citeggplot" role="doc-biblioref">Wickham 2016</a>)</span>
</li>
<li>
<code>tidyverse</code> <span class="citation">(<a href="references-1.html#ref-Wickham2017" role="doc-biblioref">Wickham 2017</a>)</span>
</li>
</ul>
<p><strong>Key functions</strong></p>
<ul>
<li>
<code><a href="https://rdrr.io/pkg/janitor/man/pipe.html">%&gt;%</a></code> â€˜pipeâ€™</li>
<li><code><a href="https://dplyr.tidyverse.org/reference/arrange.html">dplyr::arrange()</a></code></li>
<li><code><a href="https://dplyr.tidyverse.org/reference/filter.html">dplyr::filter()</a></code></li>
<li><code><a href="https://dplyr.tidyverse.org/reference/group_by.html">dplyr::group_by()</a></code></li>
<li><code><a href="https://dplyr.tidyverse.org/reference/mutate.html">dplyr::mutate()</a></code></li>
<li><code><a href="https://dplyr.tidyverse.org/reference/select.html">dplyr::select()</a></code></li>
<li><code><a href="https://dplyr.tidyverse.org/reference/summarise.html">dplyr::summarise()</a></code></li>
<li><code><a href="https://dplyr.tidyverse.org/reference/group_by.html">dplyr::ungroup()</a></code></li>
<li><code>ggplot::facet_wrap()</code></li>
<li><code>ggplot::geom_histogram()</code></li>
</ul>
<div id="hello-world" class="section level2" number="2.1">
<h2>
<span class="header-section-number">2.1</span> Hello, World!<a class="anchor" aria-label="anchor" href="#hello-world"><i class="fas fa-link"></i></a>
</h2>
<p>The way to start is to start. In this chapter we go through three complete examples of the workflow advocated in this book. This means we will: plan, simulate, acquire, model, and communicate. If you are new to R, then some of the code may be a bit unfamiliar to you. If you are new to statistical modelling, then some of the concepts may be unfamiliar. Do not worry. It will all soon be familiar.</p>
<p>The only way to learn how to tell stories, is to start telling stories yourself. This means that you should try to get these examples working. Do the sketches yourself, type everything out yourself (possibly using R Studio Cloud), and execute it all. It is important, and normal, to realise that you are going to be bad at this for a while.</p>
<blockquote>
<p>Whenever youâ€™re learning a new tool, for a long time, youâ€™re going to suckâ€¦ But the good news is that is typical; thatâ€™s something that happens to everyone, and itâ€™s only temporary.</p>
<p>Hadley Wickham as quoted by <span class="citation"><a href="references-1.html#ref-citeBarrett" role="doc-biblioref">Barrett</a> (<a href="references-1.html#ref-citeBarrett" role="doc-biblioref">2021a</a>)</span>.</p>
</blockquote>
<p>Although you will be guided thoroughly to achieve this, hopefully by seeing the power of telling stories with data here, you will be empowered to stick with it when you run into difficulties later on.</p>
</div>
<div id="canadian-elections" class="section level2" number="2.2">
<h2>
<span class="header-section-number">2.2</span> Canadian elections<a class="anchor" aria-label="anchor" href="#canadian-elections"><i class="fas fa-link"></i></a>
</h2>
<div id="getting-started" class="section level3" number="2.2.1">
<h3>
<span class="header-section-number">2.2.1</span> Getting started<a class="anchor" aria-label="anchor" href="#getting-started"><i class="fas fa-link"></i></a>
</h3>
<p>To get started you should open a new R Markdown file (File -&gt; New File -&gt; R Markdown). As this is our first attempt at using R in the wild, we will just have everything in the one R Markdown document. (In later projects we will move to a more robust set-up.) Then you should create a new R code chunk (keyboard shortcut: Command + Option + I) and add some preamble documentation. I like to specify the purpose of the document, who the author is and their contact details, when the file was written or last updated, and pre-requisites that the file relies on. You may also like to include a license, and list outstanding issues or todos. Remember that in R, lines that start with â€˜#â€™ are comments - they wonâ€™t run.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#### Preamble ####</span>
<span class="co"># Purpose: Read in voting data from the 2019 Canadian Election and output a </span>
<span class="co"># dataset that can be used for analysis.</span>
<span class="co"># Author: Rohan Alexander</span>
<span class="co"># Email: rohan.alexander@utoronto.ca</span>
<span class="co"># Date: 9 January 2019</span>
<span class="co"># Prerequisites: Need the text file from the Canadian elections website</span>
<span class="co"># Issues: </span>
<span class="co"># To do:</span></code></pre></div>
<p>After this I typically set-up my workspace. This usually involves installing and/or reading in any packages, and possibly updating them. Remember that you only need to install a package once for each computer. But you need to call it every time you want to use it. (Here Iâ€™ve added excessive comments so that you know what is going on and why - in general I wouldnâ€™t explain what tidyverse is.)</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#### Workspace set-up ####</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"tidyverse"</span><span class="op">)</span> <span class="co"># Only need to do this once</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"janitor"</span><span class="op">)</span> <span class="co"># Only need to do this once</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"here"</span><span class="op">)</span> </code></pre></div>
<p>In this case we are going to use <code>tidyverse</code> <span class="citation"><a href="references-1.html#ref-Wickham2017" role="doc-biblioref">Wickham</a> (<a href="references-1.html#ref-Wickham2017" role="doc-biblioref">2017</a>)</span>, <code>janitor</code> <span class="citation"><a href="references-1.html#ref-janitor" role="doc-biblioref">Firke</a> (<a href="references-1.html#ref-janitor" role="doc-biblioref">2020</a>)</span>, and <code>here</code> <span class="citation"><a href="references-1.html#ref-here" role="doc-biblioref">MÃ¼ller</a> (<a href="references-1.html#ref-here" role="doc-biblioref">2017a</a>)</span>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#### Workspace set-up ####</span>
<span class="co"># tidyverse is a collection of packages</span>
<span class="co"># Try ?tidyverse to see more</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span> <span class="co"># Calls the tidyverse - need to do this each time.</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sfirke/janitor">janitor</a></span><span class="op">)</span> <span class="co"># janitor helps us clean datasets</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://here.r-lib.org/">here</a></span><span class="op">)</span> <span class="co"># here helps us to know where files are</span>
<span class="co"># update.packages() # You can uncomment this if you want to update your packages. </span></code></pre></div>
</div>
<div id="get-the-data" class="section level3" number="2.2.2">
<h3>
<span class="header-section-number">2.2.2</span> Get the data<a class="anchor" aria-label="anchor" href="#get-the-data"><i class="fas fa-link"></i></a>
</h3>
<p>We read in the dataset from the Elections Canada website. We can actually pass a website to the <code>read_tsv()</code> function, which saves a lot of time.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#### Read in the data ####</span>
<span class="co"># Read in the data using read_tsv from the readr package (part of the tidyverse)</span>
<span class="co"># The '&lt;-' is assigning the output of readr::read_tsv to a object called raw_data. </span>
<span class="va">raw_elections_data</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_tsv</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"http://enr.elections.ca/DownloadResults.aspx"</span>,
                            skip <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> 
<span class="co"># There is some debris on the first line so we skip them.</span>
<span class="co"># We have read the data from the Elections Canada website. We may like to save </span>
<span class="co"># it just in case something happens and they move it. </span>
<span class="fu">write_csv</span><span class="op">(</span><span class="va">raw_elections_data</span>, <span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"inputs/data/canadian_voting.csv"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>(Note that Elections Canada updates this link with the latest elections. When I run this on 31 December 2020, I get the results of a Toronto by-election. While Iâ€™ll certainly update these notes from time to time, it may be that thereâ€™s been an election between now and when you run these notes, so your specific results may be slightly different.)</p>
</div>
<div id="clean-the-data" class="section level3" number="2.2.3">
<h3>
<span class="header-section-number">2.2.3</span> Clean the data<a class="anchor" aria-label="anchor" href="#clean-the-data"><i class="fas fa-link"></i></a>
</h3>
<p>Now weâ€™d like to clean the data so that we can use it.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#### Basic cleaning ####</span>
<span class="va">raw_elections_data</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"inputs/data/canadian_voting.csv"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Rows: 33 Columns: 14</span>
<span class="co">#&gt; â”€â”€ Column specification â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="co">#&gt; Delimiter: ","</span>
<span class="co">#&gt; chr (9): Electoral district number - NumÃ©ro de la circon...</span>
<span class="co">#&gt; dbl (4): Votes obtained - Votes obtenus, % Votes obtaine...</span>
<span class="co">#&gt; lgl (1): Middle name(s) - Autre(s) prÃ©nom(s)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; â„¹ Use `spec()` to retrieve the full column specification for this data.</span>
<span class="co">#&gt; â„¹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</span>
<span class="co"># If you called the library (as we did) then you don't need to use this set-up </span>
<span class="co"># of janitor::clean_names, you could just use clean_names, but I'm making it </span>
<span class="co"># explicit here, but won't in the future.</span>
<span class="va">cleaned_elections_data</span> <span class="op">&lt;-</span> <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/janitor/man/clean_names.html">clean_names</a></span><span class="op">(</span><span class="va">raw_elections_data</span><span class="op">)</span>
<span class="co"># One thing to notice for those who have a Stata background is that we just </span>
<span class="co"># overwrote the name - that's fine in R.</span>

<span class="co"># The pipe operator - %&gt;% - pushes the output from one line to be an input to the </span>
<span class="co"># next line.</span>
<span class="va">cleaned_elections_data</span> <span class="op">&lt;-</span> 
  <span class="va">cleaned_elections_data</span> <span class="op">%&gt;%</span> 
  <span class="co"># Filter to only have certain rows</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">type_of_results</span> <span class="op">==</span> <span class="st">"validated"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># Select only certain columns</span>
  <span class="fu">select</span><span class="op">(</span><span class="va">electoral_district_number_numero_de_la_circonscription</span>,
         <span class="va">electoral_district_name</span>,
         <span class="va">political_affiliation</span>,
         <span class="va">surname_nom_de_famille</span>,
         <span class="va">percent_votes_obtained_votes_obtenus_percent</span>
         <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># Rename the columns to be a bit shorter</span>
  <span class="fu">rename</span><span class="op">(</span>riding_number <span class="op">=</span> <span class="va">electoral_district_number_numero_de_la_circonscription</span>,
         riding <span class="op">=</span> <span class="va">electoral_district_name</span>,
         party <span class="op">=</span> <span class="va">political_affiliation</span>,
         surname <span class="op">=</span> <span class="va">surname_nom_de_famille</span>,
         votes <span class="op">=</span> <span class="va">percent_votes_obtained_votes_obtenus_percent</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">cleaned_elections_data</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 Ã— 5</span>
<span class="co">#&gt;   riding_number riding         party          surname  votes</span>
<span class="co">#&gt;   &lt;chr&gt;         &lt;chr&gt;          &lt;chr&gt;          &lt;chr&gt;    &lt;dbl&gt;</span>
<span class="co">#&gt; 1 35108         Toronto Centre People's Partâ€¦ Bawa       1.1</span>
<span class="co">#&gt; 2 35108         Toronto Centre Free Party Caâ€¦ Cappellâ€¦   0.3</span>
<span class="co">#&gt; 3 35108         Toronto Centre NDP-New Democâ€¦ Chang     17  </span>
<span class="co">#&gt; 4 35108         Toronto Centre Independent    Clarke     0.5</span>
<span class="co">#&gt; 5 35108         Toronto Centre Liberal        Ien       42  </span>
<span class="co">#&gt; 6 35108         Toronto Centre Libertarian    Komar      0.5</span></code></pre></div>
<p>Finally we may like to save our cleaned dataset.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#### Save ####</span>
<span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html">write_csv</a></span><span class="op">(</span><span class="va">cleaned_elections_data</span>, <span class="st">"outputs/data/cleaned_elections_data.csv"</span><span class="op">)</span></code></pre></div>
</div>
<div id="make-a-graph" class="section level3" number="2.2.4">
<h3>
<span class="header-section-number">2.2.4</span> Make a graph<a class="anchor" aria-label="anchor" href="#make-a-graph"><i class="fas fa-link"></i></a>
</h3>
<p>First we need to read in the dataset, we then filter the number of parties to a smaller number.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#### Read in the data ####</span>
<span class="va">cleaned_elections_data</span> <span class="op">&lt;-</span> 
  <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"outputs/data/cleaned_elections_data.csv"</span><span class="op">)</span>
<span class="co">#&gt; Rows: 15 Columns: 5</span>
<span class="co">#&gt; â”€â”€ Column specification â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="co">#&gt; Delimiter: ","</span>
<span class="co">#&gt; chr (3): riding, party, surname</span>
<span class="co">#&gt; dbl (2): riding_number, votes</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; â„¹ Use `spec()` to retrieve the full column specification for this data.</span>
<span class="co">#&gt; â„¹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</span>

<span class="co"># Make a graph just considers Toronto riding</span>
<span class="va">cleaned_elections_data</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">party</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Bloc QuÃ©bÃ©cois"</span>, 
                      <span class="st">"Conservative"</span>, 
                      <span class="st">"Liberal"</span>,
                      <span class="st">"NDP-New Democratic Party"</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">riding</span>, y <span class="op">=</span> <span class="va">votes</span>, color <span class="op">=</span> <span class="va">party</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="co"># Make the theme neater</span>
  <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="co"># Change the angle</span>
  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Riding"</span>,
       y <span class="op">=</span> <span class="st">"Votes (%)"</span>,
       color <span class="op">=</span> <span class="st">"Party"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-drinking_from_a_fire_hose_files/figure-html/unnamed-chunk-8-1.png" width="672"></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># Save the graph</span>
<span class="fu">ggsave</span><span class="op">(</span><span class="st">"outputs/figures/toronto_results.pdf"</span>, width <span class="op">=</span> <span class="fl">40</span>, height <span class="op">=</span> <span class="fl">20</span>, units <span class="op">=</span> <span class="st">"cm"</span><span class="op">)</span></code></pre></div>
</div>
<div id="make-a-table" class="section level3" number="2.2.5">
<h3>
<span class="header-section-number">2.2.5</span> Make a table<a class="anchor" aria-label="anchor" href="#make-a-table"><i class="fas fa-link"></i></a>
</h3>
<p>There are an awful lot of ways to make a table in R. First weâ€™ll try the built-in function <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#### Read in the data ####</span>
<span class="va">cleaned_elections_data</span> <span class="op">&lt;-</span> 
  <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"outputs/data/cleaned_elections_data.csv"</span><span class="op">)</span>
<span class="co">#&gt; Rows: 15 Columns: 5</span>
<span class="co">#&gt; â”€â”€ Column specification â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="co">#&gt; Delimiter: ","</span>
<span class="co">#&gt; chr (3): riding, party, surname</span>
<span class="co">#&gt; dbl (2): riding_number, votes</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; â„¹ Use `spec()` to retrieve the full column specification for this data.</span>
<span class="co">#&gt; â„¹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</span>

<span class="co">#### Make some tables ####</span>
<span class="co"># Try some different default summary table</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">cleaned_elections_data</span><span class="op">)</span>
<span class="co">#&gt;  riding_number      riding             party          </span>
<span class="co">#&gt;  Min.   :35108   Length:15          Length:15         </span>
<span class="co">#&gt;  1st Qu.:35108   Class :character   Class :character  </span>
<span class="co">#&gt;  Median :35108   Mode  :character   Mode  :character  </span>
<span class="co">#&gt;  Mean   :35112                                        </span>
<span class="co">#&gt;  3rd Qu.:35118                                        </span>
<span class="co">#&gt;  Max.   :35118                                        </span>
<span class="co">#&gt;    surname              votes      </span>
<span class="co">#&gt;  Length:15          Min.   : 0.20  </span>
<span class="co">#&gt;  Class :character   1st Qu.: 0.55  </span>
<span class="co">#&gt;  Mode  :character   Median : 3.60  </span>
<span class="co">#&gt;                     Mean   :13.34  </span>
<span class="co">#&gt;                     3rd Qu.:24.85  </span>
<span class="co">#&gt;                     Max.   :45.70</span></code></pre></div>
<p>Now we can try a <code>group_by()</code> and <code>summarise()</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Make our own</span>
<span class="va">cleaned_elections_data</span> <span class="op">%&gt;%</span> 
  <span class="co"># Using group_by and summarise means that whatever summary statistics we </span>
  <span class="co"># construct will be on a party basis. We could group_by multiple variables and</span>
  <span class="co"># similarly, we could create a bunch of different other summary statistics.</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">party</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">summarise</span><span class="op">(</span>min <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">votes</span><span class="op">)</span>,
            mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">votes</span><span class="op">)</span>,
            max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">votes</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 9 Ã— 4</span>
<span class="co">#&gt;   party                      min  mean   max</span>
<span class="co">#&gt;   &lt;chr&gt;                    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1 Conservative               5.7 23.8   41.8</span>
<span class="co">#&gt; 2 Free Party Canada          0.3  0.3    0.3</span>
<span class="co">#&gt; 3 Green Party                2.6 17.7   32.7</span>
<span class="co">#&gt; 4 Independent                0.5  0.55   0.6</span>
<span class="co">#&gt; 5 Liberal                   42   43.8   45.7</span>
<span class="co">#&gt; 6 Libertarian                0.5  0.5    0.5</span>
<span class="co">#&gt; 7 NDP-New Democratic Party   5.8 11.4   17  </span>
<span class="co">#&gt; 8 No Affiliation             0.2  0.2    0.2</span>
<span class="co">#&gt; 9 People's Party - PPC       1.1  2.35   3.6</span></code></pre></div>
</div>
</div>
<div id="kenyan-populations" class="section level2" number="2.3">
<h2>
<span class="header-section-number">2.3</span> Kenyan populations<a class="anchor" aria-label="anchor" href="#kenyan-populations"><i class="fas fa-link"></i></a>
</h2>
</div>
<div id="us-tax-rates" class="section level2" number="2.4">
<h2>
<span class="header-section-number">2.4</span> US tax rates<a class="anchor" aria-label="anchor" href="#us-tax-rates"><i class="fas fa-link"></i></a>
</h2>
</div>
<div id="uk-something" class="section level2" number="2.5">
<h2>
<span class="header-section-number">2.5</span> UK something!<a class="anchor" aria-label="anchor" href="#uk-something"><i class="fas fa-link"></i></a>
</h2>
</div>
<div id="australian-baby-names" class="section level2" number="2.6">
<h2>
<span class="header-section-number">2.6</span> Australian baby names<a class="anchor" aria-label="anchor" href="#australian-baby-names"><i class="fas fa-link"></i></a>
</h2>
</div>
<div id="toronto-homelessness" class="section level2" number="2.7">
<h2>
<span class="header-section-number">2.7</span> Toronto homelessness<a class="anchor" aria-label="anchor" href="#toronto-homelessness"><i class="fas fa-link"></i></a>
</h2>
<p>Toronto has a large homeless population, and of course given the pandemic and winter it is critical that there are enough places in shelters. Unfortunately, as we will see in this case study, there are not enough places. However, the one good thing is that we have the data to see this is a problem.</p>
<p>In this case study we are going to use data on the number of people in Toronto shelters to make a graph of usage. This will also introduce us to Tidy Tuesday! In my experience, people are most successful at â€˜learning Râ€™ when they are learning it to achieve something else. If youâ€™re in a university course then that might be â€˜pass the course,â€™ but often itâ€™s nice to have some other projects. TidyTuesday is a weekly event in which the R community comes together around a dataset and shares code and approaches. You can learn more about it here: <a href="https://github.com/rfordatascience/tidytuesday" class="uri">https://github.com/rfordatascience/tidytuesday</a>.</p>
<div id="getting-started-1" class="section level3" number="2.7.1">
<h3>
<span class="header-section-number">2.7.1</span> Getting started<a class="anchor" aria-label="anchor" href="#getting-started-1"><i class="fas fa-link"></i></a>
</h3>
<p>Again, open a new R Markdown file: (File -&gt; New File -&gt; R Markdown). Update the details so that they reflect your own.</p>
<p>Again, add some top matter with some comments and explanations of the code.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#### Preamble ####</span>
<span class="co"># Purpose: Read in Toronto homelessness data and output a graph.</span>
<span class="co"># Author: Rohan Alexander</span>
<span class="co"># Email: rohan.alexander@utoronto.ca</span>
<span class="co"># Date: 22 December 2020</span>
<span class="co"># Prerequisites: </span>
<span class="co"># Issues: </span>
<span class="co"># To do:</span></code></pre></div>
<p>I want to talk a little about the libraries this time. Libraries are bits of code that other people have written. There are a few common ones that youâ€™ll see regularly, especially the <code>tidyverse</code>. To use a package we first have to install it and then we need to load it. Jenny Bryan has a wonderful analogy of installing a lightbulb - <code><a href="https://rdrr.io/r/utils/install.packages.html">install.packages("tidyverse")</a></code>. You only need to do this once, but then if you want light then you need to turn on the switch - <code><a href="https://tidyverse.tidyverse.org">library(tidyverse)</a></code>. So because we installed everything earlier we wonâ€™t need to do it again, we can just call the library.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#### Workspace set-up ####</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></code></pre></div>
<p>Given that a lot of people gave up their time to make <code>R</code> and the packages, itâ€™s important to cite them. Luckily, itâ€™s easy to get the information that you need to properly cite them.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># To get the citation for R run:</span>
<span class="fu"><a href="https://rdrr.io/r/utils/citation.html">citation</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; To cite R in publications use:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   R Core Team (2020). R: A language and environment</span>
<span class="co">#&gt;   for statistical computing. R Foundation for</span>
<span class="co">#&gt;   Statistical Computing, Vienna, Austria. URL</span>
<span class="co">#&gt;   https://www.R-project.org/.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; A BibTeX entry for LaTeX users is</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   @Manual{,</span>
<span class="co">#&gt;     title = {R: A Language and Environment for Statistical Computing},</span>
<span class="co">#&gt;     author = {{R Core Team}},</span>
<span class="co">#&gt;     organization = {R Foundation for Statistical Computing},</span>
<span class="co">#&gt;     address = {Vienna, Austria},</span>
<span class="co">#&gt;     year = {2020},</span>
<span class="co">#&gt;     url = {https://www.R-project.org/},</span>
<span class="co">#&gt;   }</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; We have invested a lot of time and effort in creating</span>
<span class="co">#&gt; R, please cite it when using it for data analysis.</span>
<span class="co">#&gt; See also 'citation("pkgname")' for citing R packages.</span>
<span class="co"># And to get the citation for a package run that function with the package name. For instance:</span>
<span class="fu"><a href="https://rdrr.io/r/utils/citation.html">citation</a></span><span class="op">(</span><span class="st">'tidyverse'</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   Wickham et al., (2019). Welcome to the tidyverse.</span>
<span class="co">#&gt;   Journal of Open Source Software, 4(43), 1686,</span>
<span class="co">#&gt;   https://doi.org/10.21105/joss.01686</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; A BibTeX entry for LaTeX users is</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   @Article{,</span>
<span class="co">#&gt;     title = {Welcome to the {tidyverse}},</span>
<span class="co">#&gt;     author = {Hadley Wickham and Mara Averick and Jennifer Bryan and Winston Chang and Lucy D'Agostino McGowan and Romain FranÃ§ois and Garrett Grolemund and Alex Hayes and Lionel Henry and Jim Hester and Max Kuhn and Thomas Lin Pedersen and Evan Miller and Stephan Milton Bache and Kirill MÃ¼ller and Jeroen Ooms and David Robinson and Dana Paige Seidel and Vitalie Spinu and Kohske Takahashi and Davis Vaughan and Claus Wilke and Kara Woo and Hiroaki Yutani},</span>
<span class="co">#&gt;     year = {2019},</span>
<span class="co">#&gt;     journal = {Journal of Open Source Software},</span>
<span class="co">#&gt;     volume = {4},</span>
<span class="co">#&gt;     number = {43},</span>
<span class="co">#&gt;     pages = {1686},</span>
<span class="co">#&gt;     doi = {10.21105/joss.01686},</span>
<span class="co">#&gt;   }</span>
<span class="co"># Again, don't worry too much about the details - we'll get into them later.</span></code></pre></div>
</div>
<div id="get-the-data-1" class="section level3" number="2.7.2">
<h3>
<span class="header-section-number">2.7.2</span> Get the data<a class="anchor" aria-label="anchor" href="#get-the-data-1"><i class="fas fa-link"></i></a>
</h3>
<p>We are going to grab some data that has been made available about Toronto homeless shelters. Again, donâ€™t worry too much about the details for now, but what we are saying here, is that thereâ€™s a CSV that has been made available to us on GitHub and this code downloads it to our own computer. After we download it we can quickly look at the data using <code><a href="https://rdrr.io/r/utils/head.html">head()</a></code>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">toronto_shelters</span> <span class="op">&lt;-</span> 
  <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span>
    <span class="st">'https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-12-01/shelters.csv'</span>
    <span class="op">)</span>
<span class="co">#&gt; Rows: 115916 Columns: 13</span>
<span class="co">#&gt; â”€â”€ Column specification â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="co">#&gt; Delimiter: ","</span>
<span class="co">#&gt; chr  (9): organization_name, shelter_name, shelter_addre...</span>
<span class="co">#&gt; dbl  (3): id, occupancy, capacity</span>
<span class="co">#&gt; dttm (1): occupancy_date</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; â„¹ Use `spec()` to retrieve the full column specification for this data.</span>
<span class="co">#&gt; â„¹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">toronto_shelters</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 Ã— 13</span>
<span class="co">#&gt;      id occupancy_date      organization_name  shelter_name </span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;dttm&gt;              &lt;chr&gt;              &lt;chr&gt;        </span>
<span class="co">#&gt; 1     1 2017-01-01 00:00:00 COSTI Immigrant Sâ€¦ COSTI Receptâ€¦</span>
<span class="co">#&gt; 2     2 2017-01-01 00:00:00 Christie Ossingtoâ€¦ Christie Ossâ€¦</span>
<span class="co">#&gt; 3     3 2017-01-01 00:00:00 Christie Ossingtoâ€¦ Christie Ossâ€¦</span>
<span class="co">#&gt; 4     4 2017-01-01 00:00:00 Christie Refugee â€¦ Christie Refâ€¦</span>
<span class="co">#&gt; 5     5 2017-01-01 00:00:00 City of Toronto    Birchmount Râ€¦</span>
<span class="co">#&gt; 6     6 2017-01-01 00:00:00 City of Toronto    Birkdale Resâ€¦</span>
<span class="co">#&gt; # â€¦ with 9 more variables: shelter_address &lt;chr&gt;,</span>
<span class="co">#&gt; #   shelter_city &lt;chr&gt;, shelter_province &lt;chr&gt;,</span>
<span class="co">#&gt; #   shelter_postal_code &lt;chr&gt;, facility_name &lt;chr&gt;,</span>
<span class="co">#&gt; #   program_name &lt;chr&gt;, sector &lt;chr&gt;, occupancy &lt;dbl&gt;,</span>
<span class="co">#&gt; #   capacity &lt;dbl&gt;</span></code></pre></div>
</div>
<div id="make-a-graph-1" class="section level3" number="2.7.3">
<h3>
<span class="header-section-number">2.7.3</span> Make a graph<a class="anchor" aria-label="anchor" href="#make-a-graph-1"><i class="fas fa-link"></i></a>
</h3>
<p>The dataset is on a daily basis for each shelter. What Iâ€™d like to do is to get an overall picture of the availability of shelter places in Toronto. This code is based on code by <a href="https://florencevdubois.github.io">Florence VallÃ©e-Dubois</a><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://github.com/florencevdubois/MyTidyTuesdays/blob/master/2020.12.01.R" class="uri"&gt;https://github.com/florencevdubois/MyTidyTuesdays/blob/master/2020.12.01.R&lt;/a&gt;&lt;/p&gt;'><sup>1</sup></a> and <a href="https://lisalendway.netlify.app">Lisa Lendway</a><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://github.com/llendway/tidy_tuesday_in_thirty/blob/main/2020_12_01_tidy_tuesday.Rmd" class="uri"&gt;https://github.com/llendway/tidy_tuesday_in_thirty/blob/main/2020_12_01_tidy_tuesday.Rmd&lt;/a&gt;&lt;/p&gt;'><sup>2</sup></a>.</p>
<p>Now, Iâ€™d like to first do some data manipulation before we graph it this time. Iâ€™m going to introduce a few new functions here that weâ€™ll see a lot more soon. Again, donâ€™t worry if this doesnâ€™t all make sense right now. Youâ€™re learning a brand-new language! Just try to focus on picking up a word or two and staying motivated!</p>
<p>Finally, because itâ€™s Christmas, we can grab a <a href="https://github.com/elb0/decemberLB">seasonally-appropriate theme</a> from my colleague <a href="https://twitter.com/liza_bolton">Liza Bolton</a>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># In contrast to the earlier packages, which were located in a central repository </span>
<span class="co"># of packages called CRAN, Liza's is available on her GitHub. Again, don't worry </span>
<span class="co"># about the details for now, it'll all be clarified later.</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span><span class="op">(</span><span class="st">"elb0/decemberLB"</span>, ref <span class="op">=</span> <span class="st">"main"</span><span class="op">)</span>
<span class="co">#&gt; Using github PAT from envvar GITHUB_PAT</span>
<span class="co">#&gt; Skipping install of 'decemberLB' from a github remote, the SHA1 (2cc38a25) has not changed since last install.</span>
<span class="co">#&gt;   Use `force = TRUE` to force installation</span>

<span class="co"># Once it's installed we call the library as usual.</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">decemberLB</span><span class="op">)</span>

<span class="va">toronto_shelters</span> <span class="op">%&gt;%</span> 
  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="va">occupancy</span>, <span class="va">capacity</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co"># We only want rows that have data</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">occupancy_date</span>, <span class="va">sector</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co"># We want to know the occupancy by date and sector</span>
  <span class="fu">summarise</span><span class="op">(</span>the_sum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">occupancy</span><span class="op">)</span>,
            the_capacity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">capacity</span><span class="op">)</span>,
            the_usage <span class="op">=</span> <span class="va">the_sum</span> <span class="op">/</span> <span class="va">the_capacity</span>, .groups <span class="op">=</span> <span class="st">'drop'</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">occupancy_date</span>, y <span class="op">=</span> <span class="va">the_usage</span>, color <span class="op">=</span> <span class="va">sector</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_smooth</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>group <span class="op">=</span> <span class="va">sector</span><span class="op">)</span>, se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_y_continuous</span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"Type"</span>,
       x <span class="op">=</span> <span class="st">"Date"</span>,
       y <span class="op">=</span> <span class="st">"Occupancy rate"</span>,
       title <span class="op">=</span> <span class="st">"Toronto shelters"</span>,
       subtitle <span class="op">=</span> <span class="st">"Occupancy per day"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/decemberLB/man/scale_color_december.html">scale_color_december</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"xmas"</span><span class="op">)</span>
<span class="co">#&gt; `geom_smooth()` using method = 'gam' and formula 'y ~ s(x, bs = "cs")'</span></code></pre></div>
<div class="inline-figure"><img src="02-drinking_from_a_fire_hose_files/figure-html/unnamed-chunk-15-1.png" width="672"></div>
</div>
</div>
<div id="exercises-and-tutorial-1" class="section level2" number="2.8">
<h2>
<span class="header-section-number">2.8</span> Exercises and tutorial<a class="anchor" aria-label="anchor" href="#exercises-and-tutorial-1"><i class="fas fa-link"></i></a>
</h2>
<div id="exercises-1" class="section level3" number="2.8.1">
<h3>
<span class="header-section-number">2.8.1</span> Exercises<a class="anchor" aria-label="anchor" href="#exercises-1"><i class="fas fa-link"></i></a>
</h3>
</div>
<div id="tutorial-1" class="section level3" number="2.8.2">
<h3>
<span class="header-section-number">2.8.2</span> Tutorial<a class="anchor" aria-label="anchor" href="#tutorial-1"><i class="fas fa-link"></i></a>
</h3>

</div>
</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="telling-stories-with-data.html"><span class="header-section-number">1</span> Telling Stories with Data</a></div>
<div class="next"><a href="r-essentials.html"><span class="header-section-number">3</span> R Essentials</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#drinking-from-a-fire-hose"><span class="header-section-number">2</span> Drinking from a fire hose</a></li>
<li><a class="nav-link" href="#hello-world"><span class="header-section-number">2.1</span> Hello, World!</a></li>
<li>
<a class="nav-link" href="#canadian-elections"><span class="header-section-number">2.2</span> Canadian elections</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#getting-started"><span class="header-section-number">2.2.1</span> Getting started</a></li>
<li><a class="nav-link" href="#get-the-data"><span class="header-section-number">2.2.2</span> Get the data</a></li>
<li><a class="nav-link" href="#clean-the-data"><span class="header-section-number">2.2.3</span> Clean the data</a></li>
<li><a class="nav-link" href="#make-a-graph"><span class="header-section-number">2.2.4</span> Make a graph</a></li>
<li><a class="nav-link" href="#make-a-table"><span class="header-section-number">2.2.5</span> Make a table</a></li>
</ul>
</li>
<li><a class="nav-link" href="#kenyan-populations"><span class="header-section-number">2.3</span> Kenyan populations</a></li>
<li><a class="nav-link" href="#us-tax-rates"><span class="header-section-number">2.4</span> US tax rates</a></li>
<li><a class="nav-link" href="#uk-something"><span class="header-section-number">2.5</span> UK something!</a></li>
<li><a class="nav-link" href="#australian-baby-names"><span class="header-section-number">2.6</span> Australian baby names</a></li>
<li>
<a class="nav-link" href="#toronto-homelessness"><span class="header-section-number">2.7</span> Toronto homelessness</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#getting-started-1"><span class="header-section-number">2.7.1</span> Getting started</a></li>
<li><a class="nav-link" href="#get-the-data-1"><span class="header-section-number">2.7.2</span> Get the data</a></li>
<li><a class="nav-link" href="#make-a-graph-1"><span class="header-section-number">2.7.3</span> Make a graph</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#exercises-and-tutorial-1"><span class="header-section-number">2.8</span> Exercises and tutorial</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#exercises-1"><span class="header-section-number">2.8.1</span> Exercises</a></li>
<li><a class="nav-link" href="#tutorial-1"><span class="header-section-number">2.8.2</span> Tutorial</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/rstudio/bookdown-demo/blob/master/02-drinking_from_a_fire_hose.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/rstudio/bookdown-demo/edit/master/02-drinking_from_a_fire_hose.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Telling Stories With Data</strong>" was written by Rohan Alexander. It was last built on 24 August, 2021.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
