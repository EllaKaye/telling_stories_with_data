<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 14 It’s Just A Linear Model | Telling Stories With Data</title>
  <meta name="description" content="This book is about learning how to tell stories with data." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 14 It’s Just A Linear Model | Telling Stories With Data" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book is about learning how to tell stories with data." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 14 It’s Just A Linear Model | Telling Stories With Data" />
  
  <meta name="twitter:description" content="This book is about learning how to tell stories with data." />
  

<meta name="author" content="Rohan Alexander" />


<meta name="date" content="2021-04-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="exploratory-data-analysis.html"/>
<link rel="next" href="causality-from-observational-data.html"/>
<script src="libs/header-attrs-2.7.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script>
<script src="libs/mapdeck-binding-0.3.4/mapdeck.js"></script>
<script src="libs/mpadeck_functions-0.0.1/mapdeck_functions.js"></script>
<script src="libs/deckgl-8.1.6/deckgl.min.js"></script>
<script src="libs/legend-0.0.1/legend.js"></script>
<script src="libs/title-0.0.1/title.js"></script>
<script src="libs/mapdeck_location-0.0.1/mapdeck_location.js"></script>
<script src="libs/mapdeck_colours-0.0.1/mapdeck_colours.js"></script>
<script src="libs/mapdeck_coordinates-0.0.1/mapdeck_coordinates.js"></script>
<link href="libs/mapboxgl-1.10.0/mapbox-gl.css" rel="stylesheet" />
<script src="libs/mapboxgl-1.10.0/mapbox-gl.js"></script>
<link href="libs/mapdeck-0.0.1/mapdeck.css" rel="stylesheet" />
<script src="libs/mpadeck-binding-0.3.4/mapdeck.js"></script>
<script src="libs/arc-1.0.0/arc.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Telling Stories With Data</a></li>

<li class="divider"></li>
<li class="part"><span><b>I Essentials</b></span></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#welcome"><i class="fa fa-check"></i><b>1.1</b> Welcome</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#structure"><i class="fa fa-check"></i><b>1.2</b> Structure</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#on-telling-stories"><i class="fa fa-check"></i><b>1.3</b> On telling stories</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#telling-stories-with-data"><i class="fa fa-check"></i><b>1.4</b> Telling stories with data</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="index.html"><a href="index.html#software"><i class="fa fa-check"></i><b>1.4.1</b> Software</a></li>
<li class="chapter" data-level="1.4.2" data-path="index.html"><a href="index.html#assumed-background"><i class="fa fa-check"></i><b>1.4.2</b> Assumed background</a></li>
<li class="chapter" data-level="1.4.3" data-path="index.html"><a href="index.html#structure-1"><i class="fa fa-check"></i><b>1.4.3</b> Structure</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i><b>1.5</b> Acknowledgements</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#contact"><i class="fa fa-check"></i><b>1.6</b> Contact</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="drinking-from-a-fire-hose.html"><a href="drinking-from-a-fire-hose.html"><i class="fa fa-check"></i><b>2</b> Drinking from a fire hose</a>
<ul>
<li class="chapter" data-level="2.1" data-path="drinking-from-a-fire-hose.html"><a href="drinking-from-a-fire-hose.html#hello-world"><i class="fa fa-check"></i><b>2.1</b> Hello world</a></li>
<li class="chapter" data-level="2.2" data-path="drinking-from-a-fire-hose.html"><a href="drinking-from-a-fire-hose.html#case-study---canadian-elections"><i class="fa fa-check"></i><b>2.2</b> Case study - Canadian elections</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="drinking-from-a-fire-hose.html"><a href="drinking-from-a-fire-hose.html#getting-started"><i class="fa fa-check"></i><b>2.2.1</b> Getting started</a></li>
<li class="chapter" data-level="2.2.2" data-path="drinking-from-a-fire-hose.html"><a href="drinking-from-a-fire-hose.html#get-the-data"><i class="fa fa-check"></i><b>2.2.2</b> Get the data</a></li>
<li class="chapter" data-level="2.2.3" data-path="drinking-from-a-fire-hose.html"><a href="drinking-from-a-fire-hose.html#clean-the-data"><i class="fa fa-check"></i><b>2.2.3</b> Clean the data</a></li>
<li class="chapter" data-level="2.2.4" data-path="drinking-from-a-fire-hose.html"><a href="drinking-from-a-fire-hose.html#make-a-graph"><i class="fa fa-check"></i><b>2.2.4</b> Make a graph</a></li>
<li class="chapter" data-level="2.2.5" data-path="drinking-from-a-fire-hose.html"><a href="drinking-from-a-fire-hose.html#make-a-table"><i class="fa fa-check"></i><b>2.2.5</b> Make a table</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="drinking-from-a-fire-hose.html"><a href="drinking-from-a-fire-hose.html#case-study---toronto-homelessness"><i class="fa fa-check"></i><b>2.3</b> Case study - Toronto homelessness</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="drinking-from-a-fire-hose.html"><a href="drinking-from-a-fire-hose.html#getting-started-1"><i class="fa fa-check"></i><b>2.3.1</b> Getting started</a></li>
<li class="chapter" data-level="2.3.2" data-path="drinking-from-a-fire-hose.html"><a href="drinking-from-a-fire-hose.html#get-the-data-1"><i class="fa fa-check"></i><b>2.3.2</b> Get the data</a></li>
<li class="chapter" data-level="2.3.3" data-path="drinking-from-a-fire-hose.html"><a href="drinking-from-a-fire-hose.html#make-a-graph-1"><i class="fa fa-check"></i><b>2.3.3</b> Make a graph</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="r-essentials.html"><a href="r-essentials.html"><i class="fa fa-check"></i><b>3</b> R Essentials</a>
<ul>
<li class="chapter" data-level="3.1" data-path="r-essentials.html"><a href="r-essentials.html#r-essentials-1"><i class="fa fa-check"></i><b>3.1</b> R essentials</a></li>
<li class="chapter" data-level="3.2" data-path="r-essentials.html"><a href="r-essentials.html#social-impact"><i class="fa fa-check"></i><b>3.2</b> Social impact</a></li>
<li class="chapter" data-level="3.3" data-path="r-essentials.html"><a href="r-essentials.html#r-r-studio-and-r-studio-cloud"><i class="fa fa-check"></i><b>3.3</b> R, R Studio, and R Studio Cloud</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="r-essentials.html"><a href="r-essentials.html#r"><i class="fa fa-check"></i><b>3.3.1</b> R</a></li>
<li class="chapter" data-level="3.3.2" data-path="r-essentials.html"><a href="r-essentials.html#r-studio"><i class="fa fa-check"></i><b>3.3.2</b> R Studio</a></li>
<li class="chapter" data-level="3.3.3" data-path="r-essentials.html"><a href="r-essentials.html#r-studio-cloud"><i class="fa fa-check"></i><b>3.3.3</b> R Studio Cloud</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="r-essentials.html"><a href="r-essentials.html#tidyverse-i"><i class="fa fa-check"></i><b>3.4</b> Tidyverse I</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="r-essentials.html"><a href="r-essentials.html#the-pipe"><i class="fa fa-check"></i><b>3.4.1</b> The pipe</a></li>
<li class="chapter" data-level="3.4.2" data-path="r-essentials.html"><a href="r-essentials.html#selecting"><i class="fa fa-check"></i><b>3.4.2</b> Selecting</a></li>
<li class="chapter" data-level="3.4.3" data-path="r-essentials.html"><a href="r-essentials.html#filtering"><i class="fa fa-check"></i><b>3.4.3</b> Filtering</a></li>
<li class="chapter" data-level="3.4.4" data-path="r-essentials.html"><a href="r-essentials.html#arranging"><i class="fa fa-check"></i><b>3.4.4</b> Arranging</a></li>
<li class="chapter" data-level="3.4.5" data-path="r-essentials.html"><a href="r-essentials.html#grouping"><i class="fa fa-check"></i><b>3.4.5</b> Grouping</a></li>
<li class="chapter" data-level="3.4.6" data-path="r-essentials.html"><a href="r-essentials.html#mutating"><i class="fa fa-check"></i><b>3.4.6</b> Mutating</a></li>
<li class="chapter" data-level="3.4.7" data-path="r-essentials.html"><a href="r-essentials.html#summarise"><i class="fa fa-check"></i><b>3.4.7</b> Summarise</a></li>
<li class="chapter" data-level="3.4.8" data-path="r-essentials.html"><a href="r-essentials.html#counting"><i class="fa fa-check"></i><b>3.4.8</b> Counting</a></li>
<li class="chapter" data-level="3.4.9" data-path="r-essentials.html"><a href="r-essentials.html#proportions"><i class="fa fa-check"></i><b>3.4.9</b> Proportions</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="r-essentials.html"><a href="r-essentials.html#base"><i class="fa fa-check"></i><b>3.5</b> Base</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="r-essentials.html"><a href="r-essentials.html#class"><i class="fa fa-check"></i><b>3.5.1</b> Class</a></li>
<li class="chapter" data-level="3.5.2" data-path="r-essentials.html"><a href="r-essentials.html#simulating-data"><i class="fa fa-check"></i><b>3.5.2</b> Simulating data</a></li>
<li class="chapter" data-level="3.5.3" data-path="r-essentials.html"><a href="r-essentials.html#functions"><i class="fa fa-check"></i><b>3.5.3</b> Functions</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="r-essentials.html"><a href="r-essentials.html#ggplot"><i class="fa fa-check"></i><b>3.6</b> ggplot</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="r-essentials.html"><a href="r-essentials.html#main-features"><i class="fa fa-check"></i><b>3.6.1</b> Main features</a></li>
<li class="chapter" data-level="3.6.2" data-path="r-essentials.html"><a href="r-essentials.html#facets"><i class="fa fa-check"></i><b>3.6.2</b> Facets</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="r-essentials.html"><a href="r-essentials.html#tidyverse-ii"><i class="fa fa-check"></i><b>3.7</b> Tidyverse II</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="r-essentials.html"><a href="r-essentials.html#tibbles"><i class="fa fa-check"></i><b>3.7.1</b> Tibbles</a></li>
<li class="chapter" data-level="3.7.2" data-path="r-essentials.html"><a href="r-essentials.html#importing-data"><i class="fa fa-check"></i><b>3.7.2</b> Importing data</a></li>
<li class="chapter" data-level="3.7.3" data-path="r-essentials.html"><a href="r-essentials.html#joining-data"><i class="fa fa-check"></i><b>3.7.3</b> Joining data</a></li>
<li class="chapter" data-level="3.7.4" data-path="r-essentials.html"><a href="r-essentials.html#strings"><i class="fa fa-check"></i><b>3.7.4</b> Strings</a></li>
<li class="chapter" data-level="3.7.5" data-path="r-essentials.html"><a href="r-essentials.html#pivot"><i class="fa fa-check"></i><b>3.7.5</b> Pivot</a></li>
<li class="chapter" data-level="3.7.6" data-path="r-essentials.html"><a href="r-essentials.html#factors"><i class="fa fa-check"></i><b>3.7.6</b> Factors</a></li>
<li class="chapter" data-level="3.7.7" data-path="r-essentials.html"><a href="r-essentials.html#cases"><i class="fa fa-check"></i><b>3.7.7</b> Cases</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="workflow.html"><a href="workflow.html"><i class="fa fa-check"></i><b>4</b> Workflow</a>
<ul>
<li class="chapter" data-level="4.1" data-path="workflow.html"><a href="workflow.html#introduction-1"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="workflow.html"><a href="workflow.html#r-markdown"><i class="fa fa-check"></i><b>4.2</b> R Markdown</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="workflow.html"><a href="workflow.html#getting-started-2"><i class="fa fa-check"></i><b>4.2.1</b> Getting started</a></li>
<li class="chapter" data-level="4.2.2" data-path="workflow.html"><a href="workflow.html#basic-commands"><i class="fa fa-check"></i><b>4.2.2</b> Basic commands</a></li>
<li class="chapter" data-level="4.2.3" data-path="workflow.html"><a href="workflow.html#r-chunks"><i class="fa fa-check"></i><b>4.2.3</b> R chunks</a></li>
<li class="chapter" data-level="4.2.4" data-path="workflow.html"><a href="workflow.html#abstracts-and-pdf-outputs"><i class="fa fa-check"></i><b>4.2.4</b> Abstracts and PDF outputs</a></li>
<li class="chapter" data-level="4.2.5" data-path="workflow.html"><a href="workflow.html#references"><i class="fa fa-check"></i><b>4.2.5</b> References</a></li>
<li class="chapter" data-level="4.2.6" data-path="workflow.html"><a href="workflow.html#cross-references"><i class="fa fa-check"></i><b>4.2.6</b> Cross-references</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="workflow.html"><a href="workflow.html#r-projects"><i class="fa fa-check"></i><b>4.3</b> R projects</a></li>
<li class="chapter" data-level="4.4" data-path="workflow.html"><a href="workflow.html#git-and-github"><i class="fa fa-check"></i><b>4.4</b> Git and GitHub</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="workflow.html"><a href="workflow.html#introduction-2"><i class="fa fa-check"></i><b>4.4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.4.2" data-path="workflow.html"><a href="workflow.html#git"><i class="fa fa-check"></i><b>4.4.2</b> Git</a></li>
<li class="chapter" data-level="4.4.3" data-path="workflow.html"><a href="workflow.html#github"><i class="fa fa-check"></i><b>4.4.3</b> GitHub</a></li>
<li class="chapter" data-level="4.4.4" data-path="workflow.html"><a href="workflow.html#using-git-within-rstudio"><i class="fa fa-check"></i><b>4.4.4</b> Using Git within RStudio</a></li>
<li class="chapter" data-level="4.4.5" data-path="workflow.html"><a href="workflow.html#next-steps"><i class="fa fa-check"></i><b>4.4.5</b> Next steps</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="workflow.html"><a href="workflow.html#using-r-in-practice"><i class="fa fa-check"></i><b>4.5</b> Using R in practice</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="workflow.html"><a href="workflow.html#introduction-3"><i class="fa fa-check"></i><b>4.5.1</b> Introduction</a></li>
<li class="chapter" data-level="4.5.2" data-path="workflow.html"><a href="workflow.html#getting-help"><i class="fa fa-check"></i><b>4.5.2</b> Getting help</a></li>
<li class="chapter" data-level="4.5.3" data-path="workflow.html"><a href="workflow.html#mentality"><i class="fa fa-check"></i><b>4.5.3</b> Mentality</a></li>
<li class="chapter" data-level="4.5.4" data-path="workflow.html"><a href="workflow.html#code-comments"><i class="fa fa-check"></i><b>4.5.4</b> Code comments</a></li>
<li class="chapter" data-level="4.5.5" data-path="workflow.html"><a href="workflow.html#learning-more"><i class="fa fa-check"></i><b>4.5.5</b> Learning more</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="workflow.html"><a href="workflow.html#developing-research-questions"><i class="fa fa-check"></i><b>4.6</b> Developing research questions</a></li>
</ul></li>
<li class="part"><span><b>II Communicate</b></span></li>
<li class="chapter" data-level="5" data-path="static-communication.html"><a href="static-communication.html"><i class="fa fa-check"></i><b>5</b> Static communication</a>
<ul>
<li class="chapter" data-level="5.1" data-path="static-communication.html"><a href="static-communication.html#introduction-4"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="static-communication.html"><a href="static-communication.html#graphs"><i class="fa fa-check"></i><b>5.2</b> Graphs</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="static-communication.html"><a href="static-communication.html#bar-chart"><i class="fa fa-check"></i><b>5.2.1</b> Bar chart</a></li>
<li class="chapter" data-level="5.2.2" data-path="static-communication.html"><a href="static-communication.html#scatter-plot"><i class="fa fa-check"></i><b>5.2.2</b> Scatter plot</a></li>
<li class="chapter" data-level="5.2.3" data-path="static-communication.html"><a href="static-communication.html#never-use-box-plots"><i class="fa fa-check"></i><b>5.2.3</b> Never use box plots</a></li>
<li class="chapter" data-level="5.2.4" data-path="static-communication.html"><a href="static-communication.html#other"><i class="fa fa-check"></i><b>5.2.4</b> Other</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="static-communication.html"><a href="static-communication.html#tables"><i class="fa fa-check"></i><b>5.3</b> Tables</a></li>
<li class="chapter" data-level="5.4" data-path="static-communication.html"><a href="static-communication.html#maps"><i class="fa fa-check"></i><b>5.4</b> Maps</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="static-communication.html"><a href="static-communication.html#australian-polling-places"><i class="fa fa-check"></i><b>5.4.1</b> Australian polling places</a></li>
<li class="chapter" data-level="5.4.2" data-path="static-communication.html"><a href="static-communication.html#toronto-bike-parking"><i class="fa fa-check"></i><b>5.4.2</b> Toronto bike parking</a></li>
<li class="chapter" data-level="5.4.3" data-path="static-communication.html"><a href="static-communication.html#geocoding"><i class="fa fa-check"></i><b>5.4.3</b> Geocoding</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="static-communication.html"><a href="static-communication.html#writing"><i class="fa fa-check"></i><b>5.5</b> Writing</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="static-communication.html"><a href="static-communication.html#title-abstract-and-introduction"><i class="fa fa-check"></i><b>5.5.1</b> Title, abstract, and introduction</a></li>
<li class="chapter" data-level="5.5.2" data-path="static-communication.html"><a href="static-communication.html#figures-tables-equations-and-technical-terms"><i class="fa fa-check"></i><b>5.5.2</b> Figures, tables, equations, and technical terms</a></li>
<li class="chapter" data-level="5.5.3" data-path="static-communication.html"><a href="static-communication.html#on-brevity"><i class="fa fa-check"></i><b>5.5.3</b> On brevity</a></li>
<li class="chapter" data-level="5.5.4" data-path="static-communication.html"><a href="static-communication.html#other-1"><i class="fa fa-check"></i><b>5.5.4</b> Other</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="interactive-communication.html"><a href="interactive-communication.html"><i class="fa fa-check"></i><b>6</b> Interactive communication</a>
<ul>
<li class="chapter" data-level="6.1" data-path="interactive-communication.html"><a href="interactive-communication.html#making-a-website"><i class="fa fa-check"></i><b>6.1</b> Making a website</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="interactive-communication.html"><a href="interactive-communication.html#introduction-5"><i class="fa fa-check"></i><b>6.1.1</b> Introduction</a></li>
<li class="chapter" data-level="6.1.2" data-path="interactive-communication.html"><a href="interactive-communication.html#foundations"><i class="fa fa-check"></i><b>6.1.2</b> Foundations</a></li>
<li class="chapter" data-level="6.1.3" data-path="interactive-communication.html"><a href="interactive-communication.html#build-the-frame"><i class="fa fa-check"></i><b>6.1.3</b> Build the frame</a></li>
<li class="chapter" data-level="6.1.4" data-path="interactive-communication.html"><a href="interactive-communication.html#add-content"><i class="fa fa-check"></i><b>6.1.4</b> Add content</a></li>
<li class="chapter" data-level="6.1.5" data-path="interactive-communication.html"><a href="interactive-communication.html#making-your-website-public"><i class="fa fa-check"></i><b>6.1.5</b> Making your website public</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="interactive-communication.html"><a href="interactive-communication.html#interactive-maps"><i class="fa fa-check"></i><b>6.2</b> Interactive maps</a></li>
<li class="chapter" data-level="6.3" data-path="interactive-communication.html"><a href="interactive-communication.html#shiny"><i class="fa fa-check"></i><b>6.3</b> Shiny</a></li>
</ul></li>
<li class="part"><span><b>III Hunt gather and farm</b></span></li>
<li class="chapter" data-level="7" data-path="gather-data.html"><a href="gather-data.html"><i class="fa fa-check"></i><b>7</b> Gather data</a>
<ul>
<li class="chapter" data-level="7.1" data-path="gather-data.html"><a href="gather-data.html#apis"><i class="fa fa-check"></i><b>7.1</b> APIs</a></li>
<li class="chapter" data-level="7.2" data-path="gather-data.html"><a href="gather-data.html#case-study---arxiv"><i class="fa fa-check"></i><b>7.2</b> Case study - arXiv</a></li>
<li class="chapter" data-level="7.3" data-path="gather-data.html"><a href="gather-data.html#case-study---rtweet"><i class="fa fa-check"></i><b>7.3</b> Case study - rtweet</a></li>
<li class="chapter" data-level="7.4" data-path="gather-data.html"><a href="gather-data.html#case-study---spotifyr"><i class="fa fa-check"></i><b>7.4</b> Case study - spotifyr</a></li>
<li class="chapter" data-level="7.5" data-path="gather-data.html"><a href="gather-data.html#scraping"><i class="fa fa-check"></i><b>7.5</b> Scraping</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="gather-data.html"><a href="gather-data.html#introduction-6"><i class="fa fa-check"></i><b>7.5.1</b> Introduction</a></li>
<li class="chapter" data-level="7.5.2" data-path="gather-data.html"><a href="gather-data.html#getting-started-3"><i class="fa fa-check"></i><b>7.5.2</b> Getting started</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="gather-data.html"><a href="gather-data.html#case-study---rohans-books"><i class="fa fa-check"></i><b>7.6</b> Case study - Rohan’s books</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="gather-data.html"><a href="gather-data.html#introduction-7"><i class="fa fa-check"></i><b>7.6.1</b> Introduction</a></li>
<li class="chapter" data-level="7.6.2" data-path="gather-data.html"><a href="gather-data.html#gather"><i class="fa fa-check"></i><b>7.6.2</b> Gather</a></li>
<li class="chapter" data-level="7.6.3" data-path="gather-data.html"><a href="gather-data.html#clean"><i class="fa fa-check"></i><b>7.6.3</b> Clean</a></li>
<li class="chapter" data-level="7.6.4" data-path="gather-data.html"><a href="gather-data.html#explore"><i class="fa fa-check"></i><b>7.6.4</b> Explore</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="gather-data.html"><a href="gather-data.html#case-study---canadian-prime-ministers"><i class="fa fa-check"></i><b>7.7</b> Case study - Canadian Prime Ministers</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="gather-data.html"><a href="gather-data.html#introduction-8"><i class="fa fa-check"></i><b>7.7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.7.2" data-path="gather-data.html"><a href="gather-data.html#gather-1"><i class="fa fa-check"></i><b>7.7.2</b> Gather</a></li>
<li class="chapter" data-level="7.7.3" data-path="gather-data.html"><a href="gather-data.html#clean-1"><i class="fa fa-check"></i><b>7.7.3</b> Clean</a></li>
<li class="chapter" data-level="7.7.4" data-path="gather-data.html"><a href="gather-data.html#explore-1"><i class="fa fa-check"></i><b>7.7.4</b> Explore</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="gather-data.html"><a href="gather-data.html#pdfs"><i class="fa fa-check"></i><b>7.8</b> PDFs</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="gather-data.html"><a href="gather-data.html#introduction-9"><i class="fa fa-check"></i><b>7.8.1</b> Introduction</a></li>
<li class="chapter" data-level="7.8.2" data-path="gather-data.html"><a href="gather-data.html#getting-started-4"><i class="fa fa-check"></i><b>7.8.2</b> Getting started</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="gather-data.html"><a href="gather-data.html#case-study-us-total-fertility-rate-by-state-and-year-2000-2018"><i class="fa fa-check"></i><b>7.9</b> Case-study: US Total Fertility Rate, by state and year (2000-2018)</a>
<ul>
<li class="chapter" data-level="7.9.1" data-path="gather-data.html"><a href="gather-data.html#introduction-10"><i class="fa fa-check"></i><b>7.9.1</b> Introduction</a></li>
<li class="chapter" data-level="7.9.2" data-path="gather-data.html"><a href="gather-data.html#begin-with-an-end-in-mind"><i class="fa fa-check"></i><b>7.9.2</b> Begin with an end in mind</a></li>
<li class="chapter" data-level="7.9.3" data-path="gather-data.html"><a href="gather-data.html#start-simple-then-iterate."><i class="fa fa-check"></i><b>7.9.3</b> Start simple, then iterate.</a></li>
<li class="chapter" data-level="7.9.4" data-path="gather-data.html"><a href="gather-data.html#iterating"><i class="fa fa-check"></i><b>7.9.4</b> Iterating</a></li>
</ul></li>
<li class="chapter" data-level="7.10" data-path="gather-data.html"><a href="gather-data.html#case-study-kenyan-census-data"><i class="fa fa-check"></i><b>7.10</b> Case-study: Kenyan census data</a>
<ul>
<li class="chapter" data-level="7.10.1" data-path="gather-data.html"><a href="gather-data.html#set-up"><i class="fa fa-check"></i><b>7.10.1</b> Set-up</a></li>
<li class="chapter" data-level="7.10.2" data-path="gather-data.html"><a href="gather-data.html#extract"><i class="fa fa-check"></i><b>7.10.2</b> Extract</a></li>
<li class="chapter" data-level="7.10.3" data-path="gather-data.html"><a href="gather-data.html#clean-2"><i class="fa fa-check"></i><b>7.10.3</b> Clean</a></li>
<li class="chapter" data-level="7.10.4" data-path="gather-data.html"><a href="gather-data.html#check"><i class="fa fa-check"></i><b>7.10.4</b> Check</a></li>
<li class="chapter" data-level="7.10.5" data-path="gather-data.html"><a href="gather-data.html#tidy-up"><i class="fa fa-check"></i><b>7.10.5</b> Tidy-up</a></li>
<li class="chapter" data-level="7.10.6" data-path="gather-data.html"><a href="gather-data.html#make-monicas-dataset"><i class="fa fa-check"></i><b>7.10.6</b> Make Monica’s dataset</a></li>
</ul></li>
<li class="chapter" data-level="7.11" data-path="gather-data.html"><a href="gather-data.html#optical-character-recognition"><i class="fa fa-check"></i><b>7.11</b> Optical Character Recognition</a></li>
<li class="chapter" data-level="7.12" data-path="gather-data.html"><a href="gather-data.html#text"><i class="fa fa-check"></i><b>7.12</b> Text</a>
<ul>
<li class="chapter" data-level="7.12.1" data-path="gather-data.html"><a href="gather-data.html#introduction-11"><i class="fa fa-check"></i><b>7.12.1</b> Introduction</a></li>
<li class="chapter" data-level="7.12.2" data-path="gather-data.html"><a href="gather-data.html#getting-text-data"><i class="fa fa-check"></i><b>7.12.2</b> Getting text data</a></li>
<li class="chapter" data-level="7.12.3" data-path="gather-data.html"><a href="gather-data.html#preparing-text-datasets"><i class="fa fa-check"></i><b>7.12.3</b> Preparing text datasets</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="hunt-data.html"><a href="hunt-data.html"><i class="fa fa-check"></i><b>8</b> Hunt data</a>
<ul>
<li class="chapter" data-level="8.1" data-path="hunt-data.html"><a href="hunt-data.html#experiments-and-randomised-controlled-trials"><i class="fa fa-check"></i><b>8.1</b> Experiments and randomised controlled trials</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="hunt-data.html"><a href="hunt-data.html#introduction-12"><i class="fa fa-check"></i><b>8.1.1</b> Introduction</a></li>
<li class="chapter" data-level="8.1.2" data-path="hunt-data.html"><a href="hunt-data.html#motivation-and-notation"><i class="fa fa-check"></i><b>8.1.2</b> Motivation and notation</a></li>
<li class="chapter" data-level="8.1.3" data-path="hunt-data.html"><a href="hunt-data.html#randomised-sampling"><i class="fa fa-check"></i><b>8.1.3</b> Randomised sampling</a></li>
<li class="chapter" data-level="8.1.4" data-path="hunt-data.html"><a href="hunt-data.html#anova"><i class="fa fa-check"></i><b>8.1.4</b> ANOVA</a></li>
<li class="chapter" data-level="8.1.5" data-path="hunt-data.html"><a href="hunt-data.html#treatment-and-control"><i class="fa fa-check"></i><b>8.1.5</b> Treatment and control</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="hunt-data.html"><a href="hunt-data.html#case-study---fishers-tea-party"><i class="fa fa-check"></i><b>8.2</b> Case study - Fisher’s tea party</a></li>
<li class="chapter" data-level="8.3" data-path="hunt-data.html"><a href="hunt-data.html#case-study---tuskegee-syphilis-study"><i class="fa fa-check"></i><b>8.3</b> Case study - Tuskegee Syphilis Study</a></li>
<li class="chapter" data-level="8.4" data-path="hunt-data.html"><a href="hunt-data.html#case-study---the-oregon-health-insurance-experiment"><i class="fa fa-check"></i><b>8.4</b> Case study - The Oregon Health Insurance Experiment</a></li>
<li class="chapter" data-level="8.5" data-path="hunt-data.html"><a href="hunt-data.html#case-study---student-coaching-how-far-can-technology-go"><i class="fa fa-check"></i><b>8.5</b> Case study - Student Coaching: How Far Can Technology Go?</a></li>
<li class="chapter" data-level="8.6" data-path="hunt-data.html"><a href="hunt-data.html#case-study---civic-honesty-around-the-globe"><i class="fa fa-check"></i><b>8.6</b> Case study - Civic Honesty Around The Globe</a></li>
<li class="chapter" data-level="8.7" data-path="hunt-data.html"><a href="hunt-data.html#ab-testing"><i class="fa fa-check"></i><b>8.7</b> A/B testing</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="hunt-data.html"><a href="hunt-data.html#introduction-13"><i class="fa fa-check"></i><b>8.7.1</b> Introduction</a></li>
<li class="chapter" data-level="8.7.2" data-path="hunt-data.html"><a href="hunt-data.html#delivery"><i class="fa fa-check"></i><b>8.7.2</b> Delivery</a></li>
<li class="chapter" data-level="8.7.3" data-path="hunt-data.html"><a href="hunt-data.html#instrumentation"><i class="fa fa-check"></i><b>8.7.3</b> Instrumentation</a></li>
<li class="chapter" data-level="8.7.4" data-path="hunt-data.html"><a href="hunt-data.html#randomisation-unit"><i class="fa fa-check"></i><b>8.7.4</b> Randomisation unit</a></li>
<li class="chapter" data-level="8.7.5" data-path="hunt-data.html"><a href="hunt-data.html#partnerships"><i class="fa fa-check"></i><b>8.7.5</b> Partnerships</a></li>
<li class="chapter" data-level="8.7.6" data-path="hunt-data.html"><a href="hunt-data.html#speed-vs-quality"><i class="fa fa-check"></i><b>8.7.6</b> Speed vs quality</a></li>
<li class="chapter" data-level="8.7.7" data-path="hunt-data.html"><a href="hunt-data.html#conflicting-priorities"><i class="fa fa-check"></i><b>8.7.7</b> Conflicting priorities</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="hunt-data.html"><a href="hunt-data.html#case-study---upworthy"><i class="fa fa-check"></i><b>8.8</b> Case study - Upworthy</a></li>
<li class="chapter" data-level="8.9" data-path="hunt-data.html"><a href="hunt-data.html#sampling-and-survey-essentials"><i class="fa fa-check"></i><b>8.9</b> Sampling and survey essentials</a>
<ul>
<li class="chapter" data-level="8.9.1" data-path="hunt-data.html"><a href="hunt-data.html#introduction-14"><i class="fa fa-check"></i><b>8.9.1</b> Introduction</a></li>
<li class="chapter" data-level="8.9.2" data-path="hunt-data.html"><a href="hunt-data.html#simple-random-sampling"><i class="fa fa-check"></i><b>8.9.2</b> Simple random sampling</a></li>
<li class="chapter" data-level="8.9.3" data-path="hunt-data.html"><a href="hunt-data.html#stratified-and-cluster-sampling"><i class="fa fa-check"></i><b>8.9.3</b> Stratified and cluster sampling</a></li>
</ul></li>
<li class="chapter" data-level="8.10" data-path="hunt-data.html"><a href="hunt-data.html#implementing-surveys"><i class="fa fa-check"></i><b>8.10</b> Implementing surveys</a>
<ul>
<li class="chapter" data-level="8.10.1" data-path="hunt-data.html"><a href="hunt-data.html#google"><i class="fa fa-check"></i><b>8.10.1</b> Google</a></li>
<li class="chapter" data-level="8.10.2" data-path="hunt-data.html"><a href="hunt-data.html#facebook"><i class="fa fa-check"></i><b>8.10.2</b> Facebook</a></li>
<li class="chapter" data-level="8.10.3" data-path="hunt-data.html"><a href="hunt-data.html#survey-monkey"><i class="fa fa-check"></i><b>8.10.3</b> Survey Monkey</a></li>
<li class="chapter" data-level="8.10.4" data-path="hunt-data.html"><a href="hunt-data.html#mechanical-turk"><i class="fa fa-check"></i><b>8.10.4</b> Mechanical Turk</a></li>
<li class="chapter" data-level="8.10.5" data-path="hunt-data.html"><a href="hunt-data.html#prolific"><i class="fa fa-check"></i><b>8.10.5</b> Prolific</a></li>
<li class="chapter" data-level="8.10.6" data-path="hunt-data.html"><a href="hunt-data.html#qualtrics"><i class="fa fa-check"></i><b>8.10.6</b> Qualtrics</a></li>
<li class="chapter" data-level="8.10.7" data-path="hunt-data.html"><a href="hunt-data.html#other-2"><i class="fa fa-check"></i><b>8.10.7</b> Other</a></li>
</ul></li>
<li class="chapter" data-level="8.11" data-path="hunt-data.html"><a href="hunt-data.html#next-steps-1"><i class="fa fa-check"></i><b>8.11</b> Next steps</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="farm-data.html"><a href="farm-data.html"><i class="fa fa-check"></i><b>9</b> Farm data</a>
<ul>
<li class="chapter" data-level="9.1" data-path="farm-data.html"><a href="farm-data.html#open-government-data"><i class="fa fa-check"></i><b>9.1</b> Open Government Data</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="farm-data.html"><a href="farm-data.html#canadian-census"><i class="fa fa-check"></i><b>9.1.1</b> Canadian Census</a></li>
<li class="chapter" data-level="9.1.2" data-path="farm-data.html"><a href="farm-data.html#city-of-toronto-open-data-portal"><i class="fa fa-check"></i><b>9.1.2</b> City of Toronto Open Data Portal</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="farm-data.html"><a href="farm-data.html#electoral-studies"><i class="fa fa-check"></i><b>9.2</b> Electoral Studies</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="farm-data.html"><a href="farm-data.html#canadian-electoral-study"><i class="fa fa-check"></i><b>9.2.1</b> Canadian Electoral Study</a></li>
<li class="chapter" data-level="9.2.2" data-path="farm-data.html"><a href="farm-data.html#australian-electoral-study"><i class="fa fa-check"></i><b>9.2.2</b> Australian Electoral Study</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Clean</b></span></li>
<li class="chapter" data-level="10" data-path="cleaning-and-preparing-data.html"><a href="cleaning-and-preparing-data.html"><i class="fa fa-check"></i><b>10</b> Cleaning and preparing data</a></li>
<li class="chapter" data-level="11" data-path="storing-and-retrieving-data.html"><a href="storing-and-retrieving-data.html"><i class="fa fa-check"></i><b>11</b> Storing and retrieving data</a></li>
<li class="chapter" data-level="12" data-path="disseminating-and-protecting-data.html"><a href="disseminating-and-protecting-data.html"><i class="fa fa-check"></i><b>12</b> Disseminating and protecting data</a></li>
<li class="part"><span><b>V Model</b></span></li>
<li class="chapter" data-level="13" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html"><i class="fa fa-check"></i><b>13</b> Exploratory data analysis</a>
<ul>
<li class="chapter" data-level="13.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#introduction-15"><i class="fa fa-check"></i><b>13.1</b> Introduction</a></li>
<li class="chapter" data-level="13.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#case-study---ttc-subway-delays"><i class="fa fa-check"></i><b>13.2</b> Case study - TTC subway delays</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#introduction-16"><i class="fa fa-check"></i><b>13.2.1</b> Introduction</a></li>
<li class="chapter" data-level="13.2.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#gather-the-data"><i class="fa fa-check"></i><b>13.2.2</b> Gather the data</a></li>
<li class="chapter" data-level="13.2.3" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#sanity-checks"><i class="fa fa-check"></i><b>13.2.3</b> Sanity Checks</a></li>
<li class="chapter" data-level="13.2.4" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#missing-values"><i class="fa fa-check"></i><b>13.2.4</b> Missing values</a></li>
<li class="chapter" data-level="13.2.5" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#duplicate-rows"><i class="fa fa-check"></i><b>13.2.5</b> Duplicate rows</a></li>
<li class="chapter" data-level="13.2.6" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#visualizing-distributions"><i class="fa fa-check"></i><b>13.2.6</b> Visualizing distributions</a></li>
<li class="chapter" data-level="13.2.7" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#groups-and-small-counts"><i class="fa fa-check"></i><b>13.2.7</b> Groups and small counts</a></li>
<li class="chapter" data-level="13.2.8" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#visualizing-time-series"><i class="fa fa-check"></i><b>13.2.8</b> Visualizing time series</a></li>
<li class="chapter" data-level="13.2.9" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#visualizing-relationships"><i class="fa fa-check"></i><b>13.2.9</b> Visualizing relationships</a></li>
<li class="chapter" data-level="13.2.10" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#principal-components-analysis"><i class="fa fa-check"></i><b>13.2.10</b> Principal components analysis</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#case-study---opinions-about-a-casino-in-toronto"><i class="fa fa-check"></i><b>13.3</b> Case study - Opinions about a casino in Toronto</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#data-preparation"><i class="fa fa-check"></i><b>13.3.1</b> Data preparation</a></li>
<li class="chapter" data-level="13.3.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#some-visual-exploration-and-more-cleanup-of-course"><i class="fa fa-check"></i><b>13.3.2</b> Some visual exploration (and more cleanup, of course)</a></li>
<li class="chapter" data-level="13.3.3" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#getting-the-data-into-a-more-model-suitable-format"><i class="fa fa-check"></i><b>13.3.3</b> Getting the data into a more model-suitable format</a></li>
<li class="chapter" data-level="13.3.4" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#logistic-regression"><i class="fa fa-check"></i><b>13.3.4</b> Logistic Regression</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#case-study---airbnb-listing-in-toronto"><i class="fa fa-check"></i><b>13.4</b> Case study - Airbnb listing in Toronto</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#essentials"><i class="fa fa-check"></i><b>13.4.1</b> Essentials</a></li>
<li class="chapter" data-level="13.4.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#set-up-1"><i class="fa fa-check"></i><b>13.4.2</b> Set up</a></li>
<li class="chapter" data-level="13.4.3" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#get-data"><i class="fa fa-check"></i><b>13.4.3</b> Get data</a></li>
<li class="chapter" data-level="13.4.4" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#clean-data-1"><i class="fa fa-check"></i><b>13.4.4</b> Clean data</a></li>
<li class="chapter" data-level="13.4.5" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#explore-data"><i class="fa fa-check"></i><b>13.4.5</b> Explore data</a></li>
<li class="chapter" data-level="13.4.6" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#model-data"><i class="fa fa-check"></i><b>13.4.6</b> Model data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="its-just-a-linear-model.html"><a href="its-just-a-linear-model.html"><i class="fa fa-check"></i><b>14</b> It’s Just A Linear Model</a>
<ul>
<li class="chapter" data-level="14.1" data-path="its-just-a-linear-model.html"><a href="its-just-a-linear-model.html#overview"><i class="fa fa-check"></i><b>14.1</b> Overview</a></li>
<li class="chapter" data-level="14.2" data-path="its-just-a-linear-model.html"><a href="its-just-a-linear-model.html#simple-linear-regression"><i class="fa fa-check"></i><b>14.2</b> Simple linear regression</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="its-just-a-linear-model.html"><a href="its-just-a-linear-model.html#overview-1"><i class="fa fa-check"></i><b>14.2.1</b> Overview</a></li>
<li class="chapter" data-level="14.2.2" data-path="its-just-a-linear-model.html"><a href="its-just-a-linear-model.html#implementation-in-base-r"><i class="fa fa-check"></i><b>14.2.2</b> Implementation in base R</a></li>
<li class="chapter" data-level="14.2.3" data-path="its-just-a-linear-model.html"><a href="its-just-a-linear-model.html#tidy-up-with-broom"><i class="fa fa-check"></i><b>14.2.3</b> Tidy up with broom</a></li>
<li class="chapter" data-level="14.2.4" data-path="its-just-a-linear-model.html"><a href="its-just-a-linear-model.html#testing-hypothesis"><i class="fa fa-check"></i><b>14.2.4</b> Testing hypothesis</a></li>
<li class="chapter" data-level="14.2.5" data-path="its-just-a-linear-model.html"><a href="its-just-a-linear-model.html#on-p-values"><i class="fa fa-check"></i><b>14.2.5</b> On p-values</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="its-just-a-linear-model.html"><a href="its-just-a-linear-model.html#multiple-linear-regression"><i class="fa fa-check"></i><b>14.3</b> Multiple linear regression</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="its-just-a-linear-model.html"><a href="its-just-a-linear-model.html#threats-to-validity-and-aspects-to-think-about"><i class="fa fa-check"></i><b>14.3.1</b> Threats to validity and aspects to think about</a></li>
<li class="chapter" data-level="14.3.2" data-path="its-just-a-linear-model.html"><a href="its-just-a-linear-model.html#more-credible-outputs"><i class="fa fa-check"></i><b>14.3.2</b> More credible outputs</a></li>
<li class="chapter" data-level="14.3.3" data-path="its-just-a-linear-model.html"><a href="its-just-a-linear-model.html#implementation-in-tidymodels"><i class="fa fa-check"></i><b>14.3.3</b> Implementation in <code>tidymodels</code></a></li>
<li class="chapter" data-level="14.3.4" data-path="its-just-a-linear-model.html"><a href="its-just-a-linear-model.html#implementation-in-rstanarm"><i class="fa fa-check"></i><b>14.3.4</b> Implementation in <code>rstanarm</code></a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="its-just-a-linear-model.html"><a href="its-just-a-linear-model.html#logistic-regression-2"><i class="fa fa-check"></i><b>14.4</b> Logistic regression</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="its-just-a-linear-model.html"><a href="its-just-a-linear-model.html#overview-2"><i class="fa fa-check"></i><b>14.4.1</b> Overview</a></li>
<li class="chapter" data-level="14.4.2" data-path="its-just-a-linear-model.html"><a href="its-just-a-linear-model.html#implementation-in-base"><i class="fa fa-check"></i><b>14.4.2</b> Implementation in base</a></li>
<li class="chapter" data-level="14.4.3" data-path="its-just-a-linear-model.html"><a href="its-just-a-linear-model.html#implementation-in-tidymodels-1"><i class="fa fa-check"></i><b>14.4.3</b> Implementation in <code>tidymodels</code></a></li>
<li class="chapter" data-level="14.4.4" data-path="its-just-a-linear-model.html"><a href="its-just-a-linear-model.html#implementation-in-rstanarm-1"><i class="fa fa-check"></i><b>14.4.4</b> Implementation in <code>rstanarm</code></a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="its-just-a-linear-model.html"><a href="its-just-a-linear-model.html#poisson-regression"><i class="fa fa-check"></i><b>14.5</b> Poisson regression</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="its-just-a-linear-model.html"><a href="its-just-a-linear-model.html#overview-3"><i class="fa fa-check"></i><b>14.5.1</b> Overview</a></li>
<li class="chapter" data-level="14.5.2" data-path="its-just-a-linear-model.html"><a href="its-just-a-linear-model.html#implementation-in-base-1"><i class="fa fa-check"></i><b>14.5.2</b> Implementation in base</a></li>
<li class="chapter" data-level="14.5.3" data-path="its-just-a-linear-model.html"><a href="its-just-a-linear-model.html#implementation-in-tidymodels-2"><i class="fa fa-check"></i><b>14.5.3</b> Implementation in <code>tidymodels</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="causality-from-observational-data.html"><a href="causality-from-observational-data.html"><i class="fa fa-check"></i><b>15</b> Causality from observational data</a>
<ul>
<li class="chapter" data-level="15.1" data-path="causality-from-observational-data.html"><a href="causality-from-observational-data.html#introduction-17"><i class="fa fa-check"></i><b>15.1</b> Introduction</a></li>
<li class="chapter" data-level="15.2" data-path="causality-from-observational-data.html"><a href="causality-from-observational-data.html#dags-and-trying-not-to-be-tricked-by-the-data"><i class="fa fa-check"></i><b>15.2</b> DAGs and trying not to be tricked by the data</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="causality-from-observational-data.html"><a href="causality-from-observational-data.html#dags-and-confounding"><i class="fa fa-check"></i><b>15.2.1</b> DAGs and confounding</a></li>
<li class="chapter" data-level="15.2.2" data-path="causality-from-observational-data.html"><a href="causality-from-observational-data.html#selection-and-measurement-bias"><i class="fa fa-check"></i><b>15.2.2</b> Selection and measurement bias</a></li>
<li class="chapter" data-level="15.2.3" data-path="causality-from-observational-data.html"><a href="causality-from-observational-data.html#two-common-paradoxes"><i class="fa fa-check"></i><b>15.2.3</b> Two common paradoxes</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="causality-from-observational-data.html"><a href="causality-from-observational-data.html#difference-in-differences"><i class="fa fa-check"></i><b>15.3</b> Difference in differences</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="causality-from-observational-data.html"><a href="causality-from-observational-data.html#matching-and-difference-in-differences"><i class="fa fa-check"></i><b>15.3.1</b> Matching and difference-in-differences</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="causality-from-observational-data.html"><a href="causality-from-observational-data.html#case-study---lower-advertising-revenue-reduced-french-newspaper-prices-between-1960-and-1974"><i class="fa fa-check"></i><b>15.4</b> Case study - Lower advertising revenue reduced French newspaper prices between 1960 and 1974</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="causality-from-observational-data.html"><a href="causality-from-observational-data.html#introduction-19"><i class="fa fa-check"></i><b>15.4.1</b> Introduction</a></li>
<li class="chapter" data-level="15.4.2" data-path="causality-from-observational-data.html"><a href="causality-from-observational-data.html#background"><i class="fa fa-check"></i><b>15.4.2</b> Background</a></li>
<li class="chapter" data-level="15.4.3" data-path="causality-from-observational-data.html"><a href="causality-from-observational-data.html#data"><i class="fa fa-check"></i><b>15.4.3</b> Data</a></li>
<li class="chapter" data-level="15.4.4" data-path="causality-from-observational-data.html"><a href="causality-from-observational-data.html#model"><i class="fa fa-check"></i><b>15.4.4</b> Model</a></li>
<li class="chapter" data-level="15.4.5" data-path="causality-from-observational-data.html"><a href="causality-from-observational-data.html#results"><i class="fa fa-check"></i><b>15.4.5</b> Results</a></li>
<li class="chapter" data-level="15.4.6" data-path="causality-from-observational-data.html"><a href="causality-from-observational-data.html#other-points"><i class="fa fa-check"></i><b>15.4.6</b> Other points</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="causality-from-observational-data.html"><a href="causality-from-observational-data.html#case-study---funding-of-clinical-trials-and-reported-drug-efficacy"><i class="fa fa-check"></i><b>15.5</b> Case study - Funding of Clinical Trials and Reported Drug Efficacy</a></li>
<li class="chapter" data-level="15.6" data-path="causality-from-observational-data.html"><a href="causality-from-observational-data.html#regression-discontinuity-design"><i class="fa fa-check"></i><b>15.6</b> Regression discontinuity design</a>
<ul>
<li class="chapter" data-level="15.6.1" data-path="causality-from-observational-data.html"><a href="causality-from-observational-data.html#introduction-20"><i class="fa fa-check"></i><b>15.6.1</b> Introduction</a></li>
<li class="chapter" data-level="15.6.2" data-path="causality-from-observational-data.html"><a href="causality-from-observational-data.html#simulated-example-1"><i class="fa fa-check"></i><b>15.6.2</b> Simulated example</a></li>
<li class="chapter" data-level="15.6.3" data-path="causality-from-observational-data.html"><a href="causality-from-observational-data.html#overlap"><i class="fa fa-check"></i><b>15.6.3</b> Overlap</a></li>
<li class="chapter" data-level="15.6.4" data-path="causality-from-observational-data.html"><a href="causality-from-observational-data.html#examples"><i class="fa fa-check"></i><b>15.6.4</b> Examples</a></li>
<li class="chapter" data-level="15.6.5" data-path="causality-from-observational-data.html"><a href="causality-from-observational-data.html#implementation"><i class="fa fa-check"></i><b>15.6.5</b> Implementation</a></li>
<li class="chapter" data-level="15.6.6" data-path="causality-from-observational-data.html"><a href="causality-from-observational-data.html#fuzzy-rdd"><i class="fa fa-check"></i><b>15.6.6</b> Fuzzy RDD</a></li>
<li class="chapter" data-level="15.6.7" data-path="causality-from-observational-data.html"><a href="causality-from-observational-data.html#threats-to-validity"><i class="fa fa-check"></i><b>15.6.7</b> Threats to validity</a></li>
<li class="chapter" data-level="15.6.8" data-path="causality-from-observational-data.html"><a href="causality-from-observational-data.html#weaknesses"><i class="fa fa-check"></i><b>15.6.8</b> Weaknesses</a></li>
</ul></li>
<li class="chapter" data-level="15.7" data-path="causality-from-observational-data.html"><a href="causality-from-observational-data.html#case-study---stiers-hooghe-and-dassonneville-2020"><i class="fa fa-check"></i><b>15.7</b> Case study - Stiers, Hooghe, and Dassonneville, 2020</a></li>
<li class="chapter" data-level="15.8" data-path="causality-from-observational-data.html"><a href="causality-from-observational-data.html#case-study---caughey-and-sekhon.-2011"><i class="fa fa-check"></i><b>15.8</b> Case study - Caughey, and Sekhon., 2011</a></li>
<li class="chapter" data-level="15.9" data-path="causality-from-observational-data.html"><a href="causality-from-observational-data.html#instrumental-variables"><i class="fa fa-check"></i><b>15.9</b> Instrumental variables</a>
<ul>
<li class="chapter" data-level="15.9.1" data-path="causality-from-observational-data.html"><a href="causality-from-observational-data.html#introduction-21"><i class="fa fa-check"></i><b>15.9.1</b> Introduction</a></li>
<li class="chapter" data-level="15.9.2" data-path="causality-from-observational-data.html"><a href="causality-from-observational-data.html#history"><i class="fa fa-check"></i><b>15.9.2</b> History</a></li>
<li class="chapter" data-level="15.9.3" data-path="causality-from-observational-data.html"><a href="causality-from-observational-data.html#simulated-example-2"><i class="fa fa-check"></i><b>15.9.3</b> Simulated example</a></li>
<li class="chapter" data-level="15.9.4" data-path="causality-from-observational-data.html"><a href="causality-from-observational-data.html#implementation-1"><i class="fa fa-check"></i><b>15.9.4</b> Implementation</a></li>
<li class="chapter" data-level="15.9.5" data-path="causality-from-observational-data.html"><a href="causality-from-observational-data.html#assumptions-1"><i class="fa fa-check"></i><b>15.9.5</b> Assumptions</a></li>
<li class="chapter" data-level="15.9.6" data-path="causality-from-observational-data.html"><a href="causality-from-observational-data.html#conclusion"><i class="fa fa-check"></i><b>15.9.6</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="15.10" data-path="causality-from-observational-data.html"><a href="causality-from-observational-data.html#case-study---effect-of-police-on-crime"><i class="fa fa-check"></i><b>15.10</b> Case study - Effect of Police on Crime</a>
<ul>
<li class="chapter" data-level="15.10.1" data-path="causality-from-observational-data.html"><a href="causality-from-observational-data.html#overview-4"><i class="fa fa-check"></i><b>15.10.1</b> Overview</a></li>
<li class="chapter" data-level="15.10.2" data-path="causality-from-observational-data.html"><a href="causality-from-observational-data.html#data-1"><i class="fa fa-check"></i><b>15.10.2</b> Data</a></li>
<li class="chapter" data-level="15.10.3" data-path="causality-from-observational-data.html"><a href="causality-from-observational-data.html#model-1"><i class="fa fa-check"></i><b>15.10.3</b> Model</a></li>
<li class="chapter" data-level="15.10.4" data-path="causality-from-observational-data.html"><a href="causality-from-observational-data.html#discussion"><i class="fa fa-check"></i><b>15.10.4</b> Discussion</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="poll-of-polls.html"><a href="poll-of-polls.html"><i class="fa fa-check"></i><b>16</b> Poll of polls</a>
<ul>
<li class="chapter" data-level="16.1" data-path="poll-of-polls.html"><a href="poll-of-polls.html#introduction-22"><i class="fa fa-check"></i><b>16.1</b> Introduction</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="multilevel-regression-with-post-stratification.html"><a href="multilevel-regression-with-post-stratification.html"><i class="fa fa-check"></i><b>17</b> Multilevel regression with post-stratification</a>
<ul>
<li class="chapter" data-level="17.1" data-path="multilevel-regression-with-post-stratification.html"><a href="multilevel-regression-with-post-stratification.html#introduction-23"><i class="fa fa-check"></i><b>17.1</b> Introduction</a></li>
<li class="chapter" data-level="17.2" data-path="multilevel-regression-with-post-stratification.html"><a href="multilevel-regression-with-post-stratification.html#simulation---toddler-bedtimes"><i class="fa fa-check"></i><b>17.2</b> Simulation - Toddler bedtimes</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="multilevel-regression-with-post-stratification.html"><a href="multilevel-regression-with-post-stratification.html#construct-a-population"><i class="fa fa-check"></i><b>17.2.1</b> Construct a population</a></li>
<li class="chapter" data-level="17.2.2" data-path="multilevel-regression-with-post-stratification.html"><a href="multilevel-regression-with-post-stratification.html#get-a-biased-sample-from-it"><i class="fa fa-check"></i><b>17.2.2</b> Get a biased sample from it</a></li>
<li class="chapter" data-level="17.2.3" data-path="multilevel-regression-with-post-stratification.html"><a href="multilevel-regression-with-post-stratification.html#model-the-sample"><i class="fa fa-check"></i><b>17.2.3</b> Model the sample</a></li>
<li class="chapter" data-level="17.2.4" data-path="multilevel-regression-with-post-stratification.html"><a href="multilevel-regression-with-post-stratification.html#get-a-post-stratification-dataset"><i class="fa fa-check"></i><b>17.2.4</b> Get a post-stratification dataset</a></li>
<li class="chapter" data-level="17.2.5" data-path="multilevel-regression-with-post-stratification.html"><a href="multilevel-regression-with-post-stratification.html#post-stratify-our-model-estimates"><i class="fa fa-check"></i><b>17.2.5</b> Post-stratify our model estimates</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="multilevel-regression-with-post-stratification.html"><a href="multilevel-regression-with-post-stratification.html#case-study---xbox-paper"><i class="fa fa-check"></i><b>17.3</b> Case study - Xbox paper</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="multilevel-regression-with-post-stratification.html"><a href="multilevel-regression-with-post-stratification.html#overview-5"><i class="fa fa-check"></i><b>17.3.1</b> Overview</a></li>
<li class="chapter" data-level="17.3.2" data-path="multilevel-regression-with-post-stratification.html"><a href="multilevel-regression-with-post-stratification.html#model-2"><i class="fa fa-check"></i><b>17.3.2</b> Model</a></li>
<li class="chapter" data-level="17.3.3" data-path="multilevel-regression-with-post-stratification.html"><a href="multilevel-regression-with-post-stratification.html#post-stratify"><i class="fa fa-check"></i><b>17.3.3</b> Post-stratify</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="multilevel-regression-with-post-stratification.html"><a href="multilevel-regression-with-post-stratification.html#simulation---australian-voting"><i class="fa fa-check"></i><b>17.4</b> Simulation - Australian voting</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="multilevel-regression-with-post-stratification.html"><a href="multilevel-regression-with-post-stratification.html#overview-6"><i class="fa fa-check"></i><b>17.4.1</b> Overview</a></li>
<li class="chapter" data-level="17.4.2" data-path="multilevel-regression-with-post-stratification.html"><a href="multilevel-regression-with-post-stratification.html#construct-a-survey"><i class="fa fa-check"></i><b>17.4.2</b> Construct a survey</a></li>
<li class="chapter" data-level="17.4.3" data-path="multilevel-regression-with-post-stratification.html"><a href="multilevel-regression-with-post-stratification.html#model-the-survey"><i class="fa fa-check"></i><b>17.4.3</b> Model the survey</a></li>
<li class="chapter" data-level="17.4.4" data-path="multilevel-regression-with-post-stratification.html"><a href="multilevel-regression-with-post-stratification.html#post-stratify-1"><i class="fa fa-check"></i><b>17.4.4</b> Post-stratify</a></li>
<li class="chapter" data-level="17.4.5" data-path="multilevel-regression-with-post-stratification.html"><a href="multilevel-regression-with-post-stratification.html#improving-the-model"><i class="fa fa-check"></i><b>17.4.5</b> Improving the model</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="multilevel-regression-with-post-stratification.html"><a href="multilevel-regression-with-post-stratification.html#case-study---forecasting-the-2020-us-election"><i class="fa fa-check"></i><b>17.5</b> Case study - Forecasting the 2020 US election</a>
<ul>
<li class="chapter" data-level="17.5.1" data-path="multilevel-regression-with-post-stratification.html"><a href="multilevel-regression-with-post-stratification.html#survey-data"><i class="fa fa-check"></i><b>17.5.1</b> Survey data</a></li>
<li class="chapter" data-level="17.5.2" data-path="multilevel-regression-with-post-stratification.html"><a href="multilevel-regression-with-post-stratification.html#post-stratification-data"><i class="fa fa-check"></i><b>17.5.2</b> Post-stratification data</a></li>
<li class="chapter" data-level="17.5.3" data-path="multilevel-regression-with-post-stratification.html"><a href="multilevel-regression-with-post-stratification.html#model-3"><i class="fa fa-check"></i><b>17.5.3</b> Model</a></li>
</ul></li>
<li class="chapter" data-level="17.6" data-path="multilevel-regression-with-post-stratification.html"><a href="multilevel-regression-with-post-stratification.html#case-study---self-reported-abortion-incidence-in-uganda"><i class="fa fa-check"></i><b>17.6</b> Case study - Self-reported abortion incidence in Uganda</a>
<ul>
<li class="chapter" data-level="17.6.1" data-path="multilevel-regression-with-post-stratification.html"><a href="multilevel-regression-with-post-stratification.html#load-in-data-and-tidy-up"><i class="fa fa-check"></i><b>17.6.1</b> Load in data and tidy up</a></li>
<li class="chapter" data-level="17.6.2" data-path="multilevel-regression-with-post-stratification.html"><a href="multilevel-regression-with-post-stratification.html#plot-data"><i class="fa fa-check"></i><b>17.6.2</b> Plot data</a></li>
<li class="chapter" data-level="17.6.3" data-path="multilevel-regression-with-post-stratification.html"><a href="multilevel-regression-with-post-stratification.html#multilevel-regression"><i class="fa fa-check"></i><b>17.6.3</b> Multilevel regression</a></li>
<li class="chapter" data-level="17.6.4" data-path="multilevel-regression-with-post-stratification.html"><a href="multilevel-regression-with-post-stratification.html#post-stratify-the-predicted-proportions"><i class="fa fa-check"></i><b>17.6.4</b> Post-stratify the predicted proportions</a></li>
<li class="chapter" data-level="17.6.5" data-path="multilevel-regression-with-post-stratification.html"><a href="multilevel-regression-with-post-stratification.html#plotting-and-comparing-estimates"><i class="fa fa-check"></i><b>17.6.5</b> Plotting and comparing estimates</a></li>
</ul></li>
<li class="chapter" data-level="17.7" data-path="multilevel-regression-with-post-stratification.html"><a href="multilevel-regression-with-post-stratification.html#concluding-remarks"><i class="fa fa-check"></i><b>17.7</b> Concluding remarks</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="text-as-data.html"><a href="text-as-data.html"><i class="fa fa-check"></i><b>18</b> Text as data</a>
<ul>
<li class="chapter" data-level="18.1" data-path="text-as-data.html"><a href="text-as-data.html#introduction-24"><i class="fa fa-check"></i><b>18.1</b> Introduction</a></li>
<li class="chapter" data-level="18.2" data-path="text-as-data.html"><a href="text-as-data.html#lasso-regression"><i class="fa fa-check"></i><b>18.2</b> Lasso regression</a></li>
<li class="chapter" data-level="18.3" data-path="text-as-data.html"><a href="text-as-data.html#topic-models"><i class="fa fa-check"></i><b>18.3</b> Topic models</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="text-as-data.html"><a href="text-as-data.html#overview-7"><i class="fa fa-check"></i><b>18.3.1</b> Overview</a></li>
<li class="chapter" data-level="18.3.2" data-path="text-as-data.html"><a href="text-as-data.html#document-generation-process"><i class="fa fa-check"></i><b>18.3.2</b> Document generation process</a></li>
<li class="chapter" data-level="18.3.3" data-path="text-as-data.html"><a href="text-as-data.html#analysis-process"><i class="fa fa-check"></i><b>18.3.3</b> Analysis process</a></li>
<li class="chapter" data-level="18.3.4" data-path="text-as-data.html"><a href="text-as-data.html#warnings-and-extensions"><i class="fa fa-check"></i><b>18.3.4</b> Warnings and extensions</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="text-as-data.html"><a href="text-as-data.html#word-embedding"><i class="fa fa-check"></i><b>18.4</b> Word embedding</a></li>
<li class="chapter" data-level="18.5" data-path="text-as-data.html"><a href="text-as-data.html#conclusion-1"><i class="fa fa-check"></i><b>18.5</b> Conclusion</a></li>
</ul></li>
<li class="part"><span><b>VI Scale</b></span></li>
<li class="chapter" data-level="19" data-path="cloud.html"><a href="cloud.html"><i class="fa fa-check"></i><b>19</b> Cloud</a>
<ul>
<li class="chapter" data-level="19.1" data-path="cloud.html"><a href="cloud.html#introduction-25"><i class="fa fa-check"></i><b>19.1</b> Introduction</a></li>
<li class="chapter" data-level="19.2" data-path="cloud.html"><a href="cloud.html#google-colab"><i class="fa fa-check"></i><b>19.2</b> Google Colab</a></li>
<li class="chapter" data-level="19.3" data-path="cloud.html"><a href="cloud.html#aws"><i class="fa fa-check"></i><b>19.3</b> AWS</a></li>
<li class="chapter" data-level="19.4" data-path="cloud.html"><a href="cloud.html#google-compute-engine"><i class="fa fa-check"></i><b>19.4</b> Google Compute Engine</a></li>
<li class="chapter" data-level="19.5" data-path="cloud.html"><a href="cloud.html#azure"><i class="fa fa-check"></i><b>19.5</b> Azure</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="deploy.html"><a href="deploy.html"><i class="fa fa-check"></i><b>20</b> Deploy</a>
<ul>
<li class="chapter" data-level="20.1" data-path="deploy.html"><a href="deploy.html#introduction-26"><i class="fa fa-check"></i><b>20.1</b> Introduction</a></li>
<li class="chapter" data-level="20.2" data-path="deploy.html"><a href="deploy.html#packages"><i class="fa fa-check"></i><b>20.2</b> Packages</a></li>
<li class="chapter" data-level="20.3" data-path="deploy.html"><a href="deploy.html#shiny-1"><i class="fa fa-check"></i><b>20.3</b> Shiny</a></li>
<li class="chapter" data-level="20.4" data-path="deploy.html"><a href="deploy.html#plumber-and-model-apis"><i class="fa fa-check"></i><b>20.4</b> Plumber and model APIs</a>
<ul>
<li class="chapter" data-level="20.4.1" data-path="deploy.html"><a href="deploy.html#hello-toronto"><i class="fa fa-check"></i><b>20.4.1</b> Hello Toronto</a></li>
<li class="chapter" data-level="20.4.2" data-path="deploy.html"><a href="deploy.html#local-model"><i class="fa fa-check"></i><b>20.4.2</b> Local model</a></li>
<li class="chapter" data-level="20.4.3" data-path="deploy.html"><a href="deploy.html#cloud-model"><i class="fa fa-check"></i><b>20.4.3</b> Cloud model</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>VII Assessment</b></span></li>
<li class="chapter" data-level="21" data-path="papers.html"><a href="papers.html"><i class="fa fa-check"></i><b>21</b> Papers</a>
<ul>
<li class="chapter" data-level="21.1" data-path="papers.html"><a href="papers.html#mandatory-minimums"><i class="fa fa-check"></i><b>21.1</b> ‘Mandatory Minimums’</a>
<ul>
<li class="chapter" data-level="21.1.1" data-path="papers.html"><a href="papers.html#task"><i class="fa fa-check"></i><b>21.1.1</b> Task</a></li>
<li class="chapter" data-level="21.1.2" data-path="papers.html"><a href="papers.html#guidance"><i class="fa fa-check"></i><b>21.1.2</b> Guidance</a></li>
<li class="chapter" data-level="21.1.3" data-path="papers.html"><a href="papers.html#check-offs-points"><i class="fa fa-check"></i><b>21.1.3</b> Check offs points</a></li>
<li class="chapter" data-level="21.1.4" data-path="papers.html"><a href="papers.html#faq"><i class="fa fa-check"></i><b>21.1.4</b> FAQ</a></li>
<li class="chapter" data-level="21.1.5" data-path="papers.html"><a href="papers.html#rubric"><i class="fa fa-check"></i><b>21.1.5</b> Rubric</a></li>
<li class="chapter" data-level="21.1.6" data-path="papers.html"><a href="papers.html#previous-examples"><i class="fa fa-check"></i><b>21.1.6</b> Previous examples</a></li>
</ul></li>
<li class="chapter" data-level="21.2" data-path="papers.html"><a href="papers.html#these-numbers-mean-dial-it-up"><i class="fa fa-check"></i><b>21.2</b> ‘These numbers mean dial it up’</a>
<ul>
<li class="chapter" data-level="21.2.1" data-path="papers.html"><a href="papers.html#task-1"><i class="fa fa-check"></i><b>21.2.1</b> Task</a></li>
<li class="chapter" data-level="21.2.2" data-path="papers.html"><a href="papers.html#guidance-1"><i class="fa fa-check"></i><b>21.2.2</b> Guidance</a></li>
<li class="chapter" data-level="21.2.3" data-path="papers.html"><a href="papers.html#check-offs-points-1"><i class="fa fa-check"></i><b>21.2.3</b> Check offs points</a></li>
<li class="chapter" data-level="21.2.4" data-path="papers.html"><a href="papers.html#faq-1"><i class="fa fa-check"></i><b>21.2.4</b> FAQ</a></li>
<li class="chapter" data-level="21.2.5" data-path="papers.html"><a href="papers.html#rubric-1"><i class="fa fa-check"></i><b>21.2.5</b> Rubric</a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="papers.html"><a href="papers.html#the-short-list"><i class="fa fa-check"></i><b>21.3</b> ‘The Short List’</a>
<ul>
<li class="chapter" data-level="21.3.1" data-path="papers.html"><a href="papers.html#task-2"><i class="fa fa-check"></i><b>21.3.1</b> Task</a></li>
<li class="chapter" data-level="21.3.2" data-path="papers.html"><a href="papers.html#guidance-2"><i class="fa fa-check"></i><b>21.3.2</b> Guidance</a></li>
<li class="chapter" data-level="21.3.3" data-path="papers.html"><a href="papers.html#check-offs-points-2"><i class="fa fa-check"></i><b>21.3.3</b> Check offs points</a></li>
<li class="chapter" data-level="21.3.4" data-path="papers.html"><a href="papers.html#faq-2"><i class="fa fa-check"></i><b>21.3.4</b> FAQ</a></li>
<li class="chapter" data-level="21.3.5" data-path="papers.html"><a href="papers.html#rubric-2"><i class="fa fa-check"></i><b>21.3.5</b> Rubric</a></li>
</ul></li>
<li class="chapter" data-level="21.4" data-path="papers.html"><a href="papers.html#two-cathedrals"><i class="fa fa-check"></i><b>21.4</b> ‘Two Cathedrals’</a>
<ul>
<li class="chapter" data-level="21.4.1" data-path="papers.html"><a href="papers.html#task-3"><i class="fa fa-check"></i><b>21.4.1</b> Task</a></li>
<li class="chapter" data-level="21.4.2" data-path="papers.html"><a href="papers.html#guidance-3"><i class="fa fa-check"></i><b>21.4.2</b> Guidance</a></li>
<li class="chapter" data-level="21.4.3" data-path="papers.html"><a href="papers.html#peer-review-submission"><i class="fa fa-check"></i><b>21.4.3</b> Peer review submission</a></li>
<li class="chapter" data-level="21.4.4" data-path="papers.html"><a href="papers.html#conduct-peer-review"><i class="fa fa-check"></i><b>21.4.4</b> Conduct peer-review</a></li>
<li class="chapter" data-level="21.4.5" data-path="papers.html"><a href="papers.html#check-offs-points-3"><i class="fa fa-check"></i><b>21.4.5</b> Check offs points</a></li>
<li class="chapter" data-level="21.4.6" data-path="papers.html"><a href="papers.html#faq-3"><i class="fa fa-check"></i><b>21.4.6</b> FAQ</a></li>
<li class="chapter" data-level="21.4.7" data-path="papers.html"><a href="papers.html#rubric-3"><i class="fa fa-check"></i><b>21.4.7</b> Rubric</a></li>
</ul></li>
<li class="chapter" data-level="21.5" data-path="papers.html"><a href="papers.html#a-proportional-response"><i class="fa fa-check"></i><b>21.5</b> ‘A Proportional Response’</a>
<ul>
<li class="chapter" data-level="21.5.1" data-path="papers.html"><a href="papers.html#task-4"><i class="fa fa-check"></i><b>21.5.1</b> Task</a></li>
<li class="chapter" data-level="21.5.2" data-path="papers.html"><a href="papers.html#recommended-steps"><i class="fa fa-check"></i><b>21.5.2</b> Recommended steps</a></li>
<li class="chapter" data-level="21.5.3" data-path="papers.html"><a href="papers.html#check-offs-points-4"><i class="fa fa-check"></i><b>21.5.3</b> Check offs points</a></li>
<li class="chapter" data-level="21.5.4" data-path="papers.html"><a href="papers.html#faq-4"><i class="fa fa-check"></i><b>21.5.4</b> FAQ</a></li>
</ul></li>
<li class="chapter" data-level="21.6" data-path="papers.html"><a href="papers.html#mr-willis-of-ohio"><i class="fa fa-check"></i><b>21.6</b> ‘Mr Willis of Ohio’</a>
<ul>
<li class="chapter" data-level="21.6.1" data-path="papers.html"><a href="papers.html#task-5"><i class="fa fa-check"></i><b>21.6.1</b> Task</a></li>
<li class="chapter" data-level="21.6.2" data-path="papers.html"><a href="papers.html#recommended-steps-1"><i class="fa fa-check"></i><b>21.6.2</b> Recommended steps</a></li>
<li class="chapter" data-level="21.6.3" data-path="papers.html"><a href="papers.html#check-offs-points-5"><i class="fa fa-check"></i><b>21.6.3</b> Check offs points</a></li>
<li class="chapter" data-level="21.6.4" data-path="papers.html"><a href="papers.html#faq-5"><i class="fa fa-check"></i><b>21.6.4</b> FAQ</a></li>
</ul></li>
<li class="chapter" data-level="21.7" data-path="papers.html"><a href="papers.html#five-votes-down"><i class="fa fa-check"></i><b>21.7</b> ‘Five Votes Down’</a>
<ul>
<li class="chapter" data-level="21.7.1" data-path="papers.html"><a href="papers.html#task-6"><i class="fa fa-check"></i><b>21.7.1</b> Task</a></li>
<li class="chapter" data-level="21.7.2" data-path="papers.html"><a href="papers.html#recommended-steps-2"><i class="fa fa-check"></i><b>21.7.2</b> Recommended steps</a></li>
<li class="chapter" data-level="21.7.3" data-path="papers.html"><a href="papers.html#check-offs-points-6"><i class="fa fa-check"></i><b>21.7.3</b> Check offs points</a></li>
<li class="chapter" data-level="21.7.4" data-path="papers.html"><a href="papers.html#faq-6"><i class="fa fa-check"></i><b>21.7.4</b> FAQ</a></li>
</ul></li>
<li class="chapter" data-level="21.8" data-path="papers.html"><a href="papers.html#whats-next"><i class="fa fa-check"></i><b>21.8</b> ‘What’s next?’</a>
<ul>
<li class="chapter" data-level="21.8.1" data-path="papers.html"><a href="papers.html#task-7"><i class="fa fa-check"></i><b>21.8.1</b> Task</a></li>
<li class="chapter" data-level="21.8.2" data-path="papers.html"><a href="papers.html#recommended-steps-3"><i class="fa fa-check"></i><b>21.8.2</b> Recommended steps</a></li>
<li class="chapter" data-level="21.8.3" data-path="papers.html"><a href="papers.html#check-offs-points-7"><i class="fa fa-check"></i><b>21.8.3</b> Check offs points</a></li>
<li class="chapter" data-level="21.8.4" data-path="papers.html"><a href="papers.html#faq-7"><i class="fa fa-check"></i><b>21.8.4</b> FAQ</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references-1.html"><a href="references-1.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Telling Stories With Data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="its-just-a-linear-model" class="section level1" number="14">
<h1><span class="header-section-number">Chapter 14</span> It’s Just A Linear Model</h1>
<p><em>Last updated: 16 March 2021.</em></p>
<p><strong>Required reading</strong></p>
<ul>
<li>Greenland, Sander, Stephen J. Senn, Kenneth J. Rothman, John B. Carlin, Charles Poole, Steven N. Goodman, and Douglas G. Altman, 2016, ‘Statistical tests, P values, confidence intervals, and power: a guide to misinterpretations,’ <em>European journal of epidemiology</em>, 31, no. 4, pp. 337-350.</li>
<li>James, Gareth, Daniela Witten, Trevor Hastie and Robert Tibshirani, 2017, <em>An Introduction to Statistical Learning with Applications in R</em>, 1st Edition, Chapters 3 and 4.1-4.3., <a href="https://www.statlearning.com" class="uri">https://www.statlearning.com</a>.</li>
<li>Obermeyer, Z., Powers, B., Vogeli, C., &amp; Sendhill, M., 2019, ‘Dissecting racial bias in an algorithm used to manage the health of populations,’ <em>Science</em>, (366): 447-453.</li>
<li>Wickham, Hadley, and Garrett Grolemund, 2017, <em>R for Data Science</em>, Chapter 23, <a href="https://r4ds.had.co.nz/" class="uri">https://r4ds.had.co.nz/</a>.</li>
<li>Zook M, Barocas S, boyd d, Crawford K, Keller E, Gangadharan SP, et al. (2017) ‘Ten simple rules for responsible big data research,’ <em>PLoS Comput Biol</em> 13(3): e1005399. <a href="https://doi.org/10.1371/journal.pcbi.1005399" class="uri">https://doi.org/10.1371/journal.pcbi.1005399</a></li>
</ul>
<p><strong>Recommended reading</strong></p>
<ul>
<li>Angrist, Joshua D., and Jörn-Steffen Pischke, 2008, <em>Mostly harmless econometrics: An empiricist’s companion</em>, Princeton University Press, Chapter 3.4.3.</li>
<li>Cunningham, Scott, <em>Causal Inference: The Mixtape</em>, Chapter 2, Yale University Press, <a href="https://mixtape.scunning.com" class="uri">https://mixtape.scunning.com</a>.</li>
<li>ElHabr, Tony, 2019, ‘A Bayesian Approach to Ranking English Premier League Teams (using R),’ <a href="https://tonyelhabr.rbind.io/post/bayesian-statistics-english-premier-league/" class="uri">https://tonyelhabr.rbind.io/post/bayesian-statistics-english-premier-league/</a>.</li>
<li>Ioannidis, John PA, 2005, ‘Why most published research findings are false,’ <em>PLoS medicine</em>, 2, no. 8, e124.</li>
<li>Pavlik, Kaylin, 2018, ‘Exploring the Relationship Between Dog Names and Breeds,’ <a href="https://www.kaylinpavlik.com/dog-names-tfidf/" class="uri">https://www.kaylinpavlik.com/dog-names-tfidf/</a>.</li>
<li>Pavlik, Kaylin, 2019, ‘Understanding + classifying genres using Spotify audio features,’ <a href="https://www.kaylinpavlik.com/classifying-songs-genres/" class="uri">https://www.kaylinpavlik.com/classifying-songs-genres/</a>.</li>
<li>Silge, Julia, 2019, ‘Modeling salary and gender in the tech industry,’ <a href="https://juliasilge.com/blog/salary-gender/" class="uri">https://juliasilge.com/blog/salary-gender/</a>.</li>
<li>Silge, Julia, 2019, ‘Opioid prescribing habits in Texas,’ <a href="https://juliasilge.com/blog/texas-opioids/" class="uri">https://juliasilge.com/blog/texas-opioids/</a>.</li>
<li>Silge, Julia, 2019, ‘Tidymodels,’ <a href="https://juliasilge.com/blog/intro-tidymodels/" class="uri">https://juliasilge.com/blog/intro-tidymodels/</a>.</li>
<li>Silge, Julia, 2020, ‘#TidyTuesday hotel bookings and recipes,’ <a href="https://juliasilge.com/blog/hotels-recipes/" class="uri">https://juliasilge.com/blog/hotels-recipes/</a>.</li>
<li>Silge, Julia, 2020, ‘Hyperparameter tuning and #TidyTuesday food consumption,’ <a href="https://juliasilge.com/blog/food-hyperparameter-tune/" class="uri">https://juliasilge.com/blog/food-hyperparameter-tune/</a>.</li>
<li>Taddy, Matt, 2019, <em>Business Data Science</em>, Chapters 2 and 4.</li>
<li>Wasserstein, Ronald L. and Nicole A. Lazar, 2016, ‘The ASA Statement on p-Values: Context, Process, and Purpose,’ <em>The American Statistician</em>, 70:2, 129-133, DOI: 10.1080/00031305.2016.1154108.</li>
</ul>
<p><strong>Fun reading</strong></p>
<ul>
<li>Chellel, Kit, 2018, ‘The Gambler Who Cracked the Horse-Racing Code,’ <em>Bloomberg Businessweek</em>, 3 May, <a href="https://www.bloomberg.com/news/features/2018-05-03/the-gambler-who-cracked-the-horse-racing-code" class="uri">https://www.bloomberg.com/news/features/2018-05-03/the-gambler-who-cracked-the-horse-racing-code</a>.</li>
</ul>
<!-- https://rviews.rstudio.com/2020/03/10/comparing-machine-learning-algorithms-for-predicting-clothing-classes-part-3/ -->
<!-- https://juliasilge.com/blog/tuition-resampling/ -->
<!-- https://easystats.github.io/performance/index.html -->
<p><strong>Key concepts/skills/etc</strong></p>
<ul>
<li>Simple and multiple linear regression.</li>
<li>Logistic and Poisson regression.</li>
<li>The key role of uncertainty.</li>
<li>Threats to validity of inferences</li>
<li>Overfitting.</li>
</ul>
<p><strong>Key libraries</strong></p>
<ul>
<li><code>broom</code></li>
<li><code>huxtable</code></li>
<li><code>rstanarm</code></li>
<li><code>tidymodels</code></li>
<li><code>tidyverse</code></li>
</ul>
<p><strong>Key functions</strong></p>
<ul>
<li><code>broom::augment()</code></li>
<li><code>broom::glance()</code></li>
<li><code>broom::tidy()</code></li>
<li><code>glm()</code></li>
<li><code>huxtable::huxreg()</code></li>
<li><code>lm()</code></li>
<li><code>parsnip::fit()</code></li>
<li><code>parsnip::linear_reg()</code></li>
<li><code>parsnip::logistic_reg()</code></li>
<li><code>parsnip::set_engine()</code></li>
<li><code>poissonreg::poisson_reg()</code></li>
<li><code>rnorm()</code></li>
<li><code>rpois()</code></li>
<li><code>rsample::initial_split()</code></li>
<li><code>rsample::testing()</code></li>
<li><code>rsample::training()</code></li>
<li><code>sample()</code></li>
<li><code>set.seed()</code></li>
<li><code>summary()</code></li>
</ul>
<p><strong>Quiz</strong></p>
<ol style="list-style-type: decimal">
<li>Please write a linear relationship between some response variable, Y, and some predictor, X. What is the intercept term? What is the slope term? What would adding a hat to these indicate?</li>
<li>What is the least squares criterion? Similarly, what is RSS and what are we trying to do when we run least squares regression?</li>
<li>What is statistical bias?</li>
<li>If there were three variables: Snow, Temperature, and Wind, please write R code that would fit a simple linear regression to explain Snow as a function of Temperature and Wind. What do you think about another explanatory variable - daily stock market returns - to your model?</li>
<li>According to <span class="citation"><a href="references-1.html#ref-greenland2016statistical" role="doc-biblioref">Greenland et al.</a> (<a href="references-1.html#ref-greenland2016statistical" role="doc-biblioref">2016</a>)</span>, p-values test (pick one)?
<ol style="list-style-type: lower-alpha">
<li>All the assumptions about how the data were generated (the entire model), not just the targeted hypothesis it is supposed to test (such as a null hypothesis).</li>
<li>Whether the hypothesis targeted for testing is true or not.</li>
<li>A dichotomy whereby results can be declared ‘statistically significant.’</li>
</ol></li>
<li>According to <span class="citation"><a href="references-1.html#ref-greenland2016statistical" role="doc-biblioref">Greenland et al.</a> (<a href="references-1.html#ref-greenland2016statistical" role="doc-biblioref">2016</a>)</span>, a p-value may be small because (select all)?
<ol style="list-style-type: lower-alpha">
<li>The targeted hypothesis is false.</li>
<li>The study protocols were violated.</li>
<li>It was selected for presentation based on its small size.</li>
</ol></li>
<li>According to <span class="citation"><a href="references-1.html#ref-obermeyer2019dissecting" role="doc-biblioref">Obermeyer et al.</a> (<a href="references-1.html#ref-obermeyer2019dissecting" role="doc-biblioref">2019</a>)</span>, why does racial bias occur in an algorithm used to guide health decisions in the US (pick one)?
<ol style="list-style-type: lower-alpha">
<li>The algorithm uses health costs as a proxy for health needs.</li>
<li>The algorithm was trained on Reddit data.</li>
</ol></li>
<li>When should we use logistic regression (pick one)?
<ol style="list-style-type: lower-alpha">
<li>Continuous dependent variable.</li>
<li>Binary dependent variable.</li>
<li>Count dependent variable.</li>
</ol></li>
<li>I am interested in studying how voting intentions in the recent US presidential election vary by an individual’s income. I set up a logistic regression model to study this relationship. In my study, one possible dependent variable would be (pick one)?
<ol style="list-style-type: lower-alpha">
<li>Whether the respondent is a US citizen (yes/no)</li>
<li>The respondent’s personal income (high/low)</li>
<li>Whether the respondent is going to vote for Trump (yes/no)</li>
<li>Who the respondent voted for in 2016 (Trump/Clinton)</li>
</ol></li>
<li>I am interested in studying how voting intentions in the recent US presidential election vary by an individual’s income. I set up a logistic regression model to study this relationship. In my study, one possible dependent variable would be (pick one)?
<ol style="list-style-type: lower-alpha">
<li>The race of the respondent (white/not white)</li>
<li>The respondent’s marital status (married/not)</li>
<li>Whether the respondent is registered to vote (yes/no)</li>
<li>Whether the respondent is going to vote for Biden (yes/no)</li>
</ol></li>
<li>Please explain what a p-value is, using only the term itself (i.e. ‘p-value’) and words that are amongst the 1,000 most common in the English language according to the XKCD Simple Writer - <a href="https://xkcd.com/simplewriter/" class="uri">https://xkcd.com/simplewriter/</a>. (Please write one or two paragraphs.)</li>
<li>The mean of a Poisson distribution is equal to its?
<ol style="list-style-type: lower-alpha">
<li>Median.</li>
<li>Standard deviation.</li>
<li>Variance.</li>
</ol></li>
</ol>
<div id="overview" class="section level2" number="14.1">
<h2><span class="header-section-number">14.1</span> Overview</h2>
<blockquote>
<p>Words! Mere words! How terrible they were! How clear, and vivid, and cruel! One could not escape from them. And yet what a subtle magic there was in them! They seemed to be able to give a plastic form to formless things, and to have a music of their own as sweet as that of viol or of lute. Mere words! Was there anything so real as words?</p>
<p>Oscar Wilde, <em>The Picture of Dorian Gray</em>.</p>
</blockquote>
<blockquote>
<p>Regression will not sort it out. Regression is indeed an oracle, but a cruel one. It speaks in riddles and delights in punishing us for asking bad questions.</p>
<p><span class="citation"><a href="references-1.html#ref-citemcelreath" role="doc-biblioref">McElreath</a> (<a href="references-1.html#ref-citemcelreath" role="doc-biblioref">2020, 162</a>)</span>.</p>
</blockquote>
<p>Linear models have been around for a long time, at least since Galton and many others (some of whom were eugenicists) used linear regression in earnest. The generalized linear model framework came into being, in a formal sense, in the 70s with the seminal folks being Nelder and Wedderburn <span class="citation">(<a href="references-1.html#ref-nelder1972generalized" role="doc-biblioref">Nelder and Wedderburn 1972</a>)</span>. The idea of generalized linear models is that we broaden the types of outcomes that are allowed. You’re still modelling things as a linear function, but you’re not constrained to an outcome that is normally distributed. The outcome can be anything in the exponential family. A further, well, generalization of generalized linear models is generalized additive models where you’re not generalizing anything to do with the outcome, but instead the structure of the explanatory side, as it were. We’re still explaining the dependent variable as an additive function of bits, but those bits can be functions. This framework, in this way, came about in the 90s, with Hastie and Tibshirani <span class="citation">(<a href="references-1.html#ref-hastie1990generalized" role="doc-biblioref">Hastie and Tibshirani 1990</a>)</span> (fun fact, Tibshirani did a stats masters at Toronto, and was a professor here from 1985 through to 1998!).</p>
<p>It’s important to recognise that when we build models we are not discovering ‘the truth.’ We are using the model to help us explore and understand the data that we have. There is no one best model, there are just useful models that help us learn something about the data that we have and hence, hopefully, something about the world from which the data were generated. Ben Rhodes, who was an Obama staffer, titled his White House memoirs ‘The World as It Is: A Memoir of the Obama White House.’ When we use models, we are similarly trying to understand the world, but as the second part of the title makes clear, there are enormous constraints on the perspective. In the same way that we’d not expect Rhodes to advocate an Australian, Canadian, or even US Republican, perspective about the world, it’s silly to expect one model to be universal.</p>
<p>We use models to understand the world. We poke, push, and test them. We build them and rejoice in their beauty, and then seek to understand their limits and ultimately destroy them. It is this process that is important, it is this process that allows us to better understand the world. <span class="citation"><a href="references-1.html#ref-citemcelreath" role="doc-biblioref">McElreath</a> (<a href="references-1.html#ref-citemcelreath" role="doc-biblioref">2020, 19</a>)</span> talks about small and large worlds, saying ‘(a)ll statistical modeling has these two frames: the small world of the model itself and the large world we hope to deploy the model in.’ To what extent does a model trained on the experiences of straight, cis, men, speak to the world as it is? It’s not worthless, but it’s also not unimpeachable. To what extent does the model teach us about the data that we have? To what extent do the data that we have reflect the world for which we would like to draw conclusions? Keep these questions front of mind.</p>
</div>
<div id="simple-linear-regression" class="section level2" number="14.2">
<h2><span class="header-section-number">14.2</span> Simple linear regression</h2>
<div class="figure"><span id="fig:logregression"></span>
<img src="figures/lolregression.png" alt="Oh my." width="70%" />
<p class="caption">
Figure 14.1: Oh my.
</p>
</div>
<p>Source: <a href="https://twitter.com/mijkenijk/status/1234899588311474176">Mijke Rhemtulla</a>, 3 March 2020.</p>
<div id="overview-1" class="section level3" number="14.2.1">
<h3><span class="header-section-number">14.2.1</span> Overview</h3>
<p>When we have two continuous variables we use simple linear regression. This is based on the Normal (also ‘Gaussian’) distribution. From <span class="citation"><a href="references-1.html#ref-pitman" role="doc-biblioref">Pitman</a> (<a href="references-1.html#ref-pitman" role="doc-biblioref">1993, 94</a>)</span> ‘The normal distribution with mean <span class="math inline">\(\mu\)</span> and standard deviation <span class="math inline">\(\sigma\)</span> is the distribution over the x-axis defined by areas under the normal curve with these parameters. The equation of the normal curve with parameters <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>, can be written as:
<span class="math display">\[y = \frac{1}{\sqrt{2\pi\sigma}}e^{-\frac{1}{2}z^2},\]</span>
where <span class="math inline">\(z = (x - \mu)/\sigma\)</span> measures the number of standard deviations from the mean <span class="math inline">\(\mu\)</span> to the number <span class="math inline">\(x\)</span>.’</p>
<p>In <code>R</code> we can simulate <span class="math inline">\(n\)</span> data points from the Normal distribution with <code>rnorm()</code>.</p>
<div class="sourceCode" id="cb606"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb606-1"><a href="its-just-a-linear-model.html#cb606-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>##  [1] -0.7195816  1.5129669  1.0892396 -0.7643677  1.9500980  2.5212818
##  [7]  1.8184490 -0.6686949  1.7879044  1.4109558  1.4115767 -1.4008841
## [13] -0.3295842 -0.2270651  0.7046669  2.1948797  1.0188842  0.5635043
## [19]  0.4671846 -1.0193147</code></pre>
<p>It will take a few draws before we get the expected shape.</p>
<div class="sourceCode" id="cb608"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb608-1"><a href="its-just-a-linear-model.html#cb608-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb608-2"><a href="its-just-a-linear-model.html#cb608-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">853</span>)</span>
<span id="cb608-3"><a href="its-just-a-linear-model.html#cb608-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb608-4"><a href="its-just-a-linear-model.html#cb608-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">number_of_draws =</span> <span class="fu">c</span>(</span>
<span id="cb608-5"><a href="its-just-a-linear-model.html#cb608-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep.int</span>(<span class="at">x =</span> <span class="st">&quot;2 draws&quot;</span>, <span class="at">times =</span> <span class="dv">2</span>),</span>
<span id="cb608-6"><a href="its-just-a-linear-model.html#cb608-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep.int</span>(<span class="at">x =</span> <span class="st">&quot;5 draws&quot;</span>, <span class="at">times =</span> <span class="dv">5</span>),</span>
<span id="cb608-7"><a href="its-just-a-linear-model.html#cb608-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep.int</span>(<span class="at">x =</span> <span class="st">&quot;10 draws&quot;</span>, <span class="at">times =</span> <span class="dv">10</span>),</span>
<span id="cb608-8"><a href="its-just-a-linear-model.html#cb608-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep.int</span>(<span class="at">x =</span> <span class="st">&quot;50 draws&quot;</span>, <span class="at">times =</span> <span class="dv">50</span>),</span>
<span id="cb608-9"><a href="its-just-a-linear-model.html#cb608-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep.int</span>(<span class="at">x =</span> <span class="st">&quot;100 draws&quot;</span>, <span class="at">times =</span> <span class="dv">100</span>),</span>
<span id="cb608-10"><a href="its-just-a-linear-model.html#cb608-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep.int</span>(<span class="at">x =</span> <span class="st">&quot;500 draws&quot;</span>, <span class="at">times =</span> <span class="dv">500</span>),</span>
<span id="cb608-11"><a href="its-just-a-linear-model.html#cb608-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep.int</span>(<span class="at">x =</span> <span class="st">&quot;1,000 draws&quot;</span>, <span class="at">times =</span> <span class="dv">1000</span>),</span>
<span id="cb608-12"><a href="its-just-a-linear-model.html#cb608-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep.int</span>(<span class="at">x =</span> <span class="st">&quot;10,000 draws&quot;</span>, <span class="at">times =</span> <span class="dv">10000</span>),</span>
<span id="cb608-13"><a href="its-just-a-linear-model.html#cb608-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep.int</span>(<span class="at">x =</span> <span class="st">&quot;100,000 draws&quot;</span>, <span class="at">times =</span> <span class="dv">100000</span>)),</span>
<span id="cb608-14"><a href="its-just-a-linear-model.html#cb608-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">draws =</span> <span class="fu">c</span>(</span>
<span id="cb608-15"><a href="its-just-a-linear-model.html#cb608-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">2</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb608-16"><a href="its-just-a-linear-model.html#cb608-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">5</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb608-17"><a href="its-just-a-linear-model.html#cb608-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">10</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb608-18"><a href="its-just-a-linear-model.html#cb608-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">50</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb608-19"><a href="its-just-a-linear-model.html#cb608-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb608-20"><a href="its-just-a-linear-model.html#cb608-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">500</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb608-21"><a href="its-just-a-linear-model.html#cb608-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb608-22"><a href="its-just-a-linear-model.html#cb608-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">10000</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb608-23"><a href="its-just-a-linear-model.html#cb608-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">100000</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>))</span>
<span id="cb608-24"><a href="its-just-a-linear-model.html#cb608-24" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb608-25"><a href="its-just-a-linear-model.html#cb608-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">number_of_draws =</span> <span class="fu">as_factor</span>(number_of_draws)) <span class="sc">%&gt;%</span> </span>
<span id="cb608-26"><a href="its-just-a-linear-model.html#cb608-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> draws)) <span class="sc">+</span></span>
<span id="cb608-27"><a href="its-just-a-linear-model.html#cb608-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb608-28"><a href="its-just-a-linear-model.html#cb608-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb608-29"><a href="its-just-a-linear-model.html#cb608-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(number_of_draws),</span>
<span id="cb608-30"><a href="its-just-a-linear-model.html#cb608-30" aria-hidden="true" tabindex="-1"></a>             <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb608-31"><a href="its-just-a-linear-model.html#cb608-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Draw&#39;</span>,</span>
<span id="cb608-32"><a href="its-just-a-linear-model.html#cb608-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Density&#39;</span>)</span></code></pre></div>
<p><img src="telling_stories_with_data_files/figure-html/unnamed-chunk-357-1.png" width="672" /></p>
<p>When we use simple linear regression, we assume that our relationship is characterised by the variables and the parameters, with any difference, often denoted by <span class="math inline">\(\epsilon\)</span>, between the expectation and the reality being normally distributed.</p>
<p>If we have two variables, <span class="math inline">\(Y\)</span> and <span class="math inline">\(X\)</span>, then we could characterise the relationship between these as:
<span class="math display">\[Y \sim \beta_0 + \beta_1 X.\]</span></p>
<p>There are two coefficients/parameters: the ‘intercept’ is <span class="math inline">\(\beta_0\)</span>, and the ‘slope’ is <span class="math inline">\(\beta_1\)</span>. We are saying that <span class="math inline">\(Y\)</span> will have some value, <span class="math inline">\(\beta_0\)</span>, even when <span class="math inline">\(X\)</span> is 0, and that <span class="math inline">\(Y\)</span> will change by <span class="math inline">\(\beta_1\)</span> units for every one unit change in <span class="math inline">\(X\)</span>. The language that we use is that ‘X is being regressed on Y.’</p>
<p>We may then take this relationship to the data that we have about the relationship in order to estimate these coefficients for those particular values that we have:
<span class="math display">\[\hat{y} = \hat{\beta}_0 + \hat{\beta}_1 x.\]</span></p>
<p>The hats are used to indicate that these are estimated values. We are saying this is a linear regression because we assume that if <span class="math inline">\(x\)</span> doubles then <span class="math inline">\(y\)</span> would also double. Linear regressions considers how the average of a dependent variable changes based on the independent variables.</p>
<p>I want to focus on data, so we’ll make this example concrete, by generating some data and then discussing everything in the context of that. The example will be looking at someone’s time for running five kilometers, compared with their time for running a marathon.</p>
<div class="sourceCode" id="cb609"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb609-1"><a href="its-just-a-linear-model.html#cb609-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">853</span>)</span>
<span id="cb609-2"><a href="its-just-a-linear-model.html#cb609-2" aria-hidden="true" tabindex="-1"></a>number_of_observations <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb609-3"><a href="its-just-a-linear-model.html#cb609-3" aria-hidden="true" tabindex="-1"></a>running_data <span class="ot">&lt;-</span> </span>
<span id="cb609-4"><a href="its-just-a-linear-model.html#cb609-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">five_km_time =</span> <span class="fu">rnorm</span>(number_of_observations, <span class="dv">20</span>, <span class="dv">3</span>),</span>
<span id="cb609-5"><a href="its-just-a-linear-model.html#cb609-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">noise =</span> <span class="fu">rnorm</span>(number_of_observations, <span class="dv">0</span>, <span class="dv">10</span>),</span>
<span id="cb609-6"><a href="its-just-a-linear-model.html#cb609-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">marathon_time =</span> five_km_time <span class="sc">*</span> <span class="fl">8.4</span> <span class="sc">+</span> noise,</span>
<span id="cb609-7"><a href="its-just-a-linear-model.html#cb609-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">was_raining =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>), </span>
<span id="cb609-8"><a href="its-just-a-linear-model.html#cb609-8" aria-hidden="true" tabindex="-1"></a>                              <span class="at">size =</span> number_of_observations,</span>
<span id="cb609-9"><a href="its-just-a-linear-model.html#cb609-9" aria-hidden="true" tabindex="-1"></a>                              <span class="at">replace =</span> <span class="cn">TRUE</span>, </span>
<span id="cb609-10"><a href="its-just-a-linear-model.html#cb609-10" aria-hidden="true" tabindex="-1"></a>                              <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.8</span>)) </span>
<span id="cb609-11"><a href="its-just-a-linear-model.html#cb609-11" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb609-12"><a href="its-just-a-linear-model.html#cb609-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb609-13"><a href="its-just-a-linear-model.html#cb609-13" aria-hidden="true" tabindex="-1"></a>running_data <span class="sc">%&gt;%</span> </span>
<span id="cb609-14"><a href="its-just-a-linear-model.html#cb609-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> five_km_time, <span class="at">y =</span> marathon_time)) <span class="sc">+</span></span>
<span id="cb609-15"><a href="its-just-a-linear-model.html#cb609-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb609-16"><a href="its-just-a-linear-model.html#cb609-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Five-kilometer time (minutes)&quot;</span>,</span>
<span id="cb609-17"><a href="its-just-a-linear-model.html#cb609-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Marathon time (minutes)&quot;</span>) <span class="sc">+</span></span>
<span id="cb609-18"><a href="its-just-a-linear-model.html#cb609-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="telling_stories_with_data_files/figure-html/unnamed-chunk-358-1.png" width="672" /></p>
<p>In this set-up we may like to use <span class="math inline">\(x\)</span>, which is the five-kilometer time, to produce estimates of <span class="math inline">\(y\)</span>, which is the marathon time. This would involve also estimating values of <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>, which is why they have a hat on them.</p>
<p>But how should we estimate the coefficients? Even if we impose a linear relationship there are a lot of options (how many straight lines can you fit on a piece of paper?). But clearly some of the fits are not all that great.</p>
<p>One way we may define being great would be to impose that they be as close as possible to each of the <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> combinations that we know. There are a lot of candidates for how we define ‘as close as possible,’ but one is to minimise the sum of least squares. To do this we produce our estimates of <span class="math inline">\(\hat{y}\)</span> based on some estimates of <span class="math inline">\(\hat{\beta}_0\)</span> and <span class="math inline">\(\hat{\beta}_1\)</span>, given the <span class="math inline">\(x\)</span>, and then work out how ‘wrong,’ for every point <span class="math inline">\(i\)</span>, we were:
<span class="math display">\[e_i = y_i - \hat{y}_i.\]</span></p>
<p>The residual sum of squares (RSS) then requires summing across all the points:
<span class="math display">\[\mbox{RSS} = e^2_1+ e^2_2 +\dots + e^2_n.\]</span>
This results in one ‘linear best-fit’ line, but it is worth thinking about all of the assumptions and decisions that it took to get us to this point.</p>
<div class="sourceCode" id="cb610"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb610-1"><a href="its-just-a-linear-model.html#cb610-1" aria-hidden="true" tabindex="-1"></a>running_data <span class="sc">%&gt;%</span> </span>
<span id="cb610-2"><a href="its-just-a-linear-model.html#cb610-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> five_km_time, <span class="at">y =</span> marathon_time)) <span class="sc">+</span></span>
<span id="cb610-3"><a href="its-just-a-linear-model.html#cb610-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb610-4"><a href="its-just-a-linear-model.html#cb610-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, </span>
<span id="cb610-5"><a href="its-just-a-linear-model.html#cb610-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">FALSE</span>, </span>
<span id="cb610-6"><a href="its-just-a-linear-model.html#cb610-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, </span>
<span id="cb610-7"><a href="its-just-a-linear-model.html#cb610-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>,</span>
<span id="cb610-8"><a href="its-just-a-linear-model.html#cb610-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">formula =</span> <span class="st">&#39;y ~ x&#39;</span>) <span class="sc">+</span></span>
<span id="cb610-9"><a href="its-just-a-linear-model.html#cb610-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Five-kilometer time (minutes)&quot;</span>,</span>
<span id="cb610-10"><a href="its-just-a-linear-model.html#cb610-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Marathon time (minutes)&quot;</span>) <span class="sc">+</span></span>
<span id="cb610-11"><a href="its-just-a-linear-model.html#cb610-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="telling_stories_with_data_files/figure-html/unnamed-chunk-359-1.png" width="672" /></p>
<p>With the least squares criterion we want the values of <span class="math inline">\(\hat{\beta}_0\)</span> and <span class="math inline">\(\hat{\beta}_1\)</span> that result in the smallest RSS.</p>
</div>
<div id="implementation-in-base-r" class="section level3" number="14.2.2">
<h3><span class="header-section-number">14.2.2</span> Implementation in base R</h3>
<p>Within R, the main function for doing linear regression is <code>lm</code>. This is included in base R, so you don’t need to call any packages, but in a moment, we will call a bunch of packages that will surround <code>lm</code> within an environment that we are more familiar with. You specify the relationship with the dependent variable first, then <code>~</code>, then the independent variables. Finally, you should specify the dataset (or you could pipe to it as usual).</p>
<div class="sourceCode" id="cb611"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb611-1"><a href="its-just-a-linear-model.html#cb611-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> dataset)</span></code></pre></div>
<p>In general, you should assign this to an object:</p>
<div class="sourceCode" id="cb612"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb612-1"><a href="its-just-a-linear-model.html#cb612-1" aria-hidden="true" tabindex="-1"></a>running_data_first_model <span class="ot">&lt;-</span> </span>
<span id="cb612-2"><a href="its-just-a-linear-model.html#cb612-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(marathon_time <span class="sc">~</span> five_km_time, </span>
<span id="cb612-3"><a href="its-just-a-linear-model.html#cb612-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">data =</span> running_data)</span></code></pre></div>
<p>To see the result of your regression you can then call <code>summary()</code>.</p>
<div class="sourceCode" id="cb613"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb613-1"><a href="its-just-a-linear-model.html#cb613-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(running_data_first_model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = marathon_time ~ five_km_time, data = running_data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -24.763  -5.686   0.722   6.650  16.707 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    0.4114     6.0610   0.068    0.946    
## five_km_time   8.3617     0.3058  27.343   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 8.474 on 98 degrees of freedom
## Multiple R-squared:  0.8841, Adjusted R-squared:  0.8829 
## F-statistic: 747.6 on 1 and 98 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>The first part of the result tells us the regression that we called, then information about the residuals, and the estimated coefficients. And then finally some useful diagnostics.</p>
<p>We are considering that there is some relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, that is: <span class="math inline">\(Y = f(X) + \epsilon\)</span>. We are going to say that function, <span class="math inline">\(f()\)</span>, is linear and so our relationship is:
<span class="math display">\[\hat{Y} = \beta_0 + \beta_1 X + \epsilon.\]</span></p>
<p>There is some ‘true’ relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, but we don’t know what it is. All we can do is use our sample of data to try to estimate it. But because our understanding depends on that sample, for every possible sample, we would get a slightly different relationship (as measured by the coefficients).</p>
<p>That <span class="math inline">\(\epsilon\)</span> is a measure of our error - what does the model not know? There’s going to be plenty that the model doesn’t know, but we hope is that the error does not depend on <span class="math inline">\(X\)</span>, and that the error is normally distributed.</p>
<p>The intercept is marathon time that we would expect with a five-kilometer time of 0 minutes. Hopefully this example illustrates the need to carefully interpret the intercept coefficient! The coefficient on five-kilometer run time shows how we expect the marathon time to change if five-kilometer run time changed by one unit. In this case it’s about 8.4, which makes sense seeing as a marathon is roughly that many times longer than a five-kilometer run.</p>
</div>
<div id="tidy-up-with-broom" class="section level3" number="14.2.3">
<h3><span class="header-section-number">14.2.3</span> Tidy up with broom</h3>
<p>While there is nothing wrong with the base approach, I want to introduce the <code>broom</code> package because that will provide us with outputs in a tidy framework <span class="citation">(<a href="references-1.html#ref-citebroom" role="doc-biblioref">D. Robinson, Hayes, and Couch 2020</a>)</span>. There are three key functions:</p>
<ul>
<li><code>broom::tidy()</code>: Gives the coefficient estimates in a tidy output.</li>
<li><code>broom::glance()</code>: Gives the diagnostics.</li>
<li><code>broom::augment()</code>: Adds the forecast values, and hence, residuals, to your dataset.</li>
</ul>
<div class="sourceCode" id="cb615"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb615-1"><a href="its-just-a-linear-model.html#cb615-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb615-2"><a href="its-just-a-linear-model.html#cb615-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(running_data_first_model)</span></code></pre></div>
<pre><code>## # A tibble: 2 x 5
##   term         estimate std.error statistic  p.value
##   &lt;chr&gt;           &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
## 1 (Intercept)     0.411     6.06     0.0679 9.46e- 1
## 2 five_km_time    8.36      0.306   27.3    1.17e-47</code></pre>
<div class="sourceCode" id="cb617"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb617-1"><a href="its-just-a-linear-model.html#cb617-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(running_data_first_model)</span></code></pre></div>
<pre><code>## # A tibble: 1 x 12
##   r.squared adj.r.squared sigma statistic  p.value    df logLik   AIC   BIC
##       &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1     0.884         0.883  8.47      748. 1.17e-47     1  -355.  715.  723.
## # … with 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;</code></pre>
<p>Notice how the results are fairly similar to the base summary function.</p>
<div class="sourceCode" id="cb619"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb619-1"><a href="its-just-a-linear-model.html#cb619-1" aria-hidden="true" tabindex="-1"></a>running_data <span class="ot">&lt;-</span> </span>
<span id="cb619-2"><a href="its-just-a-linear-model.html#cb619-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>(running_data_first_model,</span>
<span id="cb619-3"><a href="its-just-a-linear-model.html#cb619-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> running_data)</span>
<span id="cb619-4"><a href="its-just-a-linear-model.html#cb619-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(running_data)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 10
##   five_km_time  noise marathon_time was_raining .fitted .resid   .hat .sigma
##          &lt;dbl&gt;  &lt;dbl&gt;         &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
## 1         18.9 -3.73           155. No             159.  -3.42 0.0106   8.51
## 2         19.9  8.42           175. No             167.   8.77 0.0101   8.47
## 3         14.7  4.32           127. No             123.   4.47 0.0422   8.50
## 4         16.6 -2.74           137. No             139.  -2.51 0.0217   8.51
## 5         17.0 -4.89           138. No             142.  -4.65 0.0190   8.50
## 6         25.3  0.648          213. No             212.   1.21 0.0524   8.52
## # … with 2 more variables: .cooksd &lt;dbl&gt;, .std.resid &lt;dbl&gt;</code></pre>
<p>We could now make plots of the residuals.</p>
<div class="sourceCode" id="cb621"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb621-1"><a href="its-just-a-linear-model.html#cb621-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(running_data, </span>
<span id="cb621-2"><a href="its-just-a-linear-model.html#cb621-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> .resid)) <span class="sc">+</span> </span>
<span id="cb621-3"><a href="its-just-a-linear-model.html#cb621-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb621-4"><a href="its-just-a-linear-model.html#cb621-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb621-5"><a href="its-just-a-linear-model.html#cb621-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Number of occurrences&quot;</span>,</span>
<span id="cb621-6"><a href="its-just-a-linear-model.html#cb621-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Residuals&quot;</span>)</span></code></pre></div>
<p><img src="telling_stories_with_data_files/figure-html/unnamed-chunk-365-1.png" width="672" /></p>
<div class="sourceCode" id="cb622"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb622-1"><a href="its-just-a-linear-model.html#cb622-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(running_data, <span class="fu">aes</span>(five_km_time, .resid)) <span class="sc">+</span> </span>
<span id="cb622-2"><a href="its-just-a-linear-model.html#cb622-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb622-3"><a href="its-just-a-linear-model.html#cb622-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">&quot;dotted&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey&quot;</span>) <span class="sc">+</span></span>
<span id="cb622-4"><a href="its-just-a-linear-model.html#cb622-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb622-5"><a href="its-just-a-linear-model.html#cb622-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Residuals&quot;</span>,</span>
<span id="cb622-6"><a href="its-just-a-linear-model.html#cb622-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Five-kilometer time (minutes)&quot;</span>)</span></code></pre></div>
<p><img src="telling_stories_with_data_files/figure-html/unnamed-chunk-365-2.png" width="672" /></p>
<p>When we say our estimate is unbiased, we are trying to say that even though with some sample our estimate might be too high, and with another sample our estimate might be too low, eventually if we have a lot of data then our estimate would be the same as the population. (A pro hockey player may sometimes shoot right of the net, and sometimes left of the net, but we’d hope that on average they’d be right in the middle of the net). In the words of <span class="citation"><a href="references-1.html#ref-islr" role="doc-biblioref">James et al.</a> (<a href="references-1.html#ref-islr" role="doc-biblioref">2017</a>)</span>, ‘an unbiased estimator does not systematically over- or under-estimate the true parameter.’</p>
<p>But we want to try to speak to the ‘true’ relationship, so we need to try to capture how much we think our understanding depends on the particular sample that we have to analyse. And this is where standard error comes in. It tells us how off our estimate is compared with the actual.</p>
<p>From standard errors, we can compute a confidence interval. A 95 per cent confidence interval means that there is a 0.95 probability that the interval happens to contain the population parameter (which is typically unknown).</p>
<div class="sourceCode" id="cb623"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb623-1"><a href="its-just-a-linear-model.html#cb623-1" aria-hidden="true" tabindex="-1"></a>running_data <span class="sc">%&gt;%</span> </span>
<span id="cb623-2"><a href="its-just-a-linear-model.html#cb623-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> five_km_time, <span class="at">y =</span> marathon_time)) <span class="sc">+</span></span>
<span id="cb623-3"><a href="its-just-a-linear-model.html#cb623-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb623-4"><a href="its-just-a-linear-model.html#cb623-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, </span>
<span id="cb623-5"><a href="its-just-a-linear-model.html#cb623-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">TRUE</span>, </span>
<span id="cb623-6"><a href="its-just-a-linear-model.html#cb623-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, </span>
<span id="cb623-7"><a href="its-just-a-linear-model.html#cb623-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>,</span>
<span id="cb623-8"><a href="its-just-a-linear-model.html#cb623-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">formula =</span> <span class="st">&#39;y ~ x&#39;</span>) <span class="sc">+</span></span>
<span id="cb623-9"><a href="its-just-a-linear-model.html#cb623-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Five-kilometer time (minutes)&quot;</span>,</span>
<span id="cb623-10"><a href="its-just-a-linear-model.html#cb623-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Marathon time (minutes)&quot;</span>) <span class="sc">+</span></span>
<span id="cb623-11"><a href="its-just-a-linear-model.html#cb623-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="telling_stories_with_data_files/figure-html/unnamed-chunk-366-1.png" width="672" /></p>
<p>There are a bunch of different tests that you can use to understand how your model is performing given this data. One quick way to look at a whole bunch of different aspects is to use the <code>performance</code> package <span class="citation">(<a href="references-1.html#ref-citePerformance" role="doc-biblioref">Lüdecke et al. 2020</a>)</span>.</p>
<div class="sourceCode" id="cb624"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb624-1"><a href="its-just-a-linear-model.html#cb624-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb624-2"><a href="its-just-a-linear-model.html#cb624-2" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">check_model</span>(running_data_first_model)</span></code></pre></div>
<p><img src="telling_stories_with_data_files/figure-html/unnamed-chunk-367-1.png" width="672" /></p>
</div>
<div id="testing-hypothesis" class="section level3" number="14.2.4">
<h3><span class="header-section-number">14.2.4</span> Testing hypothesis</h3>
<p>Now that we have an interval for which we can say there is a 95 per cent probability it contains the true population parameter we can test claims. For instance, a null hypothesis that there is no relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> (i.e. <span class="math inline">\(\beta_1 = 0\)</span>), compared with an alternative hypothesis that there is some relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> (i.e. <span class="math inline">\(\beta_1 \neq 0\)</span>).</p>
<p>We need to know whether our estimate of <span class="math inline">\(\beta_1\)</span>, which is <span class="math inline">\(\hat{\beta}_1\)</span>, is ‘far enough’ away from zero for us to be comfortable claiming that <span class="math inline">\(\beta_1 \neq 0\)</span>. How far is ‘far enough?’ If we were very confident in our estimate of <span class="math inline">\(\beta_1\)</span> then it wouldn’t have to be far, but if we were not then it would have to be substantial. So it depends on a bunch of things, but essentially the standard error of <span class="math inline">\(\hat{\beta}_1\)</span>.</p>
<p>We compare this standard error with <span class="math inline">\(\hat{\beta}_1\)</span> to get the t-statistic:
<span class="math display">\[t = \frac{\hat{\beta}_1 - 0}{\mbox{SE}(\hat{\beta}_1)}.\]</span>
And we then compare our t-statistic to the t-distribution to compute the probability of getting this absolute t-statistic or a larger one, if <span class="math inline">\(\beta_1 = 0\)</span>. This is the p-value. A small p-value means it is unlikely that we would observe our association due to chance if there wasn’t a relationship.</p>
</div>
<div id="on-p-values" class="section level3" number="14.2.5">
<h3><span class="header-section-number">14.2.5</span> On p-values</h3>
<p>The p-value is a specific and subtle concept. It is easy to abuse. The main issue is that it embodies, and assumes correct, every assumption of the model. From <span class="citation"><a href="references-1.html#ref-greenland2016statistical" role="doc-biblioref">Greenland et al.</a> (<a href="references-1.html#ref-greenland2016statistical" role="doc-biblioref">2016, 339</a>)</span>: ‘The p-value is then the probability that the chosen test statistic would have been at least as large as its observed value if every model assumption were correct, including the test hypothesis.’ To provide background on the language used here in case you’re unfamiliar, a test hypothesis is typically a ‘null hypothesis,’ and a ‘test statistic’ is ‘the distance between the data and the model prediction’ <span class="citation">(<a href="references-1.html#ref-greenland2016statistical" role="doc-biblioref">Greenland et al. 2016</a>)</span>.</p>
<p>The following quote (minor edits for consistency with above) summarises the situation:</p>
<blockquote>
<p>It is true that the smaller the p-value, the more unusual the data would be if every single assumption were correct; but a very small p-value does not tell us which assumption is incorrect. For example, the p-value may be very small because the targeted hypothesis is false; but it may instead (or in addition) be very small because the study protocols were violated, or because it was selected for presentation based on its small size. Conversely, a large p-value indicates only that the data are not unusual under the model, but does not imply that the model or any aspect of it (such as the targeted hypothesis) is correct; it may instead (or in addition) be large because (again) the study protocols were violated, or because it was selected for presentation based on its large size.</p>
<p>The general definition of a p-value may help one to understand why statistical tests tell us much less than what many think they do: Not only does a p-value not tell us whether the hypothesis targeted for testing is true or not; it says nothing specifically related to that hypothesis unless we can be completely assured that every other assumption used for its computation is correct—an assurance that is lacking in far too many studies.</p>
<p><span class="citation"><a href="references-1.html#ref-greenland2016statistical" role="doc-biblioref">Greenland et al.</a> (<a href="references-1.html#ref-greenland2016statistical" role="doc-biblioref">2016, 339</a>)</span>.</p>
</blockquote>
<p>There is nothing inherently wrong about using p-values, but it is important to use them in sophisticated and thoughtful ways.</p>
<p>Typically one application where it’s easy to see abuse of p-values is in power analysis. As <span class="citation"><a href="references-1.html#ref-gelmanandhill" role="doc-biblioref">Gelman and Hill</a> (<a href="references-1.html#ref-gelmanandhill" role="doc-biblioref">2007, 438</a>)</span> say, ‘[s]ample size is never large enough…. this is not a problem… [w]e are just emphasizing that, just as you never have enough money, because perceived needs increase with resources, your inferential needs with increase with your sample size.’ Power refers to the probability of incorrectly failing to reject the null hypothesis. As <span class="citation"><a href="references-1.html#ref-Imai2017" role="doc-biblioref">Imai</a> (<a href="references-1.html#ref-Imai2017" role="doc-biblioref">2017, 303</a>)</span> says:</p>
<blockquote>
<p>We use power analysis in order to formalize the degree of informativeness of data in hypothesis tests. The power of a statistical hypothesis test is defined as one minus the probability of type II error:</p>
<p>power = 1-P(type II error)</p>
</blockquote>
<p>In a vacuum, we’d like to have high power and we can achieve that either by having really big effect sizes, or by having a larger number of observations.</p>
</div>
</div>
<div id="multiple-linear-regression" class="section level2" number="14.3">
<h2><span class="header-section-number">14.3</span> Multiple linear regression</h2>
<p>To this point we’ve just considered one explanatory variable. But we’ll usually have more than one. One approach would be to run separate regressions for each explanatory variable. But compared with separate linear regressions for each, adding more explanatory variables allows us to have a better understanding of the intercept and accounts for interaction. Often the results will be quite different.</p>
<blockquote>
<p>This slightly counterintuitive result is very common in many real life situations. Consider an absurd example to illustrate the point. Running a regression of shark attacks versus ice cream sales for data collected at a given beach community over a period of time would show a positive relationship, similar to that seen between sales and newspapers. Of course no one (yet) has suggested that ice creams should be banned at beaches to reduce shark attacks. In reality, higher temperatures cause more people to visit the beach, which in turn results in more ice cream sales and more shark attacks. A multiple regression of attacks versus ice cream sales and temperature reveals that, as intuition implies, the former predictor is no longer significant after adjusting for temperature.</p>
<p><span class="citation">(<a href="references-1.html#ref-islr" role="doc-biblioref">James et al. 2017, 74</a>)</span>.</p>
</blockquote>
<p>We may also like to consider variables that do not have an inherent ordering. For instance, pregnant or not. When there are only two options then we can use a binary variable which is 0 or 1. If there are more than two levels then use a combination of binary variables, where the ‘missing’ outcome (baseline) gets pushed onto the intercept.</p>
<p>In other languages you may need to explicitly construct dummy variables, but as R was designed as a language to do statistical programming, it does a lot of the work here for you and is fairly forgiving. For instance, if you have a column of character values that only had two values: <code>c("Monica", "Rohan", "Rohan", "Monica", "Monica", "Rohan")</code>, and you used this as a independent variable in your usual regression set up then R would treat it as a dummy variable.</p>
<div class="sourceCode" id="cb625"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb625-1"><a href="its-just-a-linear-model.html#cb625-1" aria-hidden="true" tabindex="-1"></a>running_data_rain_model <span class="ot">&lt;-</span> </span>
<span id="cb625-2"><a href="its-just-a-linear-model.html#cb625-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(marathon_time <span class="sc">~</span> five_km_time <span class="sc">+</span> was_raining, </span>
<span id="cb625-3"><a href="its-just-a-linear-model.html#cb625-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">data =</span> running_data)</span>
<span id="cb625-4"><a href="its-just-a-linear-model.html#cb625-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(running_data_rain_model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = marathon_time ~ five_km_time + was_raining, data = running_data)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -24.6239  -5.5806   0.8377   6.7636  16.8671 
## 
## Coefficients:
##                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)      0.1430     6.1476   0.023    0.981    
## five_km_time     8.3689     0.3081  27.166   &lt;2e-16 ***
## was_rainingYes   0.7043     2.2220   0.317    0.752    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 8.513 on 97 degrees of freedom
## Multiple R-squared:  0.8842, Adjusted R-squared:  0.8818 
## F-statistic: 370.4 on 2 and 97 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>The result probably isn’t too surprising if we look at a plot of the data.</p>
<div class="sourceCode" id="cb627"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb627-1"><a href="its-just-a-linear-model.html#cb627-1" aria-hidden="true" tabindex="-1"></a>running_data <span class="sc">%&gt;%</span></span>
<span id="cb627-2"><a href="its-just-a-linear-model.html#cb627-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> five_km_time, <span class="at">y =</span> marathon_time, <span class="at">color =</span> was_raining)) <span class="sc">+</span></span>
<span id="cb627-3"><a href="its-just-a-linear-model.html#cb627-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb627-4"><a href="its-just-a-linear-model.html#cb627-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb627-5"><a href="its-just-a-linear-model.html#cb627-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Five-kilometer time (minutes)&quot;</span>,</span>
<span id="cb627-6"><a href="its-just-a-linear-model.html#cb627-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Marathon time (minutes)&quot;</span>,</span>
<span id="cb627-7"><a href="its-just-a-linear-model.html#cb627-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Was raining&quot;</span>) <span class="sc">+</span></span>
<span id="cb627-8"><a href="its-just-a-linear-model.html#cb627-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb627-9"><a href="its-just-a-linear-model.html#cb627-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set1&quot;</span>)</span></code></pre></div>
<p><img src="telling_stories_with_data_files/figure-html/unnamed-chunk-369-1.png" width="672" /></p>
<p>In addition to wanting to include additional explanatory variables we may think that they are related with one another. For instance, if we were wanting to explain the amount of snowfall in Toronto, then we may be interested in the humidity and the temperature, but those two variables may also interact. We can do this by using <code>*</code> instead of <code>+</code> when we specify the model in R. If you do interact variables, then you should almost always also include the individual variables as well (Figure <a href="its-just-a-linear-model.html#fig:trump">14.2</a>).</p>
<div class="figure"><span id="fig:trump"></span>
<img src="figures/trump.jpg" alt="Don't leave out the main effects in an interactive model" width="90%" />
<p class="caption">
Figure 14.2: Don’t leave out the main effects in an interactive model
</p>
</div>
<p>Source: By <a href="https://twitter.com/kai_arzheimer/status/1228998718646607876">Kai Arzheimer</a>, 16 February 2020.</p>
<div id="threats-to-validity-and-aspects-to-think-about" class="section level3" number="14.3.1">
<h3><span class="header-section-number">14.3.1</span> Threats to validity and aspects to think about</h3>
<p>There are a variety of weaknesses and aspects that you should discuss when you use linear regression. A quick list includes <span class="citation">(<a href="references-1.html#ref-islr" role="doc-biblioref">James et al. 2017, 92</a>)</span>:</p>
<ol style="list-style-type: decimal">
<li>Non-linearity of the response-predictor relationships.</li>
<li>Correlation of error terms.</li>
<li>Non-constant variance of error terms.</li>
<li>Outliers.</li>
<li>High-leverage points.</li>
<li>Collinearity</li>
</ol>
<p>These are also aspects that you should discuss if you use linear regression. Including plots tends to be handy here to illustrate your points. Other aspects that you may consider discussing include <span class="citation">(<a href="references-1.html#ref-islr" role="doc-biblioref">James et al. 2017, 75</a>)</span>:</p>
<ol style="list-style-type: decimal">
<li>Is at least one of the predictors <span class="math inline">\(X_1, X_2, \dots, X_p\)</span> useful in predicting the response?</li>
<li>Do all the predictors help to explain <span class="math inline">\(Y\)</span>, or is only a subset of the predictors useful?</li>
<li>How well does the model fit the data?</li>
<li>Given a set of predictor values, what response value should we predict, and how accurate is our prediction?</li>
</ol>
</div>
<div id="more-credible-outputs" class="section level3" number="14.3.2">
<h3><span class="header-section-number">14.3.2</span> More credible outputs</h3>
<p>Finally, after creating beautiful graphs and tables you may want your regression output to look just as nice. There are a variety of packages in R that will automatically format your regression outputs. One that is particularly nice is <code>huxtable</code> <span class="citation">(<a href="references-1.html#ref-citehuxtable" role="doc-biblioref">Hugh-Jones 2020</a>)</span>.</p>
<div class="sourceCode" id="cb628"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb628-1"><a href="its-just-a-linear-model.html#cb628-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(huxtable)</span>
<span id="cb628-2"><a href="its-just-a-linear-model.html#cb628-2" aria-hidden="true" tabindex="-1"></a><span class="fu">huxreg</span>(running_data_first_model, running_data_rain_model)</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-370">
<caption style="caption-side: top; text-align: center;"><span id="tab:unnamed-chunk-370">Table 14.1: </span> </caption><col><col><col><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(1)</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(2)</th></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(Intercept)</th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.411&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.143&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></th><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(6.061)&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(6.148)&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">five_km_time</th><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">8.362 ***</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">8.369 ***</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></th><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.306)&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.308)&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">was_rainingYes</th><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.704&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(2.222)&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">N</th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">R2</th><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.884&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.884&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">logLik</th><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-354.584&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-354.532&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">AIC</th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">715.168&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">717.064&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th colspan="3" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"> *** p &lt; 0.001;  ** p &lt; 0.01;  * p &lt; 0.05.</th></tr>
</table>

</div>
<div id="implementation-in-tidymodels" class="section level3" number="14.3.3">
<h3><span class="header-section-number">14.3.3</span> Implementation in <code>tidymodels</code></h3>
<p>The reason that we went to all that trouble to do simple regression is that we often want to fit a bunch of models. One way is to copy/paste code a bunch of times. There’s nothing wrong with that. And that’s the way that most people get started, but you may want to take an approach that scales more easily. We also need to think more carefully about over-fitting, and being able to evaluate our models.</p>
<p>The <code>tidymodels</code> package <span class="citation">(<a href="references-1.html#ref-citeTidymodels" role="doc-biblioref">Kuhn and Wickham 2020</a>)</span> is what all the cool kids are using these days. It’s an attempt to bring some order to the chaos that has been different modelling packages in R. (There have been other attempts in the past and they’ve crashed and burned, but hopefully this time is different.) The issue is that let’s say you want to run a simple linear regression and then run a random forest. The language that you’d use to code these models is fairly different. The <code>tidymodels</code> package is the latest attempt to bring a coherent grammar to this. It’s also a package of packages.</p>
<p>We’ll create test and training datasets.</p>
<div class="sourceCode" id="cb629"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb629-1"><a href="its-just-a-linear-model.html#cb629-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">853</span>)</span>
<span id="cb629-2"><a href="its-just-a-linear-model.html#cb629-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb629-3"><a href="its-just-a-linear-model.html#cb629-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb629-4"><a href="its-just-a-linear-model.html#cb629-4" aria-hidden="true" tabindex="-1"></a>running_data_split <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">initial_split</span>(running_data, <span class="at">prop =</span> <span class="fl">0.80</span>)</span>
<span id="cb629-5"><a href="its-just-a-linear-model.html#cb629-5" aria-hidden="true" tabindex="-1"></a>running_data_split</span></code></pre></div>
<pre><code>## &lt;Analysis/Assess/Total&gt;
## &lt;81/19/100&gt;</code></pre>
<p>So we have 81 points in our training set, 19 in our test set and 100 in total.</p>
<p>We can then make datasets for the test and training samples.</p>
<div class="sourceCode" id="cb631"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb631-1"><a href="its-just-a-linear-model.html#cb631-1" aria-hidden="true" tabindex="-1"></a>running_data_train <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">training</span>(running_data_split)</span>
<span id="cb631-2"><a href="its-just-a-linear-model.html#cb631-2" aria-hidden="true" tabindex="-1"></a>running_data_test  <span class="ot">&lt;-</span>  rsample<span class="sc">::</span><span class="fu">testing</span>(running_data_split)</span></code></pre></div>
<p>If we have a look at the dataset that we made we can see that it’s got fewer rows. We could have reached the same outcome with something like:</p>
<div class="sourceCode" id="cb632"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb632-1"><a href="its-just-a-linear-model.html#cb632-1" aria-hidden="true" tabindex="-1"></a>running_data <span class="ot">&lt;-</span> </span>
<span id="cb632-2"><a href="its-just-a-linear-model.html#cb632-2" aria-hidden="true" tabindex="-1"></a>  running_data <span class="sc">%&gt;%</span> </span>
<span id="cb632-3"><a href="its-just-a-linear-model.html#cb632-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">magic_number =</span> <span class="fu">sample</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(running_data)), <span class="at">size =</span> <span class="fu">nrow</span>(running_data), <span class="at">replace =</span> <span class="cn">FALSE</span>))</span>
<span id="cb632-4"><a href="its-just-a-linear-model.html#cb632-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb632-5"><a href="its-just-a-linear-model.html#cb632-5" aria-hidden="true" tabindex="-1"></a>running_data_test <span class="ot">&lt;-</span> </span>
<span id="cb632-6"><a href="its-just-a-linear-model.html#cb632-6" aria-hidden="true" tabindex="-1"></a>  running_data <span class="sc">%&gt;%</span> </span>
<span id="cb632-7"><a href="its-just-a-linear-model.html#cb632-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(magic_number <span class="sc">&lt;=</span> <span class="dv">20</span>)</span>
<span id="cb632-8"><a href="its-just-a-linear-model.html#cb632-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb632-9"><a href="its-just-a-linear-model.html#cb632-9" aria-hidden="true" tabindex="-1"></a>running_data_train <span class="ot">&lt;-</span> </span>
<span id="cb632-10"><a href="its-just-a-linear-model.html#cb632-10" aria-hidden="true" tabindex="-1"></a>  running_data <span class="sc">%&gt;%</span> </span>
<span id="cb632-11"><a href="its-just-a-linear-model.html#cb632-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(magic_number <span class="sc">&gt;</span> <span class="dv">20</span>)</span></code></pre></div>
<div class="sourceCode" id="cb633"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb633-1"><a href="its-just-a-linear-model.html#cb633-1" aria-hidden="true" tabindex="-1"></a>first_go <span class="ot">&lt;-</span> </span>
<span id="cb633-2"><a href="its-just-a-linear-model.html#cb633-2" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">linear_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb633-3"><a href="its-just-a-linear-model.html#cb633-3" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">set_engine</span>(<span class="at">engine =</span> <span class="st">&quot;lm&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb633-4"><a href="its-just-a-linear-model.html#cb633-4" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">fit</span>(marathon_time <span class="sc">~</span> five_km_time <span class="sc">+</span> was_raining, </span>
<span id="cb633-5"><a href="its-just-a-linear-model.html#cb633-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> running_data_train</span>
<span id="cb633-6"><a href="its-just-a-linear-model.html#cb633-6" aria-hidden="true" tabindex="-1"></a>               )</span></code></pre></div>
</div>
<div id="implementation-in-rstanarm" class="section level3" number="14.3.4">
<h3><span class="header-section-number">14.3.4</span> Implementation in <code>rstanarm</code></h3>
<p>The <code>tidymodels</code> package will be fine for specific types of tasks. For instance if you are doing machine learning then chances are you are interested in forecasting. That’s the kind of thing that <code>tidymodels</code> is really built for. If you want equivalent firepower for explanatory modelling then one option is to use Bayesian approaches more directly. Yes, you can use Bayesian models within the <code>tidymodels</code> ecosystem, but as you start to move away from out-of-the-box solutions, it becomes important to start to understand what is going on under the hood.</p>
<p>There are a variety of ways of getting started, but essentially what you need is a probabilistic programming language. That is one that is specifically designed for this sort of thing, in comparison to <code>R</code>, which is designed for more general statistical computing. We will use <code>Stan</code> in these notes within the context of our familiar R environment. We will interface with <code>Stan</code> using the <code>rstanarm</code> package <span class="citation">(<a href="references-1.html#ref-citerstanarm" role="doc-biblioref">Goodrich et al. 2020</a>)</span>.</p>
<div class="sourceCode" id="cb634"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb634-1"><a href="its-just-a-linear-model.html#cb634-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstanarm)</span>
<span id="cb634-2"><a href="its-just-a-linear-model.html#cb634-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb634-3"><a href="its-just-a-linear-model.html#cb634-3" aria-hidden="true" tabindex="-1"></a>first_go_in_rstanarm <span class="ot">&lt;-</span></span>
<span id="cb634-4"><a href="its-just-a-linear-model.html#cb634-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stan_lm</span>(</span>
<span id="cb634-5"><a href="its-just-a-linear-model.html#cb634-5" aria-hidden="true" tabindex="-1"></a>    marathon_time <span class="sc">~</span> five_km_time <span class="sc">+</span> was_raining, </span>
<span id="cb634-6"><a href="its-just-a-linear-model.html#cb634-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> running_data,</span>
<span id="cb634-7"><a href="its-just-a-linear-model.html#cb634-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior =</span> <span class="cn">NULL</span>,</span>
<span id="cb634-8"><a href="its-just-a-linear-model.html#cb634-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">seed =</span> <span class="dv">853</span></span>
<span id="cb634-9"><a href="its-just-a-linear-model.html#cb634-9" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<div class="sourceCode" id="cb635"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb635-1"><a href="its-just-a-linear-model.html#cb635-1" aria-hidden="true" tabindex="-1"></a>first_go_in_rstanarm</span></code></pre></div>
<pre><code>## stan_lm
##  family:       gaussian [identity]
##  formula:      marathon_time ~ five_km_time + was_raining
##  observations: 100
##  predictors:   3
## ------
##                Median MAD_SD
## (Intercept)    0.4    6.0   
## five_km_time   8.4    0.3   
## was_rainingYes 0.7    2.2   
## 
## Auxiliary parameter(s):
##               Median MAD_SD
## R2            0.9    0.0   
## log-fit_ratio 0.0    0.0   
## sigma         8.6    0.6   
## 
## ------
## * For help interpreting the printed output see ?print.stanreg
## * For info on the priors used see ?prior_summary.stanreg</code></pre>
<!-- ## Tutorial -->
<!-- Let's do this in the context of the Paspaley dataset that we were introduced to in an earlier lecture. -->
<!-- Read in the data. -->
<!-- ```{r} -->
<!-- paspaley_data <- read_csv(here::here("notes/inputs/data/paspaley_cleaned_dataset.csv")) -->
<!-- head(paspaley_data) -->
<!-- ``` -->
<!-- Take a brief look: -->
<!-- ```{r} -->
<!-- skimr::skim(paspaley_data) -->
<!-- paspaley_data$keshi %>% table() -->
<!-- paspaley_data$metal %>% table() -->
<!-- paspaley_data$category %>% table() -->
<!-- ``` -->
<!-- Clean up and remove some anonying other variables. -->
<!-- ```{r} -->
<!-- paspaley_data <-  -->
<!--   paspaley_data %>%  -->
<!--   filter(metal != "Other") %>%  -->
<!--   filter(category != "Other") -->
<!-- ``` -->
<!-- Run a ordinary linear regression. -->
<!-- ```{r} -->
<!-- model_1 <- lm(price ~ keshi, data = paspaley_data) -->
<!-- model_2 <- lm(price ~ metal, data = paspaley_data) -->
<!-- model_3 <- lm(price ~ category, data = paspaley_data) -->
<!-- model_4 <- lm(price ~ keshi + metal + category, data = paspaley_data) -->
<!-- ``` -->
<!-- `broom` is great to look at the models, in particular `glance` and `tidy`.  -->
<!-- ```{r} -->
<!-- summary(model_1) -->
<!-- broom::glance(model_1) -->
<!-- broom::tidy(model_1) -->
<!-- ``` -->
<!-- ```{r} -->
<!-- broom::glance(model_4) -->
<!-- broom::tidy(model_4) -->
<!-- paspaley_data %>%  -->
<!--   ggplot(aes(x = price)) + -->
<!--   geom_histogram() + -->
<!--   facet_wrap(vars(metal), scales = "free_y") -->
<!-- ``` -->
<!-- You can add the fitted variables easily too. -->
<!-- ```{r} -->
<!-- paspaley_data_with_model_4 <- broom::augment(model_4) -->
<!-- head(model_4) -->
<!-- ``` -->
</div>
</div>
<div id="logistic-regression-2" class="section level2" number="14.4">
<h2><span class="header-section-number">14.4</span> Logistic regression</h2>
<div id="overview-2" class="section level3" number="14.4.1">
<h3><span class="header-section-number">14.4.1</span> Overview</h3>
<p>To steal a joke from someone, ‘it’s AI when you’re fundraising, machine learning when you’re hiring, and logistic regression when you’re implementing.’</p>
<p>When the dependent variable is a binary outcome, that is 0 or 1, then instead of linear regression we may like to use logistic regression. Although a binary outcome may sound limiting, there are a lot of circumstances in which your outcome either naturally falls into this situation, or can be adjusted into it (e.g. a voter supports the liberals or not the liberals).</p>
<p>The reason that we use logistic regression is that we’ll be modelling a probability and so it will be bounded between 0 and 1. Whereas with linear regression we may end up with values outside this. In practice it is usually fine to start with linear regression and then move to logistic regression as you build confidence.</p>
<p>This all said, logistic regression, as Daniella Witten teaches us, is just a linear model!</p>
</div>
<div id="implementation-in-base" class="section level3" number="14.4.2">
<h3><span class="header-section-number">14.4.2</span> Implementation in base</h3>
<p>I’d like to consider a slightly more interesting example, which is a dataset of pearl jewellery, from the Australian retailer Paspaley.</p>
<div class="sourceCode" id="cb637"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb637-1"><a href="its-just-a-linear-model.html#cb637-1" aria-hidden="true" tabindex="-1"></a>paspaley_dataset <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/RohanAlexander/paspaley/master/outputs/data/cleaned_dataset.csv&quot;</span>)</span>
<span id="cb637-2"><a href="its-just-a-linear-model.html#cb637-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb637-3"><a href="its-just-a-linear-model.html#cb637-3" aria-hidden="true" tabindex="-1"></a>paspaley_dataset<span class="sc">$</span>metal <span class="sc">%&gt;%</span> <span class="fu">table</span>()</span></code></pre></div>
<pre><code>## .
##       Other    Platinum   Rose gold  White gold Yellow gold 
##          98          20          63         366         411</code></pre>
<p>In this case we’ll model whether some jewellery is made of white or yellow gold, based on their price and the year (Figure <a href="its-just-a-linear-model.html#fig:logisticgraph">14.3</a>).</p>
<div class="sourceCode" id="cb639"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb639-1"><a href="its-just-a-linear-model.html#cb639-1" aria-hidden="true" tabindex="-1"></a>paspaley_logistic_dataset <span class="ot">&lt;-</span> </span>
<span id="cb639-2"><a href="its-just-a-linear-model.html#cb639-2" aria-hidden="true" tabindex="-1"></a>  paspaley_dataset <span class="sc">%&gt;%</span> </span>
<span id="cb639-3"><a href="its-just-a-linear-model.html#cb639-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(metal <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;White gold&#39;</span>, <span class="st">&#39;Yellow gold&#39;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb639-4"><a href="its-just-a-linear-model.html#cb639-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(metal, price, year)</span></code></pre></div>
<div class="figure"><span id="fig:logisticgraph"></span>
<img src="telling_stories_with_data_files/figure-html/logisticgraph-1.png" alt="Examining the type of gold some jewellery is made from." width="672" />
<p class="caption">
Figure 14.3: Examining the type of gold some jewellery is made from.
</p>
</div>
<p>The graph suggests that we should filter any price higher than $100,000.</p>
<div class="sourceCode" id="cb640"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb640-1"><a href="its-just-a-linear-model.html#cb640-1" aria-hidden="true" tabindex="-1"></a>paspaley_logistic_dataset <span class="ot">&lt;-</span> </span>
<span id="cb640-2"><a href="its-just-a-linear-model.html#cb640-2" aria-hidden="true" tabindex="-1"></a>  paspaley_logistic_dataset <span class="sc">%&gt;%</span> </span>
<span id="cb640-3"><a href="its-just-a-linear-model.html#cb640-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(price <span class="sc">&lt;</span> <span class="dv">100000</span>)</span></code></pre></div>
<p>As with linear regression, logistic regression is built into R, with the <code>glm</code> function. In this case, we’ll try to work out if the jewellery was white gold. Although not strictly necessary for this particular function, we’ll change it to a binary, that will be 1 if white gold and 0 if not.</p>
<div class="sourceCode" id="cb641"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb641-1"><a href="its-just-a-linear-model.html#cb641-1" aria-hidden="true" tabindex="-1"></a>paspaley_logistic_dataset <span class="ot">&lt;-</span> </span>
<span id="cb641-2"><a href="its-just-a-linear-model.html#cb641-2" aria-hidden="true" tabindex="-1"></a>  paspaley_logistic_dataset <span class="sc">%&gt;%</span> </span>
<span id="cb641-3"><a href="its-just-a-linear-model.html#cb641-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">is_white_gold =</span> <span class="fu">if_else</span>(metal <span class="sc">==</span> <span class="st">&quot;White gold&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb641-4"><a href="its-just-a-linear-model.html#cb641-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-5"><a href="its-just-a-linear-model.html#cb641-5" aria-hidden="true" tabindex="-1"></a>white_gold_model <span class="ot">&lt;-</span> </span>
<span id="cb641-6"><a href="its-just-a-linear-model.html#cb641-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(is_white_gold <span class="sc">~</span> price <span class="sc">+</span> year, </span>
<span id="cb641-7"><a href="its-just-a-linear-model.html#cb641-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> paspaley_logistic_dataset, </span>
<span id="cb641-8"><a href="its-just-a-linear-model.html#cb641-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="st">&#39;binomial&#39;</span>)</span>
<span id="cb641-9"><a href="its-just-a-linear-model.html#cb641-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-10"><a href="its-just-a-linear-model.html#cb641-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(white_gold_model)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = is_white_gold ~ price + year, family = &quot;binomial&quot;, 
##     data = paspaley_logistic_dataset)
## 
## Deviance Residuals: 
##    Min      1Q  Median      3Q     Max  
## -1.243  -1.140  -1.060   1.212   1.302  
## 
## Coefficients:
##               Estimate Std. Error z value Pr(&gt;|z|)
## (Intercept)  1.992e+02  1.264e+02   1.577    0.115
## price        3.503e-06  6.248e-06   0.561    0.575
## year        -9.877e-02  6.261e-02  -1.578    0.115
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1056.8  on 763  degrees of freedom
## Residual deviance: 1054.2  on 761  degrees of freedom
## AIC: 1060.2
## 
## Number of Fisher Scoring iterations: 3</code></pre>
<p>One reason that logistic regression can be a bit of a pain initially is because the coefficients take a bit of work to interpret. In particular, our estimate on price is -3.170e-06. This is the odds. So the odds that it was white gold decrease by -3.170e-06 as the price increases. We can have our model make forecasts in terms of a probability, by asking for that.</p>
<div class="sourceCode" id="cb643"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb643-1"><a href="its-just-a-linear-model.html#cb643-1" aria-hidden="true" tabindex="-1"></a>paspaley_logistic_dataset <span class="ot">&lt;-</span> </span>
<span id="cb643-2"><a href="its-just-a-linear-model.html#cb643-2" aria-hidden="true" tabindex="-1"></a>  broom<span class="sc">::</span><span class="fu">augment</span>(white_gold_model,</span>
<span id="cb643-3"><a href="its-just-a-linear-model.html#cb643-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> paspaley_logistic_dataset,</span>
<span id="cb643-4"><a href="its-just-a-linear-model.html#cb643-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">type.predict =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb643-5"><a href="its-just-a-linear-model.html#cb643-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(paspaley_logistic_dataset)</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-381">
<caption style="caption-side: top; text-align: center;"><span id="tab:unnamed-chunk-381">Table 14.2: </span> </caption><col><col><col><col><col><col><col><col><col><col><tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">metal</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">price</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">year</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">is_white_gold</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">.fitted</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">.resid</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">.std.resid</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">.hat</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">.sigma</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">.cooksd</th></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">Yellow gold</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">2.58e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">2.02e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">0</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">0.504</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">-1.18</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">-1.19</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">0.00392</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1.18</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">0.00134</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Yellow gold</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">2.08e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">2.02e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.503</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-1.18</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-1.19</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.00397</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.18</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.00135</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">Yellow gold</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">3.08e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">2.02e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">0</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">0.504</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">-1.18</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">-1.19</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">0.00386</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1.18</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">0.00132</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">White gold</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">7.38e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">2.02e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.508</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.16</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.17</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.00361</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.18</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.00117</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">White gold</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">3.08e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">2.02e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">0.504</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1.17</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1.17</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">0.00386</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1.18</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">0.00127</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">White gold</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">3.95e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">2.02e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.505</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.17</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.17</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.00378</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.18</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.00124</td></tr>
</table>

</div>
<div id="implementation-in-tidymodels-1" class="section level3" number="14.4.3">
<h3><span class="header-section-number">14.4.3</span> Implementation in <code>tidymodels</code></h3>
<!-- https://jtcies.com/2020/03/when-does-garbage-time-start/ -->
<!-- https://meghan.rbind.io/post/tidymodels-intro/ -->
<!-- https://alison.rbind.io/post/2020-02-27-better-tidymodels/#tidymodels-101 -->
<p>We can use <code>tidymodels</code> to run this if we wanted. In this case, we need it as a factor.</p>
<div class="sourceCode" id="cb644"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb644-1"><a href="its-just-a-linear-model.html#cb644-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">853</span>)</span>
<span id="cb644-2"><a href="its-just-a-linear-model.html#cb644-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb644-3"><a href="its-just-a-linear-model.html#cb644-3" aria-hidden="true" tabindex="-1"></a>paspaley_logistic_dataset <span class="ot">&lt;-</span> </span>
<span id="cb644-4"><a href="its-just-a-linear-model.html#cb644-4" aria-hidden="true" tabindex="-1"></a>  paspaley_logistic_dataset <span class="sc">%&gt;%</span> </span>
<span id="cb644-5"><a href="its-just-a-linear-model.html#cb644-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">is_white_gold =</span> <span class="fu">as_factor</span>(is_white_gold))</span>
<span id="cb644-6"><a href="its-just-a-linear-model.html#cb644-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb644-7"><a href="its-just-a-linear-model.html#cb644-7" aria-hidden="true" tabindex="-1"></a>paspaley_logistic_dataset_split <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">initial_split</span>(paspaley_logistic_dataset, <span class="at">prop =</span> <span class="fl">0.80</span>)</span>
<span id="cb644-8"><a href="its-just-a-linear-model.html#cb644-8" aria-hidden="true" tabindex="-1"></a>paspaley_logistic_dataset_train <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">training</span>(paspaley_logistic_dataset_split)</span>
<span id="cb644-9"><a href="its-just-a-linear-model.html#cb644-9" aria-hidden="true" tabindex="-1"></a>paspaley_logistic_dataset_test  <span class="ot">&lt;-</span>  rsample<span class="sc">::</span><span class="fu">testing</span>(paspaley_logistic_dataset_split)</span>
<span id="cb644-10"><a href="its-just-a-linear-model.html#cb644-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb644-11"><a href="its-just-a-linear-model.html#cb644-11" aria-hidden="true" tabindex="-1"></a>white_gold_model_tidymodels <span class="ot">&lt;-</span></span>
<span id="cb644-12"><a href="its-just-a-linear-model.html#cb644-12" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">logistic_reg</span>(<span class="at">mode =</span> <span class="st">&quot;classification&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb644-13"><a href="its-just-a-linear-model.html#cb644-13" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">set_engine</span>(<span class="st">&quot;glm&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb644-14"><a href="its-just-a-linear-model.html#cb644-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(is_white_gold <span class="sc">~</span> price <span class="sc">+</span> year, </span>
<span id="cb644-15"><a href="its-just-a-linear-model.html#cb644-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> paspaley_logistic_dataset_train)</span>
<span id="cb644-16"><a href="its-just-a-linear-model.html#cb644-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb644-17"><a href="its-just-a-linear-model.html#cb644-17" aria-hidden="true" tabindex="-1"></a>white_gold_model_tidymodels</span></code></pre></div>
<pre><code>## parsnip model object
## 
## Fit time:  2ms 
## 
## Call:  stats::glm(formula = is_white_gold ~ price + year, family = stats::binomial, 
##     data = data)
## 
## Coefficients:
## (Intercept)        price         year  
##   1.990e+02    6.188e-06   -9.864e-02  
## 
## Degrees of Freedom: 611 Total (i.e. Null);  609 Residual
## Null Deviance:       846.9 
## Residual Deviance: 844.3     AIC: 850.3</code></pre>
</div>
<div id="implementation-in-rstanarm-1" class="section level3" number="14.4.4">
<h3><span class="header-section-number">14.4.4</span> Implementation in <code>rstanarm</code></h3>
<div class="sourceCode" id="cb646"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb646-1"><a href="its-just-a-linear-model.html#cb646-1" aria-hidden="true" tabindex="-1"></a>paspaley_in_rstanarm <span class="ot">&lt;-</span></span>
<span id="cb646-2"><a href="its-just-a-linear-model.html#cb646-2" aria-hidden="true" tabindex="-1"></a>  rstanarm<span class="sc">::</span><span class="fu">stan_glm</span>(</span>
<span id="cb646-3"><a href="its-just-a-linear-model.html#cb646-3" aria-hidden="true" tabindex="-1"></a>    is_white_gold <span class="sc">~</span> price <span class="sc">+</span> year,</span>
<span id="cb646-4"><a href="its-just-a-linear-model.html#cb646-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> paspaley_logistic_dataset,</span>
<span id="cb646-5"><a href="its-just-a-linear-model.html#cb646-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>),</span>
<span id="cb646-6"><a href="its-just-a-linear-model.html#cb646-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior =</span> <span class="cn">NULL</span>,</span>
<span id="cb646-7"><a href="its-just-a-linear-model.html#cb646-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">seed =</span> <span class="dv">853</span></span>
<span id="cb646-8"><a href="its-just-a-linear-model.html#cb646-8" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
</div>
</div>
<div id="poisson-regression" class="section level2" number="14.5">
<h2><span class="header-section-number">14.5</span> Poisson regression</h2>
<div id="overview-3" class="section level3" number="14.5.1">
<h3><span class="header-section-number">14.5.1</span> Overview</h3>
<p>When we have count data, we use Poisson distribution. From <span class="citation"><a href="references-1.html#ref-pitman" role="doc-biblioref">Pitman</a> (<a href="references-1.html#ref-pitman" role="doc-biblioref">1993, 121</a>)</span> ’The Poisson distribution with parameter <span class="math inline">\(\mu\)</span> or Poisson (<span class="math inline">\(\mu\)</span>) distribution is the distribution of probabilities <span class="math inline">\(P_{\mu}(k)\)</span> over <span class="math inline">\({0, 1, 2, ...}\)</span> defined by:
<span class="math display">\[P_{\mu}(k) = e^{-\mu}\mu^k/k!\mbox{, for }k=0,1,2,...\]</span>
We can simulate <span class="math inline">\(n\)</span> data points from the Poisson distribution with <code>rpois()</code> where <span class="math inline">\(\lambda\)</span> is the mean and the variance.</p>
<div class="sourceCode" id="cb647"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb647-1"><a href="its-just-a-linear-model.html#cb647-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rpois</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">lambda =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>##  [1] 2 1 3 2 3 1 1 0 2 4 6 1 1 4 4 2 4 4 4 6</code></pre>
<p>That <span class="math inline">\(\lambda\)</span> parameter governs the shape of the distribution.</p>
<div class="sourceCode" id="cb649"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb649-1"><a href="its-just-a-linear-model.html#cb649-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">853</span>)</span>
<span id="cb649-2"><a href="its-just-a-linear-model.html#cb649-2" aria-hidden="true" tabindex="-1"></a>number_of_each <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb649-3"><a href="its-just-a-linear-model.html#cb649-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">lambda =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, number_of_each), <span class="fu">rep</span>(<span class="dv">1</span>, number_of_each), <span class="fu">rep</span>(<span class="dv">2</span>, number_of_each), <span class="fu">rep</span>(<span class="dv">5</span>, number_of_each), <span class="fu">rep</span>(<span class="dv">10</span>, number_of_each)),</span>
<span id="cb649-4"><a href="its-just-a-linear-model.html#cb649-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">draw =</span> <span class="fu">c</span>(<span class="fu">rpois</span>(<span class="at">n =</span> number_of_each, <span class="at">lambda =</span> <span class="dv">0</span>), <span class="fu">rpois</span>(<span class="at">n =</span> number_of_each, <span class="at">lambda =</span> <span class="dv">1</span>), <span class="fu">rpois</span>(<span class="at">n =</span> number_of_each, <span class="at">lambda =</span> <span class="dv">2</span>), <span class="fu">rpois</span>(<span class="at">n =</span> number_of_each, <span class="at">lambda =</span> <span class="dv">5</span>), <span class="fu">rpois</span>(<span class="at">n =</span> number_of_each, <span class="at">lambda =</span> <span class="dv">10</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb649-5"><a href="its-just-a-linear-model.html#cb649-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> draw)) <span class="sc">+</span></span>
<span id="cb649-6"><a href="its-just-a-linear-model.html#cb649-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb649-7"><a href="its-just-a-linear-model.html#cb649-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(lambda)) <span class="sc">+</span></span>
<span id="cb649-8"><a href="its-just-a-linear-model.html#cb649-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="telling_stories_with_data_files/figure-html/unnamed-chunk-384-1.png" width="672" /></p>
<p>For instance, if we look at the number of A+ grades that are awarded in each university course in a given term then for each course we would have a count.</p>
<div class="sourceCode" id="cb650"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb650-1"><a href="its-just-a-linear-model.html#cb650-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">853</span>)</span>
<span id="cb650-2"><a href="its-just-a-linear-model.html#cb650-2" aria-hidden="true" tabindex="-1"></a>count_of_A_plus <span class="ot">&lt;-</span> </span>
<span id="cb650-3"><a href="its-just-a-linear-model.html#cb650-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>( </span>
<span id="cb650-4"><a href="its-just-a-linear-model.html#cb650-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># https://stackoverflow.com/questions/1439513/creating-a-sequential-list-of-letters-with-r</span></span>
<span id="cb650-5"><a href="its-just-a-linear-model.html#cb650-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">department =</span> <span class="fu">c</span>(<span class="fu">rep.int</span>(<span class="st">&quot;1&quot;</span>, <span class="dv">26</span>), <span class="fu">rep.int</span>(<span class="st">&quot;2&quot;</span>, <span class="dv">26</span>)),</span>
<span id="cb650-6"><a href="its-just-a-linear-model.html#cb650-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">course =</span> <span class="fu">c</span>(<span class="fu">paste0</span>(<span class="st">&quot;DEP_1_&quot;</span>, letters), <span class="fu">paste0</span>(<span class="st">&quot;DEP_2_&quot;</span>, letters)),</span>
<span id="cb650-7"><a href="its-just-a-linear-model.html#cb650-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">number_of_A_plus =</span> <span class="fu">c</span>(<span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>), </span>
<span id="cb650-8"><a href="its-just-a-linear-model.html#cb650-8" aria-hidden="true" tabindex="-1"></a>                              <span class="at">size =</span> <span class="dv">26</span>,</span>
<span id="cb650-9"><a href="its-just-a-linear-model.html#cb650-9" aria-hidden="true" tabindex="-1"></a>                              <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb650-10"><a href="its-just-a-linear-model.html#cb650-10" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>), </span>
<span id="cb650-11"><a href="its-just-a-linear-model.html#cb650-11" aria-hidden="true" tabindex="-1"></a>                              <span class="at">size =</span> <span class="dv">26</span>,</span>
<span id="cb650-12"><a href="its-just-a-linear-model.html#cb650-12" aria-hidden="true" tabindex="-1"></a>                              <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb650-13"><a href="its-just-a-linear-model.html#cb650-13" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb650-14"><a href="its-just-a-linear-model.html#cb650-14" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
</div>
<div id="implementation-in-base-1" class="section level3" number="14.5.2">
<h3><span class="header-section-number">14.5.2</span> Implementation in base</h3>
<div class="sourceCode" id="cb651"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb651-1"><a href="its-just-a-linear-model.html#cb651-1" aria-hidden="true" tabindex="-1"></a>grades_model <span class="ot">&lt;-</span> </span>
<span id="cb651-2"><a href="its-just-a-linear-model.html#cb651-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(number_of_A_plus <span class="sc">~</span> department, </span>
<span id="cb651-3"><a href="its-just-a-linear-model.html#cb651-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> count_of_A_plus, </span>
<span id="cb651-4"><a href="its-just-a-linear-model.html#cb651-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="st">&#39;poisson&#39;</span>)</span>
<span id="cb651-5"><a href="its-just-a-linear-model.html#cb651-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb651-6"><a href="its-just-a-linear-model.html#cb651-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(grades_model)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = number_of_A_plus ~ department, family = &quot;poisson&quot;, 
##     data = count_of_A_plus)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -6.7386  -1.2102  -0.2515   1.3292   3.9520  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  1.44238    0.09535   15.13   &lt;2e-16 ***
## department2  1.85345    0.10254   18.07   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 816.08  on 51  degrees of freedom
## Residual deviance: 334.57  on 50  degrees of freedom
## AIC: 545.38
## 
## Number of Fisher Scoring iterations: 5</code></pre>
</div>
<div id="implementation-in-tidymodels-2" class="section level3" number="14.5.3">
<h3><span class="header-section-number">14.5.3</span> Implementation in <code>tidymodels</code></h3>
<p>We can use <code>tidymodels</code> to run this if we wanted although we first need to install a helper package <code>poissonreg</code>.</p>
<div class="sourceCode" id="cb653"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb653-1"><a href="its-just-a-linear-model.html#cb653-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;poissonreg&quot;)</span></span>
<span id="cb653-2"><a href="its-just-a-linear-model.html#cb653-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb653-3"><a href="its-just-a-linear-model.html#cb653-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">853</span>)</span>
<span id="cb653-4"><a href="its-just-a-linear-model.html#cb653-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb653-5"><a href="its-just-a-linear-model.html#cb653-5" aria-hidden="true" tabindex="-1"></a>count_of_A_plus_split <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">initial_split</span>(count_of_A_plus, <span class="at">prop =</span> <span class="fl">0.80</span>)</span>
<span id="cb653-6"><a href="its-just-a-linear-model.html#cb653-6" aria-hidden="true" tabindex="-1"></a>count_of_A_plus_train <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">training</span>(count_of_A_plus_split)</span>
<span id="cb653-7"><a href="its-just-a-linear-model.html#cb653-7" aria-hidden="true" tabindex="-1"></a>count_of_A_plus_test  <span class="ot">&lt;-</span>  rsample<span class="sc">::</span><span class="fu">testing</span>(count_of_A_plus_split)</span>
<span id="cb653-8"><a href="its-just-a-linear-model.html#cb653-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb653-9"><a href="its-just-a-linear-model.html#cb653-9" aria-hidden="true" tabindex="-1"></a>a_plus_model_tidymodels <span class="ot">&lt;-</span></span>
<span id="cb653-10"><a href="its-just-a-linear-model.html#cb653-10" aria-hidden="true" tabindex="-1"></a>  poissonreg<span class="sc">::</span><span class="fu">poisson_reg</span>(<span class="at">mode =</span> <span class="st">&quot;regression&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb653-11"><a href="its-just-a-linear-model.html#cb653-11" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">set_engine</span>(<span class="st">&quot;glm&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb653-12"><a href="its-just-a-linear-model.html#cb653-12" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">fit</span>(number_of_A_plus <span class="sc">~</span> department, </span>
<span id="cb653-13"><a href="its-just-a-linear-model.html#cb653-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> count_of_A_plus_train)</span>
<span id="cb653-14"><a href="its-just-a-linear-model.html#cb653-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb653-15"><a href="its-just-a-linear-model.html#cb653-15" aria-hidden="true" tabindex="-1"></a>a_plus_model_tidymodels</span></code></pre></div>
<pre><code>## parsnip model object
## 
## Fit time:  3ms 
## 
## Call:  stats::glm(formula = number_of_A_plus ~ department, family = stats::poisson, 
##     data = data)
## 
## Coefficients:
## (Intercept)  department2  
##       1.493        1.760  
## 
## Degrees of Freedom: 41 Total (i.e. Null);  40 Residual
## Null Deviance:       644.8 
## Residual Deviance: 298.4     AIC: 470.8</code></pre>
<!-- ### Implementation in `rstanarm` -->

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="exploratory-data-analysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="causality-from-observational-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"search": true,
"info": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
