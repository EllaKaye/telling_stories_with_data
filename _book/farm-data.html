<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 10 Farm data | Telling Stories With Data</title>
<meta name="author" content="Rohan Alexander">
<meta name="description" content="Required material Read Atlas of AI, Chapter 3 ‘Data,’ (Crawford 2021). Read Guide to the Census of Population, 2016, Chapter 10 ‘Data quality assessment,’ (Statistics Canada 2017). Key concepts...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="Chapter 10 Farm data | Telling Stories With Data">
<meta property="og:type" content="book">
<meta property="og:image" content="/tellingstorieswithdatapainting.png">
<meta property="og:description" content="Required material Read Atlas of AI, Chapter 3 ‘Data,’ (Crawford 2021). Read Guide to the Census of Population, 2016, Chapter 10 ‘Data quality assessment,’ (Statistics Canada 2017). Key concepts...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 10 Farm data | Telling Stories With Data">
<meta name="twitter:description" content="Required material Read Atlas of AI, Chapter 3 ‘Data,’ (Crawford 2021). Read Guide to the Census of Population, 2016, Chapter 10 ‘Data quality assessment,’ (Statistics Canada 2017). Key concepts...">
<meta name="twitter:image" content="/tellingstorieswithdatapainting.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.11/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><link href="libs/_Atkinson%20Hyperlegible-0.4.0/font.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=IBM%20Plex%20Mono&amp;display=swap" rel="stylesheet">
<script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script><link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="libs/leaflet-1.3.1/leaflet.js"></script><link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="libs/proj4-2.6.2/proj4.min.js"></script><script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script><script src="libs/mapdeck-binding-0.3.4/mapdeck.js"></script><script src="libs/mpadeck_functions-0.0.1/mapdeck_functions.js"></script><script src="libs/deckgl-8.1.6/deckgl.min.js"></script><script src="libs/legend-0.0.1/legend.js"></script><script src="libs/title-0.0.1/title.js"></script><script src="libs/mapdeck_location-0.0.1/mapdeck_location.js"></script><script src="libs/mapdeck_colours-0.0.1/mapdeck_colours.js"></script><script src="libs/mapdeck_coordinates-0.0.1/mapdeck_coordinates.js"></script><link href="libs/mapboxgl-1.10.0/mapbox-gl.css" rel="stylesheet">
<script src="libs/mapboxgl-1.10.0/mapbox-gl.js"></script><link href="libs/mapdeck-0.0.1/mapdeck.css" rel="stylesheet">
<script src="libs/mpadeck-binding-0.3.4/mapdeck.js"></script><script src="libs/scatterplot-1.0.0/scatterplot.js"></script><script src="libs/viz-1.8.2/viz.js"></script><link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="bs4_style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Telling Stories With Data</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Preface</a></li>
<li><a class="" href="about-the-author.html">About the author</a></li>
<li class="book-part">Foundations</li>
<li><a class="" href="telling-stories-with-data.html"><span class="header-section-number">1</span> Telling stories with data</a></li>
<li><a class="" href="drinking-from-a-fire-hose.html"><span class="header-section-number">2</span> Drinking from a fire hose</a></li>
<li><a class="" href="r-essentials.html"><span class="header-section-number">3</span> R essentials</a></li>
<li><a class="" href="reproducible-workflows.html"><span class="header-section-number">4</span> Reproducible workflows</a></li>
<li class="book-part">Communication</li>
<li><a class="" href="on-writing.html"><span class="header-section-number">5</span> On writing</a></li>
<li><a class="" href="static-communication.html"><span class="header-section-number">6</span> Static communication</a></li>
<li><a class="" href="interactive-communication.html"><span class="header-section-number">7</span> Interactive communication</a></li>
<li class="book-part">Acquisition</li>
<li><a class="" href="gather-data.html"><span class="header-section-number">8</span> Gather data</a></li>
<li><a class="" href="hunt-data.html"><span class="header-section-number">9</span> Hunt data</a></li>
<li><a class="active" href="farm-data.html"><span class="header-section-number">10</span> Farm data</a></li>
<li class="book-part">Preparation</li>
<li><a class="" href="clean-and-prepare.html"><span class="header-section-number">11</span> Clean and prepare</a></li>
<li><a class="" href="store-and-share.html"><span class="header-section-number">12</span> Store and share</a></li>
<li class="book-part">Modelling</li>
<li><a class="" href="exploratory-data-analysis.html"><span class="header-section-number">13</span> Exploratory data analysis</a></li>
<li><a class="" href="ijalm.html"><span class="header-section-number">14</span> It’s Just A Linear Model</a></li>
<li><a class="" href="causality.html"><span class="header-section-number">15</span> Causality from observational data</a></li>
<li><a class="" href="mrp.html"><span class="header-section-number">16</span> Multilevel regression with post-stratification</a></li>
<li><a class="" href="text-as-data.html"><span class="header-section-number">17</span> Text as data</a></li>
<li class="book-part">Enrichment</li>
<li><a class="" href="using-the-cloud.html"><span class="header-section-number">18</span> Using the cloud</a></li>
<li><a class="" href="deploying-models.html"><span class="header-section-number">19</span> Deploying models</a></li>
<li><a class="" href="efficiency.html"><span class="header-section-number">20</span> Efficiency</a></li>
<li><a class="" href="concludingremarks.html"><span class="header-section-number">21</span> Concluding remarks</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="oh-you-think-and-shoulders-and-datasets.html"><span class="header-section-number">A</span> Oh you think and shoulders and datasets</a></li>
<li><a class="" href="papers.html"><span class="header-section-number">B</span> Papers</a></li>
<li><a class="" href="references-1.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/rstudio/bookdown-demo">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="farm-data" class="section level1" number="10">
<h1>
<span class="header-section-number">10</span> Farm data<a class="anchor" aria-label="anchor" href="#farm-data"><i class="fas fa-link"></i></a>
</h1>
<p><strong>Required material</strong></p>
<ul>
<li>Read <em>Atlas of AI</em>, Chapter 3 ‘Data,’ <span class="citation">(<a href="references-1.html#ref-crawford" role="doc-biblioref">Crawford 2021</a>)</span>.</li>
<li>Read <em>Guide to the Census of Population, 2016</em>, Chapter 10 ‘Data quality assessment,’ <span class="citation">(<a href="references-1.html#ref-statcanhistory" role="doc-biblioref">Statistics Canada 2017</a>)</span>.</li>
</ul>
<p><strong>Key concepts and skills</strong></p>
<ul>
<li>Obtain data from censuses and other datasets provided by governments.</li>
</ul>
<p><strong>Key libraries</strong></p>
<ul>
<li>
<code>cancensus</code> <span class="citation">(<a href="references-1.html#ref-citecancensus" role="doc-biblioref">von Bergmann, Shkolnik, and Jacobs 2021</a>)</span>
</li>
<li>
<code>canlang</code> <span class="citation">(<a href="references-1.html#ref-canlang" role="doc-biblioref">T. Timbers 2020</a>)</span>
</li>
<li>
<code>tidyverse</code> <span class="citation">(<a href="references-1.html#ref-citetidyverse" role="doc-biblioref">Wickham et al. 2019a</a>)</span>
</li>
</ul>
<p><strong>Key functions</strong></p>
<ul>
<li><code><a href="https://mountainmath.github.io/cancensus/index.html/reference/get_census.html">cancensus::get_census()</a></code></li>
<li><code><a href="https://mountainmath.github.io/cancensus/index.html/reference/list_census_datasets.html">cancensus::list_census_datasets()</a></code></li>
<li><code><a href="https://mountainmath.github.io/cancensus/index.html/reference/list_census_regions.html">cancensus::list_census_regions()</a></code></li>
<li><code><a href="https://mountainmath.github.io/cancensus/index.html/reference/list_census_vectors.html">cancensus::list_census_vectors()</a></code></li>
<li><code><a href="https://mountainmath.github.io/cancensus/index.html/reference/set_api_key.html">cancensus::set_api_key()</a></code></li>
<li><code><a href="https://ttimbers.github.io/canlang/reference/can_lang.html">canlang::can_lang</a></code></li>
<li><code><a href="https://ttimbers.github.io/canlang/reference/region_lang.html">canlang::region_lang</a></code></li>
<li><code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">dplyr::left_join()</a></code></li>
<li><code><a href="https://dplyr.tidyverse.org/reference/mutate.html">dplyr::mutate()</a></code></li>
<li><code><a href="https://dplyr.tidyverse.org/reference/select.html">dplyr::select()</a></code></li>
<li><code><a href="https://dplyr.tidyverse.org/reference/slice.html">dplyr::slice_max()</a></code></li>
<li><code><a href="https://dplyr.tidyverse.org/reference/slice.html">dplyr::slice_min()</a></code></li>
<li><code><a href="https://readr.tidyverse.org/reference/read_delim.html">readr::read_csv()</a></code></li>
</ul>
<div id="introduction-7" class="section level2" number="10.1">
<h2>
<span class="header-section-number">10.1</span> Introduction<a class="anchor" aria-label="anchor" href="#introduction-7"><i class="fas fa-link"></i></a>
</h2>
<p>There are a variety of sources of data that have been produced for the purposes of being used as datasets. One thinks here especially of censuses. <span class="citation"><a href="references-1.html#ref-whitby" role="doc-biblioref">Whitby</a> (<a href="references-1.html#ref-whitby" role="doc-biblioref">2020, 30–31</a>)</span> provides an enthralling overview, describing how the earliest censuses that we have written suggestions of are from China’s Yellow River valley, and that they were used for more than just purposes of taxation and conscription. <span class="citation"><a href="references-1.html#ref-whitby" role="doc-biblioref">Whitby</a> (<a href="references-1.html#ref-whitby" role="doc-biblioref">2020</a>)</span> also highlights the links between censuses and religion, quoting from Book of Luke ‘In those days Caesar Augustus issued a decree that a census should be taken of the entire Roman world,’ which led to David and Mary travelling to Bethlehem.</p>
<p>Taxation was a substantial motivator for censuses. <span class="citation"><a href="references-1.html#ref-jones1953census" role="doc-biblioref">Jones</a> (<a href="references-1.html#ref-jones1953census" role="doc-biblioref">1953</a>)</span> describes how census records survive that ‘were probably engraved in the late third or early fourth century A.D., when Diocletian and his colleagues and successors are known to have been active in carrying out censuses to serve as the basis of their new system of taxation.’ And detailed records of this sort have been abused. For instance, <span class="citation"><a href="references-1.html#ref-luebke1994locating" role="doc-biblioref">Luebke and Milton</a> (<a href="references-1.html#ref-luebke1994locating" role="doc-biblioref">1994</a>)</span> say how ‘(t)he Nazi regime gathered its information with two relatively conventional tools of modern administration: the national census and police registration.’</p>
<p>Another source of data deliberately put together to be a dataset include economic conditions such as unemployment, inflation, and GDP. Interestingly, <span class="citation"><a href="references-1.html#ref-rockoff2019controversies" role="doc-biblioref">Rockoff</a> (<a href="references-1.html#ref-rockoff2019controversies" role="doc-biblioref">2019</a>)</span> describes how these economic statistics were not actually developed by the federal government, even though federal governments typically eventually took over that role. Typically, these sources of data are put together by governments. They have the powers of the state behind them which enables them to be thorough in a way that other datasets cannot be, and similarly bring a specific perspective.</p>
<p>Another, similarly, large and established source of data are from long-running large surveys. These are conducted on a regular basis, and while not usually directly conducted by the government, they are usually funded, one way or another, by the government. For instance, here we often think of electoral surveys, such as the Canadian Election Study, which has run in association with every federal election since 1965, and similarly the British Election Study which has been associated with every general election since 1964.</p>
<p>Finally, there has been a large push toward open data in government. While the term has become contentious because of how it has occurred in practice, the underlying principle—that the government should make available the data that is has—is undeniable.
In this chapter we cover these datasets, which we term ‘farmed data.’ They are typically fairly nicely put together and the work of collecting, preparing and cleaning these datasets has typically been done. They are also, usually, conducted on a known release cycle. For instance, most developed countries release unemployment and inflation dataset on a monthly basis, GDP on a quarterly basis, and a census every five to ten years.</p>
<p>While these datasets have always been useful, they were developed for a time when much analysis was conducted without the use of scripts and programming languages. A cottage industry of R package development has sprung up around making it easier to get these datasets into R. In this chapter we cover a few that are especially useful.</p>
<p>It is important to recognize that data are not neutral. Thinking clearly about who is included in the dataset, and who is systematically excluded, is critical. As <span class="citation"><a href="references-1.html#ref-crawford" role="doc-biblioref">Crawford</a> (<a href="references-1.html#ref-crawford" role="doc-biblioref">2021, 121</a>)</span> says:</p>
<blockquote>
<p>The way data is understood, captured, classified, and named is fundamentally an act of world-making and containment…. The myth of data collection as a benevolent practice… has obscured its operations of power, protecting those who profit most while avoiding responsibility for its consequences.</p>
</blockquote>
</div>
<div id="censuses" class="section level2" number="10.2">
<h2>
<span class="header-section-number">10.2</span> Censuses<a class="anchor" aria-label="anchor" href="#censuses"><i class="fas fa-link"></i></a>
</h2>
<div id="canada" class="section level3" number="10.2.1">
<h3>
<span class="header-section-number">10.2.1</span> Canada<a class="anchor" aria-label="anchor" href="#canada"><i class="fas fa-link"></i></a>
</h3>
<p>The first census in Canada was conducted in 1666. There were 3,215 inhabitants that were counted, and the census asked about age, sex, marital status, and occupation <span class="citation">(<a href="references-1.html#ref-statcanhistory" role="doc-biblioref">Statistics Canada 2017</a>)</span>. In association with Confederation, in 1867 a decennial census was required so that political representatives could be allocated for the new Parliament. Regular censuses have occurred since then, the most recent in 2021.</p>
<p>We can explore some data on languages spoken in Canada from the 2016 Census using <code>canlang</code> <span class="citation">(<a href="references-1.html#ref-canlang" role="doc-biblioref">T. Timbers 2020</a>)</span>. This package is not yet available on CRAN, and so we install it from GitHub, using <code>devtools</code> <span class="citation">(<a href="references-1.html#ref-citeDevtools" role="doc-biblioref">Wickham, Hester, and Chang 2020</a>)</span>.</p>
<div class="sourceCode" id="cb333"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/remote-reexports.html">install_github</a></span><span class="op">(</span><span class="st">"ttimbers/canlang"</span><span class="op">)</span></code></pre></div>
<p>We will start with the ‘can_lang’ dataset, which provides the number of Canadians who use that language for 214 languages.</p>
<div class="sourceCode" id="cb334"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ttimbers.github.io/canlang/">canlang</a></span><span class="op">)</span>

<span class="va">can_lang</span>
<span class="co">#&gt; # A tibble: 214 × 6</span>
<span class="co">#&gt;    category language mother_tongue most_at_home most_at_work</span>
<span class="co">#&gt;    &lt;chr&gt;    &lt;chr&gt;            &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;</span>
<span class="co">#&gt;  1 Aborigi… Aborigi…           590          235           30</span>
<span class="co">#&gt;  2 Non-Off… Afrikaa…         10260         4785           85</span>
<span class="co">#&gt;  3 Non-Off… Afro-As…          1150          445           10</span>
<span class="co">#&gt;  4 Non-Off… Akan (T…         13460         5985           25</span>
<span class="co">#&gt;  5 Non-Off… Albanian         26895        13135          345</span>
<span class="co">#&gt;  6 Aborigi… Algonqu…            45           10            0</span>
<span class="co">#&gt;  7 Aborigi… Algonqu…          1260          370           40</span>
<span class="co">#&gt;  8 Non-Off… America…          2685         3020         1145</span>
<span class="co">#&gt;  9 Non-Off… Amharic          22465        12785          200</span>
<span class="co">#&gt; 10 Non-Off… Arabic          419890       223535         5585</span>
<span class="co">#&gt; # … with 204 more rows, and 1 more variable:</span>
<span class="co">#&gt; #   lang_known &lt;dbl&gt;</span></code></pre></div>
<p>We can quickly see the top-10 most common languages to have as mother tongue.</p>
<div class="sourceCode" id="cb335"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">can_lang</span> |&gt;
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_max</a></span><span class="op">(</span><span class="va">mother_tongue</span>, n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> |&gt;
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">language</span>, <span class="va">mother_tongue</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 10 × 2</span>
<span class="co">#&gt;    language                     mother_tongue</span>
<span class="co">#&gt;    &lt;chr&gt;                                &lt;dbl&gt;</span>
<span class="co">#&gt;  1 English                           19460850</span>
<span class="co">#&gt;  2 French                             7166700</span>
<span class="co">#&gt;  3 Mandarin                            592040</span>
<span class="co">#&gt;  4 Cantonese                           565270</span>
<span class="co">#&gt;  5 Punjabi (Panjabi)                   501680</span>
<span class="co">#&gt;  6 Spanish                             458850</span>
<span class="co">#&gt;  7 Tagalog (Pilipino, Filipino)        431385</span>
<span class="co">#&gt;  8 Arabic                              419890</span>
<span class="co">#&gt;  9 German                              384040</span>
<span class="co">#&gt; 10 Italian                             375635</span></code></pre></div>
<p>We could combine two datasets together ‘region_lang’ and ‘region_data,’ to see if the five most-common languages differ between the largest region, Toronto, and the smallest, Belleville.</p>
<div class="sourceCode" id="cb336"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">region_lang</span> |&gt;
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">region_data</span>, by <span class="op">=</span> <span class="st">"region"</span><span class="op">)</span> |&gt;
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">population</span><span class="op">)</span><span class="op">)</span> |&gt;
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_max</a></span><span class="op">(</span><span class="va">mother_tongue</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> |&gt;
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">region</span>, <span class="va">language</span>, <span class="va">mother_tongue</span>, <span class="va">population</span><span class="op">)</span> |&gt;
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>prop <span class="op">=</span> <span class="va">mother_tongue</span> <span class="op">/</span> <span class="va">population</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 5 × 5</span>
<span class="co">#&gt;   region  language          mother_tongue population   prop</span>
<span class="co">#&gt;   &lt;chr&gt;   &lt;chr&gt;                     &lt;dbl&gt;      &lt;dbl&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt; 1 Toronto English                 3061820    5928040 0.516 </span>
<span class="co">#&gt; 2 Toronto Cantonese                247710    5928040 0.0418</span>
<span class="co">#&gt; 3 Toronto Mandarin                 227085    5928040 0.0383</span>
<span class="co">#&gt; 4 Toronto Punjabi (Panjabi)        171225    5928040 0.0289</span>
<span class="co">#&gt; 5 Toronto Italian                  151415    5928040 0.0255</span>

<span class="va">region_lang</span> |&gt;
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">region_data</span>, by <span class="op">=</span> <span class="st">"region"</span><span class="op">)</span> |&gt;
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">population</span><span class="op">)</span><span class="op">)</span> |&gt;
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_max</a></span><span class="op">(</span><span class="va">mother_tongue</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> |&gt;
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">region</span>, <span class="va">language</span>, <span class="va">mother_tongue</span>, <span class="va">population</span><span class="op">)</span> |&gt;
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>prop <span class="op">=</span> <span class="va">mother_tongue</span> <span class="op">/</span> <span class="va">population</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 5 × 5</span>
<span class="co">#&gt;   region     language mother_tongue population    prop</span>
<span class="co">#&gt;   &lt;chr&gt;      &lt;chr&gt;            &lt;dbl&gt;      &lt;dbl&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt; 1 Belleville English          93655     103472 0.905  </span>
<span class="co">#&gt; 2 Belleville French            2675     103472 0.0259 </span>
<span class="co">#&gt; 3 Belleville German             635     103472 0.00614</span>
<span class="co">#&gt; 4 Belleville Dutch              600     103472 0.00580</span>
<span class="co">#&gt; 5 Belleville Spanish            350     103472 0.00338</span></code></pre></div>
<p>We can see a considerable difference between the proportions, with a little over 50 per cent of those in Toronto having English as their mother tongue, while that is the case for around 90 per cent of those in Belleville.</p>
<p>In general, data from Canadian censuses are not as easily available as in other countries. Statistics Canada, which is the government agency that is responsible for the census and other official statistics freely provides a Individuals File from the 2016 census as a Public Use Microdata File (PUMF), but only in response to a request. And while it is a 2.7 per cent sample from the 2016 census, this PUMF provides limited detail.</p>
<p>Another way to access data from the Canadian census is to use <code>cancensus</code> <span class="citation">(<a href="references-1.html#ref-citecancensus" role="doc-biblioref">von Bergmann, Shkolnik, and Jacobs 2021</a>)</span>. This package can be installed from CRAN. It requires an API key, which can be requested by creating an <a href="https://censusmapper.ca/users/sign_up">account</a> and then going to ‘edit profile.’ The package has a helper function <code>set_api_key("ADD_YOUR_API_KEY_HERE", install = TRUE)</code> that makes it easier to add the API key to an ‘.Renviron’ file, in the same way that we did in Chapter <a href="gather-data.html#gather-data">8</a>.</p>
<p>We can use <code>get_census()</code> to get census data. We need to specify a census of interest, and a variety of other arguments. For instance, we could get data from the 2016 census about Ontario, which is the largest Canadian province by population.</p>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="farm-data.html#cb337-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb337-2"><a href="farm-data.html#cb337-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cancensus)</span>
<span id="cb337-3"><a href="farm-data.html#cb337-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-4"><a href="farm-data.html#cb337-4" aria-hidden="true" tabindex="-1"></a>ontario_population <span class="ot">&lt;-</span> </span>
<span id="cb337-5"><a href="farm-data.html#cb337-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_census</span>(<span class="at">dataset =</span> <span class="st">"CA16"</span>,</span>
<span id="cb337-6"><a href="farm-data.html#cb337-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">level =</span> <span class="st">"Regions"</span>,</span>
<span id="cb337-7"><a href="farm-data.html#cb337-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">vectors =</span> <span class="st">"v_CA16_1"</span>, </span>
<span id="cb337-8"><a href="farm-data.html#cb337-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">regions =</span> <span class="fu">list</span>(<span class="at">PR=</span><span class="fu">c</span>(<span class="st">'35'</span>)</span>
<span id="cb337-9"><a href="farm-data.html#cb337-9" aria-hidden="true" tabindex="-1"></a>                            )</span>
<span id="cb337-10"><a href="farm-data.html#cb337-10" aria-hidden="true" tabindex="-1"></a>             )</span>
<span id="cb337-11"><a href="farm-data.html#cb337-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb337-12"><a href="farm-data.html#cb337-12" aria-hidden="true" tabindex="-1"></a>Downloading<span class="sc">:</span> <span class="dv">120</span> B     </span>
<span id="cb337-13"><a href="farm-data.html#cb337-13" aria-hidden="true" tabindex="-1"></a>Downloading<span class="sc">:</span> <span class="dv">120</span> B     </span>
<span id="cb337-14"><a href="farm-data.html#cb337-14" aria-hidden="true" tabindex="-1"></a>Downloading<span class="sc">:</span> <span class="dv">120</span> B     </span>
<span id="cb337-15"><a href="farm-data.html#cb337-15" aria-hidden="true" tabindex="-1"></a>Downloading<span class="sc">:</span> <span class="dv">120</span> B     </span>
<span id="cb337-16"><a href="farm-data.html#cb337-16" aria-hidden="true" tabindex="-1"></a>Downloading<span class="sc">:</span> <span class="dv">120</span> B     </span>
<span id="cb337-17"><a href="farm-data.html#cb337-17" aria-hidden="true" tabindex="-1"></a>Downloading<span class="sc">:</span> <span class="dv">120</span> B</span>
<span id="cb337-18"><a href="farm-data.html#cb337-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-19"><a href="farm-data.html#cb337-19" aria-hidden="true" tabindex="-1"></a>ontario_population</span>
<span id="cb337-20"><a href="farm-data.html#cb337-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 0 × 0</span></span></code></pre></div>
<p>Data from the 1996, 2001, 2006, 2011, and 2016 censuses are available, and <code>list_census_datasets()</code> provides the metadata that we need to provide to <code>get_census()</code> to access these. Data are available based on a variety of regions, and <code>list_census_regions()</code> provides the metadata that we need. And finally, <code>list_census_vectors()</code> provides the metadata about the variables that available.</p>
<!-- One especially nice aspect is that the package provides access to spatial data that can be mapped. For instance, -->
<!-- ```{r} -->
<!-- library(cancensus) -->
<!-- library(sf) -->
<!-- # retrieve sf dataframe -->
<!-- provincial_populations <-  -->
<!--   get_census( -->
<!--     dataset='CA16',  -->
<!--     level = "PR", -->
<!--     vectors = "v_CA16_1",  -->
<!--     geo_format = 'sf', -->
<!--     regions = list(PR=c("35")) -->
<!--     ) -->
<!-- list_census_regions(dataset = "CA16") -->
<!-- ``` -->
</div>
<div id="usa" class="section level3" number="10.2.2">
<h3>
<span class="header-section-number">10.2.2</span> USA<a class="anchor" aria-label="anchor" href="#usa"><i class="fas fa-link"></i></a>
</h3>
<div id="american-community-survey" class="section level4" number="10.2.2.1">
<h4>
<span class="header-section-number">10.2.2.1</span> American Community Survey<a class="anchor" aria-label="anchor" href="#american-community-survey"><i class="fas fa-link"></i></a>
</h4>
<p>The requirement for a US Census is included in the US Constitution, and decent, though clunky, access is provided. But the US is in the envious situation where there is usually a better approach than going through the national statistical agency of IPUMS. IPUMS provides access to a wide range of datasets, including international census microdata. In the specific case of the US, the American Community Survey (ACS) is a survey that is comparable to the questions asked on many censuses, but it is that are available on an annual basis, compared with a census which could be quite out-of-date by the time the data are available. It ends up with millions of responses each year. Although the ACS is smaller than a census, the advantage is that it is available on a more timely basis. We will access the ACS through IPUMS.</p>
<p>Go to <a href="https://ipums.org">IPUMS</a>, then ‘IPUMS USA,’ and select ‘get data’ (Figure <a href="farm-data.html#fig:ipumsone">10.1</a>).</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ipumsone"></span>
<img src="figures/ipums_one.png" alt="The IPUMS homepage, with IPUMS USA shown in the top left box" width="85%"><p class="caption">
Figure 10.1: The IPUMS homepage, with IPUMS USA shown in the top left box
</p>
</div>
<p>We are interested in a sample, so go to ‘SELECT SAMPLE,’ and un-select ‘Default sample from each year’ and instead select ‘2019 ACS’ and then ‘SUBMIT SAMPLE SELECTIONS’ (Figure <a href="farm-data.html#fig:ipumstwo">10.2</a>).</p>
<div class="figure">
<span style="display:block;" id="fig:ipumstwo"></span>
<img src="figures/ipums_two.png" alt="Selecting a sample from IPUMS USA and specifying interest in the 2019 ACS" width="45%"><img src="figures/ipums_three.png" alt="Selecting a sample from IPUMS USA and specifying interest in the 2019 ACS" width="45%"><p class="caption">
Figure 10.2: Selecting a sample from IPUMS USA and specifying interest in the 2019 ACS
</p>
</div>
<p>We might be interested in data based on state. So we would begin by looking at ‘HOUSEHOLD’ variables and selecting ‘GEOGRAPHIC’ (Figure <a href="farm-data.html#fig:ipumsfour">10.3</a>).</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ipumsfour"></span>
<img src="figures/ipums_four.png" alt="Specifying that we are interested in the state" width="85%"><p class="caption">
Figure 10.3: Specifying that we are interested in the state
</p>
</div>
<p>We add ‘STATEICP’ to our ‘cart’ by clicking the plus, which will then turn into a tick (Figure <a href="farm-data.html#fig:ipumssix">10.4</a>).</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ipumssix"></span>
<img src="figures/ipums_six.png" alt="Adding STATEICP to our cart" width="85%"><p class="caption">
Figure 10.4: Adding STATEICP to our cart
</p>
</div>
<p>We might then be interested in data on a ‘PERSON’ basis, for instance, ‘DEMOGRAPHIC’ variables such as ‘AGE,’ which we should add to our cart. Still on a ‘PERSON’ basis, we might be interested in ‘INCOME,’ for instance, ‘Total personal income’ ‘INCTOT’ and we could add that to our cart (Figure <a href="farm-data.html#fig:ipumsseven">10.5</a>).</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ipumsseven"></span>
<img src="figures/ipums_seven.png" alt="Adding additional demographic variables that are available on an individual basis" width="85%"><p class="caption">
Figure 10.5: Adding additional demographic variables that are available on an individual basis
</p>
</div>
<p>When we are done, we can ‘VIEW CART,’ and then ‘CREATE DATA EXTRACT’ (Figure <a href="farm-data.html#fig:ipumseight">10.6</a>). At this point there are two aspects that we likely want to change:</p>
<ol style="list-style-type: decimal">
<li>Change the ‘DATA FORMAT’ from dat to csv (Figure <a href="farm-data.html#fig:ipumsnine">10.7</a>).</li>
<li>Customize the sample size as we likely do not need three million responses, and could just change it to, say, 500,000 (Figure <a href="farm-data.html#fig:ipumsten">10.8</a>).</li>
</ol>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ipumseight"></span>
<img src="figures/ipums_eight.png" alt="Beginning the checkout process" width="85%"><p class="caption">
Figure 10.6: Beginning the checkout process
</p>
</div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ipumsnine"></span>
<img src="figures/ipums_nine.png" alt="Specifying that we are interested in CSV files" width="85%"><p class="caption">
Figure 10.7: Specifying that we are interested in CSV files
</p>
</div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ipumsten"></span>
<img src="figures/ipums_ten.png" alt="Reducing the sample size from three million responses to half a million" width="85%"><p class="caption">
Figure 10.8: Reducing the sample size from three million responses to half a million
</p>
</div>
<p>Finally, we want to include a descriptive name for the extract, for instance, ‘2022-02-06: Income based on state and age,’ which specifies the date we made the extract and what is in the extract. After that we can ‘SUBMIT EXTRACT.’</p>
<p>We will be asked to log in or create an account, and after doing that will be able to submit the request. IPUMS will email when the extract is available, after which we can download it and read it into R in the usual way. It is critical that we cite this dataset when we use it <span class="citation">(<a href="references-1.html#ref-ipumsusa" role="doc-biblioref">Ruggles et al. 2021</a>)</span>.</p>
<div class="sourceCode" id="cb338"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="va">ipums_extract</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"usa_00010.csv"</span><span class="op">)</span>

<span class="va">ipums_extract</span></code></pre></div>
<pre><code>#&gt; # A tibble: 6 × 4
#&gt;    YEAR STATEICP   AGE INCTOT
#&gt;   &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
#&gt; 1  2019       41    39   9000
#&gt; 2  2019       41    35   9300
#&gt; 3  2019       41    39  60000
#&gt; 4  2019       41    32  14400
#&gt; 5  2019       41    21      0
#&gt; 6  2019       41    61  11100</code></pre>
<p>Incredibly, full count, that is the entire census, data are available through IPUMS for the US censuses conducted on: 1850, 1860, 1870, 1880, 1900, 1910, 1920, 1930, and 1940. Most of the 1890 census records were destroyed due to a fire in 1921. 1 per cent samples are available for these years, and through to 1990. And then ACS data are available from 2000.</p>
<!-- Measuring homelessness? -->
<!-- https://www.ncbi.nlm.nih.gov/books/NBK218229/ -->
<!-- "S-Night survey conducted by the US Census Bureau in 1990" -->
<!-- "Street count surveys are used in many cities to count the number of homeless people in the streets at a point in time and gain a better understanding of the needs of homeless populations. In surveys such as the S-Night survey conducted by the US Census Bureau in 1990, enumerators are sent to pre-identified sites to enumerate homeless people while other survey personnel (“plants”) are planted among homeless people and indistinguishable from actual homeless. The ratio of plants seen by the enumerators to the number of plants deployed is used to inform the detection probability of homeless and provide an adjustment to the homeless undercount.  In practice, one cannot know for sure which plants were seen because enumerators cannot distinguish between plants and homeless people. We can only rely on the plants’ judgement of whether (yes, no or maybe) they think they were seen by an enumerator. The presence of “maybes” in the data leads to more unknown parameters than data points, which makes estimation of detection probabilities difficult. We propose to solve this problem by developing a Bayesian hierarchical model that uses hierarchical priors on detection probabilities across survey years and/or across cities. Such hierarchical modeling of the data is challenging because the data is available at various aggregated levels of the population (e.g., `seen` = plant AND seen + homeless AND seen, `maybes` = plant AND seen AND not interviewed AND maybe + plant AND not seen AND maybe.) The new methodology will be applied to a simulated reconstruction of the original S-night survey data and our estimates will be compared to those of the original analysis of the S-night data." -->
<!-- ### Australia -->
<!-- ## Other government data -->
<!-- ### Unemployment -->
<!-- ### Weather -->
<!-- ### General Social Survey -->
<!-- ## Open Government Data -->
<!-- ### Canada -->
<!-- - Canadian Government Open Data: https://open.canada.ca/en/open-data. -->
<!-- - City of Toronto Open Data Portal  -->
<!-- ## Electoral Studies -->
<!-- ### Canadian Electoral Study -->
<!-- cesR -->
<!-- ### Australian Electoral Study -->
<!-- ### CCES -->
</div>
</div>
</div>
<div id="exercises-and-tutorial-9" class="section level2" number="10.3">
<h2>
<span class="header-section-number">10.3</span> Exercises and tutorial<a class="anchor" aria-label="anchor" href="#exercises-and-tutorial-9"><i class="fas fa-link"></i></a>
</h2>
<div id="exercises-9" class="section level3" number="10.3.1">
<h3>
<span class="header-section-number">10.3.1</span> Exercises<a class="anchor" aria-label="anchor" href="#exercises-9"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li>Please identify three other sources of data that you are interested in and describe where are they available (please include a link or code)?</li>
<li>Please focus on one of those sources. What steps do you have to go through in order to get a dataset that can be analyzed in R?</li>
<li>Let’s say you take a job at RBC (a Canadian bank) and they already have some quantitative data for you to use. What are some questions that you should explore when deciding whether that data will be useful to you?</li>
<li>Write three points (you are welcome to use dot points) about why government data may be especially useful?</li>
<li>Please pick a government of interest and find their inflation statistics. To what extent do you know about how these data were gathered?</li>
<li>With reference to <span class="citation"><a href="references-1.html#ref-chen2019forensic" role="doc-biblioref">Chen et al.</a> (<a href="references-1.html#ref-chen2019forensic" role="doc-biblioref">2019</a>)</span> and <span class="citation"><a href="references-1.html#ref-martinez2019much" role="doc-biblioref">Martinez</a> (<a href="references-1.html#ref-martinez2019much" role="doc-biblioref">2019</a>)</span> to what extent do you think we can trust government statistics? Please mention at least three governments in your answer.</li>
<li>The 2021 census in Canada asked, firstly, ‘What was this person’s sex at birth? Sex refers to sex assigned at birth. Male/Female,’ and then ‘What is this person’s gender? Refers to current gender which may be different from sex assigned at birth and may be different from what is indicated on legal documents. Male/Female/Or please specify this person’s gender (space for a typed or handwritten answer).’ With reference to <span class="citation"><a href="references-1.html#ref-statcan2020" role="doc-biblioref">Statistics Canada</a> (<a href="references-1.html#ref-statcan2020" role="doc-biblioref">2020</a>)</span>, please discuss the extent to which you think this is an appropriate way for census to have proceeded. You are welcome to discuss the case of a different country if you are more familiar with that.</li>
<li>Pretend that we have conducted a survey of everyone in Canada, where we asked for age, sex, and gender. Your friend claims that there is no need to worry about uncertainty ‘because we have the whole population.’ Is your friend right or wrong, and why?</li>
</ol>
</div>
<div id="tutorial-9" class="section level3" number="10.3.2">
<h3>
<span class="header-section-number">10.3.2</span> Tutorial<a class="anchor" aria-label="anchor" href="#tutorial-9"><i class="fas fa-link"></i></a>
</h3>
<p>Use IPUMS to access the ACS. Download some data that are of interest and write a two-to-three page paper analyzing it.</p>
</div>
<div id="paper-2" class="section level3" number="10.3.3">
<h3>
<span class="header-section-number">10.3.3</span> Paper<a class="anchor" aria-label="anchor" href="#paper-2"><i class="fas fa-link"></i></a>
</h3>
<p>At about this point, Paper Three (Appendix <a href="papers.html#paper-three">B.3</a>) would be appropriate.</p>

</div>
</div>
</div>



  <div class="chapter-nav">
<div class="prev"><a href="hunt-data.html"><span class="header-section-number">9</span> Hunt data</a></div>
<div class="next"><a href="clean-and-prepare.html"><span class="header-section-number">11</span> Clean and prepare</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#farm-data"><span class="header-section-number">10</span> Farm data</a></li>
<li><a class="nav-link" href="#introduction-7"><span class="header-section-number">10.1</span> Introduction</a></li>
<li>
<a class="nav-link" href="#censuses"><span class="header-section-number">10.2</span> Censuses</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#canada"><span class="header-section-number">10.2.1</span> Canada</a></li>
<li><a class="nav-link" href="#usa"><span class="header-section-number">10.2.2</span> USA</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#exercises-and-tutorial-9"><span class="header-section-number">10.3</span> Exercises and tutorial</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#exercises-9"><span class="header-section-number">10.3.1</span> Exercises</a></li>
<li><a class="nav-link" href="#tutorial-9"><span class="header-section-number">10.3.2</span> Tutorial</a></li>
<li><a class="nav-link" href="#paper-2"><span class="header-section-number">10.3.3</span> Paper</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/rstudio/bookdown-demo/blob/master/23-farm.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/rstudio/bookdown-demo/edit/master/23-farm.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Telling Stories With Data</strong>" was written by Rohan Alexander. It was last built on 15 February, 2022.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
